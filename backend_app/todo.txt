[ ] Extract exploit or PoC from refmap
[ ] Sync and monitor Vendor bulletins (MS, RH, Suse, debian, gentoo, Amazon, ...)
[ ] Patch info: availability (unknown, partial, official), date
[ ] Extract CVSSv2 Temporal vector from Nessus plugins
[ ] Extract CVSSv3 Base and Temporal vectors from Nessus plugins
[ ] Collect vuln categories: Deny of service, Remote code exec, ...
[ ] Collect data from MISP
[ ] Collect data on Yara and Sigma detection rules
[ ] Share data with OpenCTI
[ ] Scrap data from Github, Twitter, Reddit and Google --> NLP analysis for suggestions
[ ] Use memcache
[ ] DB performance tuning
[ ] Fix:
  - Sync VIA: Tenable bulletins -> ThreatMetadata instead of ExploitMetadata
  - Manually adding first exploit to the vulnerability: 'Exploitable' metric is not updated

https://nvd.nist.gov/vuln/data-feeds
https://security.paloaltonetworks.com/CVE-2020-1976

YaraRules
CVE-2017–11882: https://medium.com/@Sebdraven/a-quick-analysis-malicious-rtf-to-write-yara-rule-part-1-234fa34db551
CVE-2017-11882 https://blog.reversinglabs.com/blog/reversinglabs-yara-rule-detects-cobalt-payload-exploiting-cve-2017-11882
CVE-2019-19781: https://github.com/Neo23x0/signature-base/blob/master/yara/exploit_shitrix.yar
CVE-2020-8438: https://sku11army.blogspot.com/2020/01/ruckus-rce-ruckus-m500-via-injection-on.html
CVE-2020-8772: https://www.wordfence.com/blog/2020/01/critical-authentication-bypass-vulnerability-in-infinitewp-client-plugin/
CVE-2020-8772: https://www.webarxsecurity.com/vulnerability-infinitewp-client-wp-time-capsule/
CVE-2019-7482-CVE-2019-7486: https://blog.scrt.ch/2020/02/11/sonicwall-sra-and-sma-vulnerabilties/
https://research.securitum.com/css-data-exfiltration-in-firefox-via-single-injection-point/
cve-2020-0601: https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-technical-analysis-of-curveball-cve-2020-0601/
https://www.secjuice.com/modsecurity-vulnerability-cve-2019-19886/
CVE-2020-8547: https://tech.michaelaltfield.net/2020/02/14/phplist-hardening-security/
CVE-2019-15605: https://snyk.io/blog/node-js-release-fixes-a-critical-http-security-vulnerability/
CVE-2020-0618: https://www.mdsec.co.uk/2020/02/cve-2020-0618-rce-in-sql-server-reporting-services-ssrs/
CVE-2019-18683: https://a13xp0p0v.github.io/2020/02/15/CVE-2019-18683.html
CVE-2020-0668: https://itm4n.github.io/cve-2020-0668-windows-service-tracing-eop/
https://www.webarxsecurity.com/critical-issue-in-themegrill-demo-importer/
CVE-2020-0683: https://padovah4ck.github.io/CVE-2020-0683/
CVE-2019-2215: https://github.com/DimitriFourny/cve-2019-2215
CVE-2020-0728: https://github.com/irsl/CVE-2020-0728
CVE-2018-4344: https://www.synacktiv.com/posts/exploit/lightspeed-a-race-for-an-iosmacos-sandbox-escape.html

Sigma Detection
https://github.com/Neo23x0/sigma/blob/master/rules/web/web_citrix_cve_2019_19781_exploit.yml

OpenCTI integration

----------------
ALTER SEQUENCE kb_cve_id_seq RESTART;
ALTER SEQUENCE cves_historicalcve_history_id_seq RESTART;
ALTER SEQUENCE vulns_id_seq RESTART;
ALTER SEQUENCE threats_metadata_id_seq RESTART;
ALTER SEQUENCE vulns_historicalvuln_history_id_seq RESTART;
ALTER SEQUENCE vulns_historicalthreatmetadata_history_id_seq RESTART;
ALTER SEQUENCE vulns_historicalexploitmetadata_history_id_seq RESTART;
ALTER SEQUENCE exploits_metadata_id_seq RESTART;

----------------

Bulletins
redhat: CVE-2018-12326
msbulletin: CVE-2017-8713

----------------
Monitored assets:
- Create/Update/Delete asset to monitor: Vuln, CVE, Bulletin, CPE, Vendor, Product
- Send alerts on changes
- Send periodic reports

----------------
Alerting use cases:
- Vulnerabilities match CVSS > 9.0 AND is_monitored_cpe AND is_exploitable == True
  -> New vulns
  -> Updated vuln

Alerting [
{
  'title': '[All] New vulnerability detected with CVSS > 9.0 and an exploit exists',
  'trigger': 'add_vuln',
  'action': 'debug',
  'target': 'vulns',
  'on_monitored': False,
  'in_bulk': False,
  'template_id': None,
  'conditions': {
    'vuln': {
      'cvss__gte': 9.0,
      'is_exploitable': True
    }
  },
  'severity': 'low',
  'enabled': True
},
{
  'title': '[Monitored] CVSS score has changed to > 9.0',
  'trigger': 'update_vuln',
  'action': 'debug',
  'target': 'vulns',
  'on_monitored': True,
  'conditions': [
    'vuln': {
      'cvss__gte': 9.0,
    }
  ],
  'check_fields': ['cvss2']
  'severity': 'low'
},
{
  'title': '[Monitored] CVSS score has changed to > 9.0',
  'trigger': 'update_vuln',
  'action': 'debug',
  'target': 'vulns',
  'on_monitored': True,
  'conditions': [
    'vuln': {
      'cvss2__gte': 9.0,
    }
  ],
  'check_fields': ['cvss2']
  'severity': 'low'
},
{
  'title': '[Monitored] Change(s) detected on Vuln PHID-{{vuln.id}}',
  'trigger': 'update_vuln',
  'action': 'debug',
  'target': 'vulns',
  'on_monitored': True,
  'conditions': [],
  'check_fields': [
    'cvss2', 'impact', 'access', 'is_exploitable', 'is_confirmed',
    'is_in_the_news', 'is_in_the_wild']
  'severity': 'low'
},
{
  'title': '[All] New public exploit has been found on CVE-2020-0608',
  'trigger': 'add_exploit',
  'action': 'debug',
  'target': 'exploits',
  'on_monitored': False,
  'conditions': [
    'vuln': {
      'cve_id': 'CVE-2020-0608',
    }
    'exploit': {
      'availability': 'public'
    }
  ],
  'severity': 'low'
},
]
