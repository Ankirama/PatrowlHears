(function(t){function e(e){for(var n,o,r=e[0],l=e[1],c=e[2],u=0,v=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&v.push(i[o][0]),i[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);d&&d(e);while(v.length)v.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],n=!0,r=1;r<a.length;r++){var l=a[r];0!==i[l]&&(n=!1)}n&&(s.splice(e--,1),t=o(o.s=a[0]))}return t}var n={},i={app:0},s=[];function o(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=n,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(a,n,function(e){return t[e]}.bind(null,n));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var d=l;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"3d91":function(t,e,a){"use strict";var n=a("b051"),i=a.n(n);i.a},"3f07":function(t,e,a){"use strict";var n=a("7e07"),i=a.n(n);i.a},4678:function(t,e,a){var n={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function i(t){var e=s(t);return a(e)}function s(t){if(!a.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}i.keys=function(){return Object.keys(n)},i.resolve=s,t.exports=i,i.id="4678"},"4cea":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("4de4"),a("fb6a"),a("d3b7"),a("25f0"),a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("router-view")],1)},s=[],o={name:"App",data:function(){return{section:"AppLayout"}},created:function(){document.title="PatrowlHears"},methods:{logout:function(){this.$store.commit("removeToken"),this.$router.push("/auth")}}},r=o,l=a("2877"),c=a("6544"),d=a.n(c),u=a("7496"),v=Object(l["a"])(r,i,s,!1,null,null,null),h=v.exports;d()(v,{VApp:u["a"]});var m=a("0628"),p=a.n(m),f=a("df76"),g=a.n(f),_=a("f309");n["a"].use(_["a"]);var b=new _["a"]({}),k=a("8c4f"),x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:"","align-center":"","justify-center":"","fill-height":""}},[a("v-flex",{attrs:{xs12:"",sm8:"",lg4:"",md5:""}},[a("v-card",{staticClass:"login-card"},[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Login to PatrowlHears")])]),a("v-spacer"),a("v-card-text",[t.loading?a("v-layout",{attrs:{row:"","fill-height":"","justify-center":"","align-center":""}},[a("v-progress-circular",{attrs:{size:50,color:"primary",indeterminate:""}})],1):a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-container",[a("v-text-field",{attrs:{counter:70,label:"username",maxlength:"70",required:""},model:{value:t.credentials.username,callback:function(e){t.$set(t.credentials,"username",e)},expression:"credentials.username"}}),a("v-text-field",{attrs:{type:"password",counter:20,label:"password",rules:t.rules.password,maxlength:"20",required:""},model:{value:t.credentials.password,callback:function(e){t.$set(t.credentials,"password",e)},expression:"credentials.password"}})],1),a("v-btn",{staticClass:"pink white--text",attrs:{disabled:!t.valid},on:{click:t.login}},[t._v("Login")])],1)],1)],1)],1)],1)],1)},y=[],w=a("bc3a"),C=a.n(w),V=a("3d20"),j=a.n(V),T={name:"AuthLayout",data:function(){return{credentials:{},valid:!0,loading:!1,rules:{username:[function(t){return!!t||"Username is required"},function(t){return t&&t.length>3||"A username must be more than 3 characters long"},function(t){return/^[a-z0-9_]+$/.test(t)||"A username can only contain letters and digits"}],password:[function(t){return!!t||"Password is required"},function(t){return t&&t.length>7||"The password must be longer than 7 characters"}]}}},methods:{login:function(){var t=this;this.$refs.form.validate()&&(this.loading=!0,this.$store.commit("removeToken"),this.$api.post(this.$store.state.endpoints.obtainJWT,this.credentials).then((function(e){t.$store.commit("updateToken",e.data.access),t.$api.get("/users/api/current").then((function(e){t.$store.commit("setAuthUser",{authUser:e.data,isAuthenticated:!0}),t.$router.push({name:"Vulns"})}))})).catch((function(e){t.$store.commit("removeToken"),t.loading=!1,j.a.fire({title:"Error",text:"Wrong username or password",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})))}}},S=T,I=a("8336"),P=a("b0af"),D=a("99d9"),B=a("a523"),$=a("0e8f"),E=a("4bd4"),A=a("a722"),L=a("490a"),M=a("2fa4"),O=a("8654"),Y=Object(l["a"])(S,x,y,!1,null,null,null),F=Y.exports;d()(Y,{VBtn:I["a"],VCard:P["a"],VCardText:D["c"],VCardTitle:D["d"],VContainer:B["a"],VFlex:$["a"],VForm:E["a"],VLayout:A["a"],VProgressCircular:L["a"],VSpacer:M["a"],VTextField:O["a"]});var z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:"","align-center":"","justify-center":"","fill-height":""}},[a("v-flex",{attrs:{xs12:"",sm8:"",lg4:"",md5:""}},[a("v-card",{staticClass:"login-card"},[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Login to PatrowlHears")])]),a("v-spacer"),a("v-card-text",[t.loading?a("v-layout",{attrs:{row:"","fill-height":"","justify-center":"","align-center":""}},[a("v-progress-circular",{attrs:{size:50,color:"primary",indeterminate:""}})],1):a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-container",[a("v-text-field",{attrs:{counter:70,label:"username",maxlength:"70",required:""},model:{value:t.credentials.username,callback:function(e){t.$set(t.credentials,"username",e)},expression:"credentials.username"}}),a("v-text-field",{attrs:{type:"password",counter:20,label:"password",rules:t.rules.password,maxlength:"20",required:""},model:{value:t.credentials.password,callback:function(e){t.$set(t.credentials,"password",e)},expression:"credentials.password"}})],1),a("v-btn",{staticClass:"pink white--text",attrs:{disabled:!t.valid},on:{click:t.login}},[t._v("Login")])],1)],1)],1)],1)],1)],1)},N=[],U={name:"UserAuth",data:function(){return{credentials:{},valid:!0,loading:!1,rules:{username:[function(t){return!!t||"Username is required"},function(t){return t&&t.length>3||"A username must be more than 3 characters long"},function(t){return/^[a-z0-9_]+$/.test(t)||"A username can only contain letters and digits"}],password:[function(t){return!!t||"Password is required"},function(t){return t&&t.length>7||"The password must be longer than 7 characters"}]}}},methods:{login:function(){var t=this;this.$refs.form.validate()&&(this.loading=!0,C.a.post("http://localhost:8000/auth-jwt/obtain_jwt_token/",this.credentials).then((function(e){t.$session.start(),t.$session.set("token",e.data.token),localStorage.setItem("authToken",e.data.token),localStorage.setItem("username",t.credentials.username),ca.push("/")})).catch((function(e){console.log(e),t.loading=!1,j.a.fire({title:"Error",text:"Wrong username or password",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})))}}},R=U,H=Object(l["a"])(R,z,N,!1,null,null,null);H.exports;d()(H,{VBtn:I["a"],VCard:P["a"],VCardText:D["c"],VCardTitle:D["d"],VContainer:B["a"],VFlex:$["a"],VForm:E["a"],VLayout:A["a"],VProgressCircular:L["a"],VSpacer:M["a"],VTextField:O["a"]});var J=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-navigation-drawer",{attrs:{clipped:"",app:"",color:"grey lighten-4"},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("v-list",{staticClass:"grey lighten-4",attrs:{dense:""}},[t._l(t.menu_items,(function(e,n){return[e.submenu?a("v-list-group",{attrs:{"no-action":"","prepend-icon":e.icon},scopedSlots:t._u([{key:"activator",fn:function(){return[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.text)}})],1)]},proxy:!0}],null,!0)},t._l(e.submenu,(function(e,n){return a("v-list-item",{key:n,attrs:{to:e.to}},[a("v-list-item-content",[a("v-list-item-title",{attrs:{link:"",to:e.to},domProps:{textContent:t._s(e.text)}})],1)],1)})),1):e.divider?a("v-divider",{key:n}):a("v-list-item",{key:n,attrs:{link:"",to:e.to}},[a("v-list-item-action",[a("v-icon",[t._v(t._s(e.icon))])],1),a("v-list-item-content",[a("v-list-item-title",{staticClass:"grey-darken-3--text"},[t._v(" "+t._s(e.text)+" ")])],1)],1)]}))],2)],1),a("v-app-bar",{attrs:{app:"","clipped-left":"",color:"light-blue accent-4",dense:""}},[a("v-app-bar-nav-icon",{on:{click:function(e){t.drawer=!t.drawer}}}),a("span",{staticClass:"title ml-3 mr-5"},[t._v("Patrowl "),a("span",{staticClass:"font-weight-light"},[t._v("Hears")])]),a("v-text-field",{attrs:{"solo-inverted":"",flat:"","hide-details":"",label:"Search","prepend-inner-icon":"mdi-magnify",dense:""},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search()}},model:{value:t.appsearch,callback:function(e){t.appsearch=e},expression:"appsearch"}}),a("v-spacer"),a("v-btn",{attrs:{icon:""}},[a("v-icon",[t._v("mdi-bell")])],1),t._v(" "+t._s(t.username)+" "),a("v-btn",{attrs:{icon:""},on:{click:t.logout}},[a("v-icon",[t._v("mdi-logout")])],1)],1),a("v-content",[a("v-container",{attrs:{fluid:""}},[a("router-view")],1)],1),a("v-footer",{attrs:{app:""}})],1)},W=[],q={name:"AppLayout",data:function(){return{drawer:null,appsearch:"",menu_items:[{icon:"mdi-bookmark",text:"KB",to:"",submenu:[{icon:"mdi-bookmark",text:"Vendors & Products",to:"/kb/products"},{icon:"mdi-bookmark",text:"CVE",to:"/kb/cves"},{icon:"mdi-bookmark",text:"Bulletins",to:"/kb/bulletins"}]},{divider:!0},{icon:"mdi-file-find",text:"Vulnerabilities",to:"/vulns"},{icon:"mdi-knife-military",text:"Exploits",to:"/exploits"},{icon:"mdi-security",text:"Ratings",to:"/ratings"},{icon:"mdi-alert",text:"Alerts",to:"/alerts"},{icon:"mdi-file-chart",text:"Reports"},{divider:!0},{icon:"mdi-settings",text:"Settings",to:"/settings"},{icon:"mdi-help-circle",text:"Help"}],username:""}},computed:{isAuthenticated:function(){return this.$store.getters.isAuthenticated}},mounted:function(){this.getUsername()},methods:{logout:function(){localStorage.removeItem("authToken"),localStorage.removeItem("username"),this.$router.push("/auth")},getUsername:function(){this.username=this.$store.state.authUser.username},search:function(){this.$route.path==="/search/"+this.appsearch?this.$router.go():this.$router.push({path:"/search/"+this.appsearch})}}},K=q,G=a("40dc"),Q=a("5bc1"),X=a("a75b"),Z=a("ce7e"),tt=a("553a"),et=a("132d"),at=a("8860"),nt=a("56b0"),it=a("da13"),st=a("1800"),ot=a("5d23"),rt=a("f774"),lt=Object(l["a"])(K,J,W,!1,null,null,null),ct=lt.exports;d()(lt,{VApp:u["a"],VAppBar:G["a"],VAppBarNavIcon:Q["a"],VBtn:I["a"],VContainer:B["a"],VContent:X["a"],VDivider:Z["a"],VFooter:tt["a"],VIcon:et["a"],VList:at["a"],VListGroup:nt["a"],VListItem:it["a"],VListItemAction:st["a"],VListItemContent:ot["a"],VListItemTitle:ot["c"],VNavigationDrawer:rt["a"],VSpacer:M["a"],VTextField:O["a"]});var dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v(" Homepage ")])},ut=[],vt={name:"Home",mounted:function(){},methods:{}},ht=vt,mt=Object(l["a"])(ht,dt,ut,!1,null,null,null),pt=mt.exports,ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v(" Alert Page - TODO ")])},gt=[],_t={name:"Alerts",mounted:function(){},methods:{}},bt=_t,kt=Object(l["a"])(bt,ft,gt,!1,null,null,null),xt=kt.exports,yt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v(" Ratings Page - TODO ")])},wt=[],Ct={name:"Ratings",mounted:function(){},methods:{}},Vt=Ct,jt=Object(l["a"])(Vt,yt,wt,!1,null,null,null),Tt=jt.exports,St=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v(" Settings Page - TODO ")])},It=[],Pt={name:"Settings",mounted:function(){},methods:{}},Dt=Pt,Bt=Object(l["a"])(Dt,St,It,!1,null,null,null),$t=Bt.exports,Et=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v(" Search page - Results for "+t._s(this.appsearch)+" "),!0===t.loading?a("v-progress-circular",{attrs:{indeterminate:"",rotate:"0",size:"24",width:"4",color:"deep-orange"}}):t._e(),a("v-container",{attrs:{fluid:""}},[a("v-row",{attrs:{dense:""}},t._l(t.results,(function(e){return a("v-col",{key:e.type+e.value.id,attrs:{cols:"4"}},[a("v-card",["vuln"==e.type?a("v-card-title",[t._v(" Vulnerability #PHID-"+t._s(e.value.id)+" ")]):t._e(),"vuln"==e.type?a("v-card-subtitle",[a("v-clamp",{attrs:{autoresize:"","max-lines":3},scopedSlots:t._u([{key:"after",fn:function(e){var n=e.toggle,i=e.expanded,s=e.clamped;return i||s?a("button",{staticClass:"toggle btn btn-sm",on:{click:n}},[t._v(" "+t._s(" more")+" ")]):t._e()}}],null,!0)},[t._v(" "+t._s(e.value.summary)+" ")])],1):t._e(),"vuln"==e.type?a("v-card-text",[a("dl",[a("dt",[t._v("Score")]),a("dd",[a("v-chip",{staticClass:"pa-2",attrs:{small:"",label:"",color:t.getRatingColor(e.value.score)}},[t._v(" "+t._s(e.value.score)+" ")])],1),a("dt",[t._v("CVE")]),a("dd",[t._v(t._s(e.value.cve_id))]),a("dt",[t._v("CVSSv2")]),a("dd",[t._v(t._s(e.value.cvss)+" - "+t._s(e.value.cvss_vector))]),a("dt",[t._v("Products")]),a("dd",[t._v(t._s(t.getVendorProduct(e.value.vulnerable_products)))]),a("dt",[t._v("Last update")]),a("dd",[t._v(t._s(t.moment(e.value.updated_at).format("YYYY-MM-DD")))])]),a("v-chip",{staticClass:"pa-2",staticStyle:{height:"20px"},attrs:{outlined:"",color:t.getBoolColor(e.value.is_exploitable)}},[t._v(" Exploitable: "+t._s(t.getBoolValue(e.value.is_exploitable))+" ")]),t._v(" "),a("v-chip",{staticClass:"pa-2",staticStyle:{height:"20px"},attrs:{outlined:"",color:t.getBoolColor(e.value.is_confirmed)}},[t._v(" Confirmed: "+t._s(t.getBoolValue(e.value.is_confirmed))+" ")]),t._v(" "),a("v-chip",{staticClass:"pa-2",staticStyle:{height:"20px"},attrs:{outlined:"",color:t.getBoolColor(e.value.is_in_the_news)}},[t._v(" In the news: "+t._s(t.getBoolValue(e.value.is_in_the_news))+" ")]),t._v(" "),a("v-chip",{staticClass:"pa-2",staticStyle:{height:"20px"},attrs:{outlined:"",color:t.getBoolColor(e.value.is_in_the_wild)}},[t._v(" In the wild: "+t._s(t.getBoolValue(e.value.is_in_the_wild))+" ")])],1):t._e(),"exploit"==e.type?a("v-card-title",[t._v(" Exploit for #PHID-"+t._s(e.value.vuln)+" ")]):t._e(),"exploit"==e.type?a("v-card-subtitle",[t._v(" "+t._s(e.value.link)+" ")]):t._e(),"exploit"==e.type?a("v-card-text",[a("dl",[a("dt",[t._v("Trust Level")]),a("dd",[t._v(t._s(t._f("capitalize")(e.value.trust_level)))]),a("dt",[t._v("TLP")]),a("dd",[t._v(t._s(t._f("capitalize")(e.value.tlp_level)))]),a("dt",[t._v("Source")]),a("dd",[t._v(t._s(t._f("capitalize")(e.value.source)))]),a("dt",[t._v("Availability")]),a("dd",[t._v(t._s(t._f("capitalize")(e.value.availability)))]),a("dt",[t._v("Maturity")]),a("dd",[t._v(t._s(t._f("capitalize")(e.value.maturity)))]),a("dt",[t._v("Notes")]),a("dd",[a("v-clamp",{attrs:{autoresize:"","max-lines":5},scopedSlots:t._u([{key:"after",fn:function(e){var n=e.toggle,i=e.expanded,s=e.clamped;return i||s?a("button",{on:{click:n}},[t._v(" "+t._s(" more")+" ")]):t._e()}}],null,!0)},[t._v(" "+t._s(e.value.notes)+" ")])],1),a("dt",[t._v("Last update")]),a("dd",[t._v(t._s(t.moment(e.value.modified).format("YYYY-MM-DD")))])])]):t._e(),a("v-card-actions",["exploit"==e.type?a("v-btn",{attrs:{text:"",color:"deep-orange accent-4",to:"/vulns/"+e.value.vuln}},[t._v("Explore")]):t._e(),"vuln"==e.type?a("v-btn",{attrs:{text:"",color:"deep-orange accent-4",to:"/vulns/"+e.value.id}},[t._v("Explore")]):t._e()],1)],1)],1)})),1)],1)],1)},At=[],Lt=(a("a4d3"),a("e01a"),a("d28b"),a("a15b"),a("ac1f"),a("6062"),a("3ca3"),a("5319"),a("1276"),a("498a"),a("ddb0"),a("2909")),Mt=a("3f87"),Ot={methods:{getCVSSColor:function(t){return t>=9?"red darken-4":t>=7?"red":t>=4?"orange":t>=.1?"yellow":"grey"},getTLPColor:function(t){return"white"===t?"":"green"===t?"green":"amber"===t?"orange":"red"===t?"red":"black"===t?"black":"grey"},getRatingColor:function(t){return t>=80?"red":t>=60?"orange":t>=40?"yellow":t>=0?"blue":"grey"},getBoolColor:function(t){return t?"deep-orange":"grey"}},mounted:function(){},destroyed:function(){}},Yt={name:"Search",mixins:[Ot],components:{VClamp:Mt["a"]},data:function(){return{results:[],totalresults:0,loading:!0,limit:25,options:{},appsearch:""}},beforeRouteUpdate:function(t){this.appsearch=t.params.appsearch},mounted:function(){this.appsearch=this.$router.currentRoute.params.appsearch},watch:{appsearch:{handler:function(t){this.appsearch=t,this.getDataFromApi()}}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var n=t.options,i=n.sortBy,s=n.sortDesc,o=n.page,r=(n.itemsPerPage,t.search_query(o,t.limit,i,s));setTimeout((function(){e({items:r})}),300)}))},search_query:function(t,e,a,n){var i=this,s="",o=this.appsearch.trim().toLowerCase();this.$api.get("/api/search/"+o+"?limit="+e+"&page="+t+s).then((function(t){return i.results=t.data,i.loading=!1,i.vulns})).catch((function(t){i.results=[],i.loading=!1,swal.fire({title:"Error",text:"unable to get results from search query",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},getBoolValue:function(t){return t?"Yes":"No"},getVendorProduct:function(t){if(void 0==t)return"unknown";var e,a,n=Array(),i=!0,s=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(i=(r=l.next()).done);i=!0)e=r.value,a=e.split(":")[4].replace(/_/g," ")+" ("+e.split(":")[3].replace(/_/g," ")+")",n.push(a)}catch(c){s=!0,o=c}finally{try{i||null==l.return||l.return()}finally{if(s)throw o}}return n=Object(Lt["a"])(new Set(n)),n.join(", ")}}},Ft=Yt,zt=(a("3f07"),a("cc20")),Nt=a("62ad"),Ut=a("0fd9"),Rt=Object(l["a"])(Ft,Et,At,!1,null,null,null),Ht=Rt.exports;d()(Rt,{VBtn:I["a"],VCard:P["a"],VCardActions:D["a"],VCardSubtitle:D["b"],VCardText:D["c"],VCardTitle:D["d"],VChip:zt["a"],VCol:Nt["a"],VContainer:B["a"],VProgressCircular:L["a"],VRow:Ut["a"]});var Jt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Vulnerabilities ")]),a("v-col",{staticClass:"pa-2"},[a("v-chip",{attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(this.show_all)},on:{click:function(e){return t.toggleShowAll()}}},[t._v("All")]),t._v(" "),a("v-chip",{attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(this.show_last_day)},on:{click:function(e){return t.toggleShowLastDay()}}},[t._v("Last 24h")]),t._v(" "),a("v-chip",{attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(this.show_last_week)},on:{click:function(e){return t.toggleShowLastWeek()}}},[t._v("Last Week")])],1),a("v-col",{staticClass:"pa-2",attrs:{md:"6"}},[a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)],1)],1)],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.vulns.results,options:t.options,"server-items-length":t.vulns.count,search:t.search,"items-per-page":20,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id","show-select":"","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.summary",fn:function(e){var n=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1},scopedSlots:t._u([{key:"after",fn:function(e){var n=e.toggle,i=e.expanded,s=e.clamped;return i||s?a("button",{staticClass:"toggle btn btn-sm",on:{click:n}},[t._v(" "+t._s(" more")+" ")]):t._e()}}],null,!0)},[t._v(" "+t._s(n.summary)+" ")])]}},{key:"item.score",fn:function(e){var n=e.item;return[a("v-chip",{staticClass:"text-center",attrs:{color:t.getRatingColor(n.score),small:""}},[t._v(" "+t._s(n.score)+" ")])]}},{key:"item.is_exploitable",fn:function(e){var n=e.item;return[a("v-chip",{staticClass:"text-center",attrs:{color:t.getBool(n.is_exploitable),small:"",label:""}})]}},{key:"item.is_confirmed",fn:function(e){var n=e.item;return[1==n.is_confirmed?a("v-icon",{staticClass:"mdi mdi-check",attrs:{small:"",color:"gray"}}):t._e()]}},{key:"item.updated_at",fn:function(e){var n=e.item;return[a("span",[t._v(t._s(t.moment(n.updated_at).format("YYYY-MM-DD, hh:mm:ss")))])]}},{key:"item.action",fn:function(e){var n=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewVuln(n.id)}}}),a("v-icon",{staticClass:"mdi mdi-pencil",attrs:{small:"",color:"orange"},on:{click:function(e){return t.editVuln(n)}}}),a("v-icon",{staticClass:"mdi mdi-delete",attrs:{small:"",color:"red"},on:{click:function(e){return t.deleteVuln(n)}}})]}}])})],1)],1)},Wt=[],qt=(a("841c"),a("c1df")),Kt=a.n(qt),Gt={name:"vulns",mixins:[Ot],components:{VClamp:Mt["a"]},data:function(){return{vulns:[],totalvulns:0,loading:!0,limit:20,search:"",show_all:!1,show_last_day:!0,show_last_week:!1,options:{},selected:[],headers:[{text:"PHID",value:"id"},{text:"CVE",value:"cve",width:"150px"},{text:"Summary",value:"summary"},{text:"CVSSv2",value:"cvss",align:"center"},{text:"Score",value:"score",align:"center"},{text:"Exploits",value:"exploit_count",align:"center"},{text:"Confirm ?",value:"is_confirmed",align:"center"},{text:"Last update",value:"updated_at",align:"center"},{text:"Actions",value:"action",sortable:!1}],rowsPerPageItems:[5,10,20,50,100]}},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi()},deep:!0},options:{handler:function(){this.getDataFromApi().then((function(t){}))},deep:!0},show_all:{handler:function(){this.getDataFromApi()},deep:!0},show_last_day:{handler:function(){this.getDataFromApi()},deep:!0},show_last_week:{handler:function(){this.getDataFromApi()},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var n=t.options,i=n.sortBy,s=n.sortDesc,o=n.page,r=n.itemsPerPage;t.search.trim().toLowerCase();t.limit=r;var l=t.getVulns(o,t.limit,i,s);setTimeout((function(){e({items:l})}),300)}))},getVulns:function(t,e,a,n){var i=this,s="";a.length>0&&(s=!0===n[0]?"sorted_by=-"+a:"sorted_by="+a);var o="";1==this.show_last_day?o="&updated_at__gte="+Kt()(new Date).format("YYYY-MM-DD"):1==this.show_last_week&&(o="&updated_at__gte="+Kt()(new Date).subtract(7,"day").format("YYYY-MM-DD")),this.$api.get("/api/vulns/?limit="+e+"&page="+t+"&search="+this.search+"&"+s+o).then((function(t){return i.vulns=t.data,i.loading=!1,i.vulns})).catch((function(t){i.vulns=[],i.loading=!1,j.a.fire({title:"Error",text:"unable to get vulns",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},viewVuln:function(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t}})},editVuln:function(t){},deleteVuln:function(t){},clickRow:function(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t.id}})},getBool:function(t){return 1==t?"red":"grey"},toggleShowAll:function(){0==this.show_all&&(this.show_all=!this.show_all),1==this.show_all&&(this.show_last_day=!1,this.show_last_week=!1)},toggleShowLastDay:function(){1==this.show_last_day&&(this.show_all=!0,this.show_last_day=!1,this.show_last_week=!1),0==this.show_last_day&&(this.show_last_day=!0,this.show_all=!1,this.show_last_week=!1)},toggleShowLastWeek:function(){1==this.show_last_week&&(this.show_all=!0,this.show_last_day=!1,this.show_last_week=!1),0==this.show_last_week&&(this.show_last_week=!0,this.show_all=!1,this.show_last_day=!1)}}},Qt=Gt,Xt=(a("8083"),a("8fea")),Zt=Object(l["a"])(Qt,Jt,Wt,!1,null,null,null),te=Zt.exports;d()(Zt,{VCard:P["a"],VCardTitle:D["d"],VChip:zt["a"],VCol:Nt["a"],VContainer:B["a"],VDataTable:Xt["a"],VIcon:et["a"],VRow:Ut["a"],VTextField:O["a"]});var ee=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("Summary")]),a("v-tab",[this.exploits.length>0?a("v-badge",{attrs:{color:"deep-orange",content:this.exploits.length}},[t._v("Exploits")]):t._e(),0==this.exploits.length?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Exploits")]):t._e()],1),a("v-tab",[this.threats.length>0?a("v-badge",{attrs:{color:"deep-orange",content:this.threats.length}},[t._v("Threat activities")]):t._e(),0==this.threats.length?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Threat activities")]):t._e()],1),a("v-tab",[t._v("Timeline")]),a("v-tab-item",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md8:""}},[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[a("v-container",{staticClass:"grey lighten-5"},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Vuln ID: PH-"+t._s(t.$route.params.vuln_id)+" ")]),a("v-col",{staticClass:"pa-2"},[this.vuln.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.toggleMonitored}},[t._v("Monitored")]):t._e(),this.vuln.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.toggleMonitored}},[t._v("Not monitored")])],1)],1)],1)],1),a("v-card-text",[a("v-list",{attrs:{subheader:"",color:"grey lighten-5"}},[a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("CVE")]),t._v(" "+t._s(this.vuln.cve)+" ")],1)],1),a("v-list-item",[a("v-list-item-content",{staticClass:"d-inline"},[a("v-list-item-subtitle",[t._v("CVSSv2")]),a("v-chip",{attrs:{small:"",label:"",color:t.getCVSSColor(this.vuln.cvss)}},[t._v(" "+t._s(this.vuln.cvss)+" ")]),t._v(" - "+t._s(this.vuln.cvss_vector)+" ("+t._s(t.moment(this.vuln.cvss_time).format("YYYY-MM-DD"))+") ")],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Summary")]),t._v(" "+t._s(this.vuln.summary)+" ")],1)],1),""!=this.vuln.cwe_id?a("v-list-item",{attrs:{href:"https://cwe.mitre.org/data/definitions/"+this.vuln.cwe_id+".html"}},[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("CWE")]),t._v(" CWE-"+t._s(this.vuln.cwe_id)+" ")],1)],1):t._e(),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Links")]),a("ul",{attrs:{id:"v-for-reflinks"}},t._l(this.vuln.reflinks,(function(e){return a("li",{attrs:{link:""}},[a("a",{attrs:{href:e}},[t._v(" "+t._s(e)+" ")])])})),0)],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Vulnerable products (CPE)")]),a("ul",{attrs:{id:"v-for-cpe"}},t._l(this.vuln.vulnerable_products,(function(e){return a("li",[t._v(" "+t._s(e)+" ")])})),0)],1)],1)],1)],1)],1)],1),a("v-flex",{attrs:{md4:""}},[a("v-flex",[this.ratings.score>=0?a("v-card",{attrs:{color:t.getRatingColor(t.vprating)}},[a("v-card-title",{staticClass:"title"},[t._v("Rating Scores")]),a("v-card-text",[a("v-row",{attrs:{align:"center"}},[a("v-col",{staticClass:"display-3",attrs:{cols:"4",align:"center"}},[t._v(" "+t._s(t.vprating)+" ")]),a("v-col",{attrs:{cols:"6"}},[t._v(" CVSSv2 Base: "+t._s(t.cvssv2adj[0])+" CVSSv2 Temporal: "+t._s(t.cvssv2adj[1])+" ")])],1)],1)],1):t._e()],1),a("v-flex",[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v("Metrics")]),a("v-card-text",[a("v-switch",{attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Exploitable"},model:{value:t.is_exploitable,callback:function(e){t.is_exploitable=e},expression:"is_exploitable"}}),a("v-switch",{attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Confirmed"},model:{value:t.is_confirmed,callback:function(e){t.is_confirmed=e},expression:"is_confirmed"}}),a("v-switch",{attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Relayed in the News"},model:{value:t.is_in_the_news,callback:function(e){t.is_in_the_news=e},expression:"is_in_the_news"}}),a("v-switch",{attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Exploited in the Wild"},model:{value:t.is_in_the_wild,callback:function(e){t.is_in_the_wild=e},expression:"is_in_the_wild"}})],1)],1)],1),a("v-flex",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-card",{attrs:{color:"grey lighten-5",height:"100%"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v("Impact")]),a("v-card-text",[t._v(" Confidentiality: "+t._s(this.vuln.impact.confidentiality)),a("br"),t._v(" Integrity: "+t._s(this.vuln.impact.integrity)),a("br"),t._v(" Availability: "+t._s(this.vuln.impact.availability)),a("br")])],1)],1),a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-card",{attrs:{color:"grey lighten-5",height:"100%"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v("Access")]),a("v-card-text",[t._v(" Authentication: "+t._s(this.vuln.access.authentication)),a("br"),t._v(" Complexity: "+t._s(this.vuln.access.complexity)),a("br"),t._v(" Vector: "+t._s(this.vuln.access.vector)),a("br")])],1)],1)],1)],1)],1)],1)],1)],1),a("v-tab-item",[a("v-card",[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.exploit_headers,items:t.exploits,"item-key":"id","multi-sort":"","show-expand":"",expanded:t.expanded},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"item.link",fn:function(e){var n=e.item;return[a("a",{attrs:{href:n.link}},[t._v(t._s(n.link))])]}},{key:"item.trust_level",fn:function(e){var a=e.item;return[t._v(" "+t._s(t._f("capitalize")(a.trust_level))+" ")]}},{key:"item.tlp_level",fn:function(e){var n=e.item;return[a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",small:"",color:t.getTLPColor(n.tlp_level)}},[t._v(" TLP:"+t._s(t._f("capitalize")(n.tlp_level))+" ")])]}},{key:"item.modified",fn:function(e){var n=e.item;return[a("span",[t._v(t._s(t.moment(n.modified).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var n=e.item;return[a("v-icon",{staticClass:"mdi mdi-pencil",attrs:{small:"",color:"orange"},on:{click:function(e){return t.editExploit(n)}}}),a("v-icon",{staticClass:"mdi mdi-delete",attrs:{small:"",color:"red"},on:{click:function(e){return t.deleteExploit(n)}}})]}},{key:"expanded-item",fn:function(e){var n=e.headers,i=e.item;return[a("td",{attrs:{colspan:n.length}},[t._v(t._s(i.notes))])]}}])}),a("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-btn",t._g({attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"}},n),[a("v-icon",[t._v("mdi-plus")])],1)]}}]),model:{value:t.dialog_exploit,callback:function(e){t.dialog_exploit=e},expression:"dialog_exploit"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v(t._s(t.formExploitTitle))])]),a("v-card-text",[a("v-container",[a("v-form",{ref:"form-new-exploit"},[a("v-text-field",{attrs:{label:"link"},model:{value:t.editedItem.link,callback:function(e){t.$set(t.editedItem,"link",e)},expression:"editedItem.link"}}),a("v-select",{attrs:{label:"Trust Level",items:t.editedItem.trust_level_items},model:{value:t.editedItem.trust_level,callback:function(e){t.$set(t.editedItem,"trust_level",e)},expression:"editedItem.trust_level"}}),a("v-select",{attrs:{label:"TLP Level",items:t.editedItem.tlp_level_items},model:{value:t.editedItem.tlp_level,callback:function(e){t.$set(t.editedItem,"tlp_level",e)},expression:"editedItem.tlp_level"}}),a("v-text-field",{attrs:{label:"Source"},model:{value:t.editedItem.source,callback:function(e){t.$set(t.editedItem,"source",e)},expression:"editedItem.source"}}),a("v-select",{attrs:{label:"Availability",items:t.editedItem.availability_items},model:{value:t.editedItem.availability,callback:function(e){t.$set(t.editedItem,"availability",e)},expression:"editedItem.availability"}}),a("v-select",{attrs:{label:"Maturity",items:t.editedItem.maturity_items},model:{value:t.editedItem.maturity,callback:function(e){t.$set(t.editedItem,"maturity",e)},expression:"editedItem.maturity"}}),a("v-text-field",{attrs:{label:"Notes"},model:{value:t.editedItem.notes,callback:function(e){t.$set(t.editedItem,"notes",e)},expression:"editedItem.notes"}}),a("v-btn",{attrs:{color:"success"},on:{click:t.saveNewExploit}},[t._v("Save")]),a("v-btn",{attrs:{color:"warning",type:"reset"}},[t._v("Reset")])],1)],1)],1),a("v-card-actions",[a("v-spacer")],1)],1)],1)],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1),a("v-tab-item",[a("v-card",[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.threat_headers,items:t.threats,"item-key":"id","multi-sort":"","show-expand":"",expanded:t.expanded},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"item.link",fn:function(e){var n=e.item;return[a("a",{attrs:{href:n.link}},[t._v(t._s(n.link))])]}},{key:"item.trust_level",fn:function(e){var a=e.item;return[t._v(" "+t._s(t._f("capitalize")(a.trust_level))+" ")]}},{key:"item.tlp_level",fn:function(e){var n=e.item;return[a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",small:"",color:t.getTLPColor(n.tlp_level)}},[t._v(" TLP:"+t._s(t._f("capitalize")(n.tlp_level))+" ")])]}},{key:"item.modified",fn:function(e){var n=e.item;return[a("span",[t._v(t._s(t.moment(n.modified).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var n=e.item;return[a("v-icon",{staticClass:"mdi mdi-pencil",attrs:{small:"",color:"orange"},on:{click:function(e){return t.editThreat(n)}}}),a("v-icon",{staticClass:"mdi mdi-delete",attrs:{small:"",color:"red"},on:{click:function(e){return t.deleteThreat(n)}}})]}},{key:"expanded-item",fn:function(e){var n=e.headers,i=e.item;return[a("td",{attrs:{colspan:n.length}},[t._v(t._s(i.notes))])]}}])}),a("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-btn",t._g({attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"}},n),[a("v-icon",[t._v("mdi-plus")])],1)]}}]),model:{value:t.dialog_threat,callback:function(e){t.dialog_threat=e},expression:"dialog_threat"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v(t._s(t.formThreatTitle))])]),a("v-card-text",[a("v-container",[a("v-form",{ref:"form-new-threat"},[a("v-text-field",{attrs:{label:"link"},model:{value:t.editedItem.link,callback:function(e){t.$set(t.editedItem,"link",e)},expression:"editedItem.link"}}),a("v-select",{attrs:{label:"Trust Level",items:t.editedItem.trust_level_items},model:{value:t.editedItem.trust_level,callback:function(e){t.$set(t.editedItem,"trust_level",e)},expression:"editedItem.trust_level"}}),a("v-select",{attrs:{label:"TLP Level",items:t.editedItem.tlp_level_items},model:{value:t.editedItem.tlp_level,callback:function(e){t.$set(t.editedItem,"tlp_level",e)},expression:"editedItem.tlp_level"}}),a("v-text-field",{attrs:{label:"Source"},model:{value:t.editedItem.source,callback:function(e){t.$set(t.editedItem,"source",e)},expression:"editedItem.source"}}),a("v-select",{attrs:{label:"Availability",items:t.editedItem.availability_items},model:{value:t.editedItem.availability,callback:function(e){t.$set(t.editedItem,"availability",e)},expression:"editedItem.availability"}}),a("v-select",{attrs:{label:"Maturity",items:t.editedItem.maturity_items},model:{value:t.editedItem.maturity,callback:function(e){t.$set(t.editedItem,"maturity",e)},expression:"editedItem.maturity"}}),a("v-text-field",{attrs:{label:"Notes"},model:{value:t.editedItem.notes,callback:function(e){t.$set(t.editedItem,"notes",e)},expression:"editedItem.notes"}}),a("v-btn",{attrs:{color:"success"},on:{click:t.saveNewThreat}},[t._v("Save")])],1)],1)],1),a("v-card-actions",[a("v-spacer")],1)],1)],1)],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1),a("v-tab-item",[this.history?a("v-card",[this.history.length>0?a("v-timeline",{attrs:{clipped:"",dense:""}},t._l(this.history,(function(e){return a("v-timeline-item",{key:e.date,attrs:{color:"blue",small:"","fill-dot":""}},[a("v-card",{staticClass:"elevation-2"},[a("v-card-title",{staticClass:"headline"},[t._v(t._s(e.reason)+" at '"+t._s(e.date)+"'")]),a("v-card-text",t._l(e.changes,(function(e){return a("span",{key:e},[t._v(t._s(e)),a("br")])})),0)],1)],1)})),1):t._e()],1):t._e()],1)],1)},ae=[],ne=(a("c975"),a("a434"),{name:"VulnDetails",data:function(){return{expanded:[],vuln_id:"",vuln:{cwe_id:"",impact:{confidentiality:"",integrity:"",availability:""},access:{authentication:"",complexity:"",vector:""}},ratings:{},history:{},threats:{},threat_headers:[{text:"Link",value:"link"},{text:"Trust level",value:"trust_level"},{text:"TLP",value:"tlp_level",align:"center"},{text:"Source",value:"source",align:"center"},{text:"In the Wild ?",value:"is_in_the_wild",align:"center"},{text:"In the News ?",value:"is_in_the_news",align:"center"},{text:"Last update",value:"modified",align:"center"},{text:"Actions",value:"action",sortable:!1},{text:"",value:"data-table-expand"}],exploits:[],exploit_headers:[{text:"Link",value:"link"},{text:"Trust level",value:"trust_level"},{text:"TLP",value:"tlp_level",align:"center"},{text:"Source",value:"source",align:"center"},{text:"Availability",value:"availability",align:"center"},{text:"Maturity",value:"maturity",align:"center"},{text:"Last update",value:"modified",align:"center"},{text:"Actions",value:"action",sortable:!1},{text:"",value:"data-table-expand"}],editedIndex:-1,defaultMetadata:{link:"https://",notes:"",trust_level:"trusted",trust_level_items:["unknown","low","medium","trusted"],tlp_level:"white",tlp_level_items:["white","green","amber","red","black"],source:"manual",availability:"public",availability_items:["unknown","private","public"],maturity:"unknown",maturity_items:["unknown","unproven","poc","functional"],modified:"",is_in_the_wild:0,is_in_the_news:0,published:""},editedItem:{},dialog_exploit:!1,dialog_threat:!1,snack:!1,snackColor:"",snackText:""}},mounted:function(){this.vuln_id=this.$router.currentRoute.params.vuln_id,this.editedItem=this.defaultMetadata,this.getDataFromApi(this.vuln_id)},computed:{formExploitTitle:function(){return-1===this.editedIndex?"New Exploit":"Edit Exploit"},formThreatTitle:function(){return-1===this.editedIndex?"New threat activity":"Edit threat activity"},is_exploitable:function(){return this.vuln.is_exploitable},is_confirmed:function(){return this.vuln.is_confirmed},is_in_the_news:function(){return this.vuln.is_in_the_news},is_in_the_wild:function(){return this.vuln.is_in_the_wild},vprating:function(){return this.ratings.score},cvssv2adj:function(){return this.ratings.cvssv2adj}},methods:{getDataFromApi:function(t){var e=this;return new Promise((function(a,n){var i=e.getVulnDetails(t),s=e.getHistory(t),o=e.getRatings(t),r=e.getExploits(t),l=e.getThreats(t);setTimeout((function(){e.loading=!1,a({vuln:i,history:s,ratings:o,exploits:r,threats:l})}),300)}))},getVulnDetails:function(t){var e=this;this.loading=!0,this.$api.get("/api/vulns/"+t).then((function(t){return e.vuln=t.data,e.vuln})).catch((function(t){e.vuln={},e.loading=!1,j.a.fire({title:"Error",text:"unable to get vuln details",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getRatings:function(t){var e=this;this.loading=!0,this.$api.get("/api/ratings/calc/"+t).then((function(t){return e.ratings=t.data,e.vuln})).catch((function(t){e.ratings={},e.loading=!1,j.a.fire({title:"Error",text:"unable to get vuln ratings",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getExploits:function(t){var e=this;this.loading=!0,this.$api.get("/api/vulns/"+t+"/exploits").then((function(t){return e.exploits=t.data,e.exploits})).catch((function(t){e.exploits={},e.loading=!1,j.a.fire({title:"Error",text:"unable to get related exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getThreats:function(t){var e=this;this.loading=!0,this.$api.get("/api/vulns/"+t+"/threats").then((function(t){return e.threats=t.data,e.threats})).catch((function(t){e.threats={},e.loading=!1,j.a.fire({title:"Error",text:"unable to get related threats",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getHistory:function(t){var e=this;this.loading=!0,this.$api.get("/api/vulns/"+t+"/history").then((function(t){return e.history=t.data,e.threats})).catch((function(t){e.history={},e.loading=!1,j.a.fire({title:"Error",text:"unable to get vuln history",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getCVSSColor:function(t){return t>=9?"red darken-4":t>=7?"red":t>=4?"orange":t>=.1?"yellow":"grey"},getTLPColor:function(t){return"white"===t?"":"green"===t?"green":"amber"===t?"orange":"red"===t?"red":"black"===t?"black":"grey"},getRatingColor:function(t){return t>=80?"red":t>=60?"orange":t>=40?"yellow":t>=0?"blue":"grey"},saveNewExploit:function(){var t=this;this.editedItem.modified=new Date,this.$api.post("/api/vulns/"+this.vuln_id+"/exploits/add",this.editedItem).then((function(e){e&&200===e.status?(t.snack=!0,t.snackColor="success",t.snackText="Exploit successfuly saved."):(t.snack=!0,t.snackColor="error",t.snackText="Unable to save the exploit metadata.")})).catch((function(e){t.loading=!1,j.a.fire({title:"Error",text:"unable to save related exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),t.dialog_exploit=!1,t.editedItem=t.defaultMetadata}));var e=JSON.parse(JSON.stringify(this.editedItem));this.editedIndex>-1?Object.assign(this.exploits[this.editedIndex],e):(console.log("push"),this.exploits.push(e)),this.editedItem=JSON.parse(JSON.stringify(this.defaultMetadata)),this.dialog_exploit=!1},editExploit:function(t){this.editedIndex=this.exploits.indexOf(t),this.editedItem=Object.assign({},t),this.dialog_exploit=!0,this.snack=!0,this.snackColor="success",this.snackText="Exploit successfuly edited."},deleteExploit:function(t){var e=this;this.$api.get("/api/vulns/"+this.vuln_id+"/exploits/"+t.id+"/del").then((function(t){t?(e.snack=!0,e.snackColor="success",e.snackText="Exploit successfuly deleted."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to delete the exploit")})).catch((function(t){e.loading=!1,j.a.fire({title:"Error",text:"unable to delete related exploit",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),e.dialog_exploit=!1})),this.editedIndex=this.exploits.indexOf(t),this.exploits.splice(this.editedIndex,1)},saveNewThreat:function(){var t=this;this.editedItem.modified=new Date,this.$api.post("/api/vulns/"+this.vuln_id+"/threats/add",this.editedItem).then((function(e){e&&200===e.status?(t.snack=!0,t.snackColor="success",t.snackText="Threat activity successfuly saved."):(t.snack=!0,t.snackColor="error",t.snackText="Unable to save the threat activity.")})).catch((function(e){t.loading=!1,j.a.fire({title:"Error",text:"unable to save related threat activity",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),t.dialog_threat=!1}));var e=JSON.parse(JSON.stringify(this.editedItem));this.editedIndex>-1?Object.assign(this.threats[this.editedIndex],e):this.threats.push(e),this.editedItem=JSON.parse(JSON.stringify(this.defaultMetadata)),this.dialog_threat=!1},editThreat:function(t){this.editedIndex=this.threats.indexOf(t),this.editedItem=Object.assign({},t),this.dialog_threat=!0,this.snack=!0,this.snackColor="success",this.snackText="Threat activity successfuly edited."},deleteThreat:function(t){var e=this;this.$api.get("/api/vulns/"+this.vuln_id+"/threats/"+t.id+"/del").then((function(t){t?(e.snack=!0,e.snackColor="success",e.snackText="Threat activity successfuly deleted."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to delete the threat activity")})).catch((function(t){e.loading=!1,j.a.fire({title:"Error",text:"unable to delete related threat activity",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),e.dialog_threat=!1})),this.editedIndex=this.threats.indexOf(t),this.threats.splice(this.editedIndex,1)},toggleMonitored:function(t){var e=this,a={monitored:!this.vuln.monitored};this.$api.put("/api/vulns/"+this.vuln_id+"/",a).then((function(t){t?(e.vuln.monitored=!e.vuln.monitored,e.snack=!0,e.snackColor="success",e.snackText="Vulnerability monitoring successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the vulnerability monitoring status")})).catch((function(t){e.loading=!1,j.a.fire({title:"Error",text:"Unable to change the vulnerability monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))}}}),ie=ne,se=a("4ca6"),oe=a("169a"),re=a("b974"),le=a("2db4"),ce=a("b73d"),de=a("71a3"),ue=a("c671"),ve=a("fe57"),he=a("8414"),me=a("1e06"),pe=Object(l["a"])(ie,ee,ae,!1,null,null,null),fe=pe.exports;d()(pe,{VBadge:se["a"],VBtn:I["a"],VCard:P["a"],VCardActions:D["a"],VCardText:D["c"],VCardTitle:D["d"],VChip:zt["a"],VCol:Nt["a"],VContainer:B["a"],VDataTable:Xt["a"],VDialog:oe["a"],VFlex:$["a"],VForm:E["a"],VIcon:et["a"],VLayout:A["a"],VList:at["a"],VListItem:it["a"],VListItemContent:ot["a"],VListItemSubtitle:ot["b"],VRow:Ut["a"],VSelect:re["a"],VSnackbar:le["a"],VSpacer:M["a"],VSwitch:ce["a"],VTab:de["a"],VTabItem:ue["a"],VTabs:ve["a"],VTextField:O["a"],VTimeline:he["a"],VTimelineItem:me["a"]});var ge=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",[t._v(" Exploits metadata "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.exploits.results,options:t.options,"server-items-length":t.exploits.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id","show-select":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.vp",fn:function(e){var n=e.item;return[a("span",[t._v(t._s(t.getVendorProduct(n.vp)))])]}},{key:"item.updated_at",fn:function(e){var n=e.item;return[a("span",[t._v(t._s(t.moment(n.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var n=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewVuln(n.vuln_id)}}})]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},_e=[],be=a("2ef0"),ke=a.n(be),xe={name:"exploits",data:function(){return{exploits:[],loading:!0,limit:20,only_monitored:!1,search:"",options:{},selected:[],headers:[{text:"Link",value:"link"},{text:"Products",value:"vp",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}},watch:{search:ke.a.debounce((function(t){this.search=t,this.options.page=1,this.getDataFromApi()}),500),only_monitored:{handler:function(){this.getDataFromApi()},deep:!0},options:{handler:function(){this.getDataFromApi()},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var n=t.options,i=n.sortBy,s=n.sortDesc,o=n.page,r=n.itemsPerPage;t.limit=r;var l=t.getExploits(o,t.limit,i,s);setTimeout((function(){e({items:l})}),300)}))},getExploits:function(t,e,a,n){var i=this,s="";a.length>0&&(s=!0===n[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/exploits?limit="+e+"&page="+t+"&search="+this.search+s).then((function(t){return i.loading=!1,i.exploits=t.data,i.exploits})).catch((function(t){i.exploits=[],j.a.fire({title:"Error",text:"unable to get exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},viewVuln:function(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t}})},getVendorProduct:function(t){if(null==t)return"";var e,a,n=Array(),i=!0,s=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(i=(r=l.next()).done);i=!0)e=r.value,a=e.split(":")[4].replace(/_/g," ")+" ("+e.split(":")[3].replace(/_/g," ")+")",n.push(a)}catch(c){s=!0,o=c}finally{try{i||null==l.return||l.return()}finally{if(s)throw o}}return n=Object(Lt["a"])(new Set(n)),n.join(", ")}}},ye=xe,we=Object(l["a"])(ye,ge,_e,!1,null,null,null),Ce=we.exports;d()(we,{VBtn:I["a"],VCard:P["a"],VCardTitle:D["d"],VDataTable:Xt["a"],VIcon:et["a"],VSnackbar:le["a"],VSpacer:M["a"],VTextField:O["a"]});var Ve=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[!0===t.loading?a("div",{staticClass:"loading"},[t._v("Loading…")]):t._e(),a("v-card",[a("v-card-title",[t._v(" Vendors "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.vendors.results,options:t.options,"server-items-length":t.vendors.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"vendor","show-select":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.actions",fn:function(e){var n=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewProducts(n.vendor)}}})]}},{key:"item.monitored",fn:function(e){var n=e.item;return[n.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitored(n)}}},[t._v("Yes")]):t._e(),n.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitored(n)}}},[t._v("No")])]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},je=[],Te={name:"vendors",data:function(){return{vendors:[],totalvendors:0,loading:!0,limit:20,search:"",options:{},selected:[],headers:[{text:"Vendor",value:"vendor"},{text:"Actions",value:"actions"}],rowsPerPageItems:[5,10,20,50,100]}},mounted:function(){},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi().then((function(t){}))},deep:!0},options:{handler:function(){this.getDataFromApi().then((function(t){}))},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var n=t.options,i=n.sortBy,s=n.sortDesc,o=n.page,r=n.itemsPerPage;t.search.trim().toLowerCase();t.limit=r;var l=t.getvendors(o,t.limit,i,s);setTimeout((function(){t.loading=!1,e({items:l})}),300)}))},getvendors:function(t,e,a,n){var i=this;this.loading=!0;var s="";a.length>0&&(s=!0===n[0]?"sorted_by=-"+a:"sorted_by="+a),this.$api.get("/api/kb/vendors?limit="+e+"&page="+t+"&vendor__icontains="+this.search+"&"+s).then((function(t){return i.vendors=t.data,i.vendors})).catch((function(t){i.vendors=[],i.loading=!1,j.a.fire({title:"Error",text:"unable to get vendors",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},viewProducts:function(t){this.$router.push({name:"KBProductVersions",params:{vendor_name:t}})}}},Se=Te,Ie=Object(l["a"])(Se,Ve,je,!1,null,null,null),Pe=Ie.exports;d()(Ie,{VBtn:I["a"],VCard:P["a"],VCardTitle:D["d"],VChip:zt["a"],VDataTable:Xt["a"],VIcon:et["a"],VSnackbar:le["a"],VSpacer:M["a"],VTextField:O["a"]});var De=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Products ")]),a("v-col",{staticClass:"pa-2"},[this.only_monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.toggleProductMonitored}},[t._v("Show all")]):t._e(),this.only_monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.toggleProductMonitored}},[t._v("Show monitored only")])],1),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.products.results,options:t.options,"server-items-length":t.products.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"item","show-select":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.monitored",fn:function(e){var n=e.item;return[n.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitored(n)}}},[t._v("Yes")]):t._e(),n.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitored(n)}}},[t._v("No")])]}},{key:"item.updated_at",fn:function(e){var n=e.item;return[a("span",[t._v(t._s(t.moment(n.updated_at).format("YYYY-MM-DD")))])]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},Be=[],$e={name:"products",data:function(){return{products:[],loading:!0,limit:20,totalproducts:0,only_monitored:!1,search:"",options:{},selected:[],headers:[{text:"Vendor",value:"vendor"},{text:"Product",value:"product"},{text:"Monitored",value:"monitored",align:"center",sortable:!1},{text:"Last update",value:"updated_at"}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}},mounted:function(){},watch:{search:ke.a.debounce((function(t){this.search=t,this.options.page=1,this.getDataFromApi()}),500),only_monitored:{handler:function(){this.getDataFromApi()},deep:!0},options:{handler:function(){this.getDataFromApi()},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var n=t.options,i=n.sortBy,s=n.sortDesc,o=n.page,r=n.itemsPerPage;t.limit=r;var l=t.getProducts(o,t.limit,i,s);setTimeout((function(){e({items:l})}),300)}))},getProducts:function(t,e,a,n){var i=this,s="";a.length>0&&(s=!0===n[0]?"&sorted_by=-"+a:"&sorted_by="+a);var o=this.only_monitored?"&monitored=yes":"";this.$api.get("/api/kb/products/?limit="+e+"&page="+t+"&search="+this.search+s+o).then((function(t){return i.loading=!1,i.products=t.data,i.products})).catch((function(t){i.products=[],j.a.fire({title:"Error",text:"unable to get products",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},toggleMonitored:function(t){var e=this,a={vendor:t.vendor,product:t.product,monitored:!t.monitored};this.$api.post("/api/monitor/product/toggle",a).then((function(a){e.loading=!1,a?(t.monitored=!t.monitored,e.snack=!0,e.snackColor="success",e.snackText="Monitoring status successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the monitoring status")})).catch((function(t){e.loading=!1,j.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})}))},toggleProductMonitored:function(){this.only_monitored=!this.only_monitored}}},Ee=$e,Ae=Object(l["a"])(Ee,De,Be,!1,null,null,null),Le=Ae.exports;d()(Ae,{VBtn:I["a"],VCard:P["a"],VCardTitle:D["d"],VChip:zt["a"],VCol:Nt["a"],VContainer:B["a"],VDataTable:Xt["a"],VRow:Ut["a"],VSnackbar:le["a"],VSpacer:M["a"],VTextField:O["a"]});var Me=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[!0===t.loading?a("div",{staticClass:"loading"},[t._v("Loading…")]):t._e(),a("v-card",[a("v-card-title",[t._v(" Product Versions for "+t._s(this.vendor_name)+" "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.products.results,options:t.options,"server-items-length":t.products.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"product","show-select":""},on:{"update:options":function(e){t.options=e}}})],1)],1)},Oe=[],Ye={name:"products",data:function(){return{vendor_name:"",products:[],loading:!0,limit:20,totalproducts:0,search:"",options:{},selected:[],headers:[{text:"Product",value:"product"},{text:"Version",value:"title"},{text:"Vector",value:"vector"}],rowsPerPageItems:[5,10,20,50,100]}},mounted:function(){this.vendor_name=this.$router.currentRoute.params.vendor_name,this.getDataFromApi()},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi().then((function(t){}))},deep:!0},options:{handler:function(){this.getDataFromApi().then((function(t){}))},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var n=t.options,i=n.sortBy,s=n.sortDesc,o=n.page,r=n.itemsPerPage;t.search.trim().toLowerCase();t.limit=r;var l=t.getProducts(o,t.limit,i,s);setTimeout((function(){t.loading=!1,e({items:l})}),300)}))},getProducts:function(t,e,a,n){var i=this;this.loading=!0;var s="";a.length>0&&(s=!0===n[0]?"sorted_by=-"+a:"sorted_by="+a),this.$api.get("/api/kb/vendors/"+this.vendor_name+"/products?limit="+e+"&page="+t+"&product__icontains="+this.search+"&"+s).then((function(t){return i.products=t.data,i.products})).catch((function(t){i.products=[],i.loading=!1,j.a.fire({title:"Error",text:"unable to get products",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1}}},Fe=Ye,ze=Object(l["a"])(Fe,Me,Oe,!1,null,null,null),Ne=ze.exports;d()(ze,{VCard:P["a"],VCardTitle:D["d"],VDataTable:Xt["a"],VSpacer:M["a"],VTextField:O["a"]});var Ue=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",[t._v(" CVE "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.cves.results,"items-per-page":20,options:t.options,"server-items-length":t.cves.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"cve_id","show-select":"","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.summary",fn:function(e){var n=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1},scopedSlots:t._u([{key:"after",fn:function(e){var n=e.toggle,i=e.expanded,s=e.clamped;return i||s?a("button",{staticClass:"toggle btn btn-sm",on:{click:n}},[t._v(" "+t._s(" more")+" ")]):t._e()}}],null,!0)},[t._v(" "+t._s(n.summary)+" ")])]}},{key:"item.monitored",fn:function(e){var n=e.item;return[n.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitored(n)}}},[t._v("Yes")]):t._e(),n.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitored(n)}}},[t._v("No")])]}},{key:"item.modified",fn:function(e){var n=e.item;return[a("span",[t._v(t._s(t.moment(n.modified).format("YYYY-MM-DD")))])]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},Re=[],He={name:"cves",components:{VClamp:Mt["a"]},data:function(){return{cves:[],totalcves:0,loading:!0,limit:20,search:"",options:{},selected:[],headers:[{text:"CVE-ID",value:"cve_id",width:"150px"},{text:"Summary",value:"summary",sortable:!1},{text:"CVSS",value:"cvss",align:"center"},{text:"CVSS Vector",value:"cvss_vector",align:"center",sortable:!1},{text:"Monitored",value:"monitored",align:"center"},{text:"Modified",value:"modified",align:"center"}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}},mounted:function(){},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi().then((function(t){}))},deep:!0},options:{handler:function(){this.getDataFromApi().then((function(t){}))},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var n=t.options,i=n.sortBy,s=n.sortDesc,o=n.page,r=n.itemsPerPage;t.search.trim().toLowerCase();t.limit=r;var l=t.getcves(o,t.limit,i,s);setTimeout((function(){e({items:l})}),300)}))},getcves:function(t,e,a,n){var i=this,s="";a.length>0&&(s=!0===n[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/kb/cve?limit="+e+"&page="+t+s+"&search="+this.search).then((function(t){return i.cves=t.data,i.loading=!1,i.cves})).catch((function(t){i.cves=[],i.loading=!1,j.a.fire({title:"Error",text:"unable to get cves",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},toggleMonitored:function(t){var e=this,a={monitored:!t.monitored};this.$api.put("/api/kb/vendor/"+t.id+"/",a).then((function(a){a?(t.monitored=!t.monitored,e.snack=!0,e.snackColor="success",e.snackText="Monitoring status successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the monitoring status"),e.loading=!1})).catch((function(t){e.loading=!1,j.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))}}},Je=He,We=Object(l["a"])(Je,Ue,Re,!1,null,null,null),qe=We.exports;d()(We,{VBtn:I["a"],VCard:P["a"],VCardTitle:D["d"],VChip:zt["a"],VDataTable:Xt["a"],VSnackbar:le["a"],VSpacer:M["a"],VTextField:O["a"]});var Ke=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[!0===t.loading?a("div",{staticClass:"loading"},[t._v("Loading…")]):t._e(),a("v-card",[a("v-card-title",[t._v(" Bulletins "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.bulletins.results,options:t.options,"server-items-length":t.bulletins.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"publicid","show-select":"","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.title",fn:function(e){var n=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1},scopedSlots:t._u([{key:"after",fn:function(e){var n=e.toggle,i=e.expanded,s=e.clamped;return i||s?a("button",{staticClass:"toggle btn btn-sm",on:{click:n}},[t._v(" "+t._s(" more")+" ")]):t._e()}}],null,!0)},[t._v(" "+t._s(n.title)+" ")])]}},{key:"item.monitored",fn:function(e){var n=e.item;return[n.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitored(n)}}},[t._v("Yes")]):t._e(),n.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitored(n)}}},[t._v("No")])]}},{key:"item.published",fn:function(e){var n=e.item;return[a("span",[t._v(t._s(t.moment(n.published).format("YYYY-MM-DD")))])]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},Ge=[],Qe={name:"bulletins",components:{VClamp:Mt["a"]},data:function(){return{bulletins:[],totalbulletins:0,loading:!0,limit:20,search:"",options:{},selected:[],headers:[{text:"ID",value:"publicid",width:"150px"},{text:"Vendor",value:"vendor"},{text:"Title",value:"title"},{text:"Severity",value:"severity"},{text:"Monitored",value:"monitored",align:"center"},{text:"Published",value:"published"}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}},mounted:function(){},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi().then((function(t){}))},deep:!0},options:{handler:function(){this.getDataFromApi().then((function(t){}))},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var n=t.options,i=n.sortBy,s=n.sortDesc,o=n.page,r=n.itemsPerPage;t.search.trim().toLowerCase();t.limit=r;var l=t.getbulletins(o,t.limit,i,s);setTimeout((function(){t.loading=!1,e({items:l})}),300)}))},getbulletins:function(t,e,a,n){var i=this;this.loading=!0;var s="";a.length>0&&(s=!0===n[0]?"sorted_by=-"+a:"sorted_by="+a),this.$api.get("/api/kb/bulletin?limit="+e+"&page="+t+"&"+s+"&search="+this.search).then((function(t){return i.bulletins=t.data,i.bulletins})).catch((function(t){i.bulletins=[],i.loading=!1,j.a.fire({title:"Error",text:"unable to get bulletins",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},toggleMonitored:function(t){var e=this,a={monitored:!t.monitored};this.$api.put("/api/kb/bulletin/"+t.id+"/",a).then((function(a){a?(t.monitored=!t.monitored,e.snack=!0,e.snackColor="success",e.snackText="Monitoring status successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the monitoring status")})).catch((function(t){e.loading=!1,j.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))}}},Xe=Qe,Ze=Object(l["a"])(Xe,Ke,Ge,!1,null,null,null),ta=Ze.exports;d()(Ze,{VBtn:I["a"],VCard:P["a"],VCardTitle:D["d"],VChip:zt["a"],VDataTable:Xt["a"],VSnackbar:le["a"],VSpacer:M["a"],VTextField:O["a"]});var ea=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-container",{attrs:{fluid:"","fill-height":""}},[a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("div",{staticClass:"text-md-center"},[a("h1",[t._v("404")]),a("h2",{staticClass:"my-3 headline"},[t._v("Sorry, page not found")]),a("div",[a("v-btn",{attrs:{color:"primary"},on:{click:t.goBack}},[t._v("Take me back!")]),a("v-btn",{attrs:{color:"primary"},on:{click:t.goHome}},[t._v("Go Home")])],1)])])],1)],1)},aa=[],na={methods:{goBack:function(){this.$router.go(-1)},goHome:function(){this.$router.push({path:"/"})}}},ia=na,sa=(a("3d91"),Object(l["a"])(ia,ea,aa,!1,null,"7cd99d3d",null)),oa=sa.exports;d()(sa,{VApp:u["a"],VBtn:I["a"],VContainer:B["a"],VLayout:A["a"]}),n["a"].use(k["a"]);var ra=[{path:"/auth",name:"AuthLayout",component:F},{path:"/",component:ct,children:[{path:"homepage",name:"Homepage",component:pt},{path:"alerts",name:"Alerts",component:xt},{path:"ratings",name:"Ratings",component:Tt},{path:"settings",name:"Settings",component:$t},{path:"search",name:"Search",component:Ht},{path:"search/:appsearch",name:"SearchData",component:Ht,props:!0},{path:"/kb/products",name:"KBProducts",component:Le},{path:"/kb/vendors",name:"KBVendors",component:Pe},{path:"/kb/vendors/:vendor_name",name:"KBProductVersions",component:Ne},{path:"/kb/cves",name:"KBCVE",component:qe},{path:"/kb/bulletins",name:"KBBulletins",component:ta},{path:"/vulns",name:"Vulns",component:te},{path:"/vulns/:vuln_id",name:"VulnDetails",component:fe},{path:"/exploits",name:"Exploits",component:Ce}]},{path:"*",component:oa}],la=new k["a"]({mode:"history",base:"/",routes:ra});la.beforeEach((function(t,e,a){null!==localStorage.getItem("authToken")||"/auth"===t.path?a():a("/auth")}));var ca=la,da=a("2f62"),ua=a("a7fe"),va=a.n(ua),ha=a("04e1"),ma=a.n(ha);n["a"].use(da["a"]),n["a"].use(va.a,C.a);var pa=new da["a"].Store({state:{authUser:{},isAuthenticated:!1,jwt_auth_token:localStorage.getItem("authToken"),jwt_refresh_token:localStorage.getItem("refreshToken"),endpoints:{obtainJWT:"/auth-jwt/obtain_jwt_token/",refreshJWT:"/auth-jwt/refresh_jwt_token/"}},getters:{isLoggedIn:function(t){return null!=t.jwt_auth_token}},mutations:{setAuthUser:function(t,e){var a=e.authUser,i=e.isAuthenticated;n["a"].set(t,"authUser",a),n["a"].set(t,"isAuthenticated",i)},updateToken:function(t,e){localStorage.setItem("authToken",e),t.jwt_auth_token=e},removeToken:function(t){localStorage.removeItem("authToken"),t.jwt_auth_token=null}},actions:{obtainToken:function(t,e){var a=this,n={username:t,password:e};this.$api.post(this.state.endpoints.obtainJWT,n).then((function(t){a.commit("updateToken",t.data.access)})).catch((function(t){console.log(t)}))},refreshToken:function(){var t=this,e={token:this.state.jwt_refresh_token};this.$api.post(this.state.endpoints.refreshJWT,e).then((function(e){t.commit("updateToken",e.data.access)})).catch((function(t){console.log(t)}))},inspectToken:function(){var t=this.state.jwt_auth_token;if(t){var e=ma()(t),a=e.exp,n=decode.orig_iat;a-Date.now()/1e3<1800&&Date.now()/1e3-n<628200?this.dispatch("refreshToken"):Date.now()}}},modules:{}});n["a"].filter("capitalize",(function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()+t.slice(1)):""})),n["a"].filter("truncate",(function(t,e,a){a=a||"...";var n=document.createElement("div");n.innerHTML=t;var i=n.textContent;return i.length>e?i.slice(0,e)+a:i})),C.a.interceptors.response.use((function(t){return t}),(function(t){t.response})),C.a.interceptors.request.use((function(t){return pa.state.jwt_auth_token&&(t.headers.Authorization="JWT "+pa.state.jwt_auth_token),t}),(function(t){return Promise.reject(t)})),n["a"].prototype.$api=C.a,n["a"].prototype.moment=Kt.a,n["a"].config.productionTip=!1,new n["a"]({vuetify:b,router:ca,VueSession:p.a,store:pa,render:function(t){return t(h)}}).$mount("#app"),n["a"].filter("capitalize",(function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()+t.slice(1)):""})),n["a"].use(g.a)},"7e07":function(t,e,a){},8083:function(t,e,a){"use strict";var n=a("4cea"),i=a.n(n);i.a},b051:function(t,e,a){}});
//# sourceMappingURL=app.0a73a7d8.js.map