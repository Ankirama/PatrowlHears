(function(t){function e(e){for(var i,o,r=e[0],l=e[1],c=e[2],d=0,v=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&v.push(s[o][0]),s[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);u&&u(e);while(v.length)v.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],i=!0,r=1;r<a.length;r++){var l=a[r];0!==s[l]&&(i=!1)}i&&(n.splice(e--,1),t=o(o.s=a[0]))}return t}var i={},s={app:0},n=[];function o(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=i,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(a,i,function(e){return t[e]}.bind(null,i));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=l;n.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},3437:function(t,e,a){"use strict";var i=a("f07e"),s=a.n(i);s.a},"3d91":function(t,e,a){"use strict";var i=a("b051"),s=a.n(i);s.a},"3f07":function(t,e,a){"use strict";var i=a("7e07"),s=a.n(i);s.a},4678:function(t,e,a){var i={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(t){var e=n(t);return a(e)}function n(t){if(!a.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}s.keys=function(){return Object.keys(i)},s.resolve=n,t.exports=s,s.id="4678"},"4cea":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("4de4"),a("fb6a"),a("d3b7"),a("25f0"),a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("router-view")],1)},n=[],o={name:"App",data:function(){return{section:"AppLayout"}},created:function(){document.title="PatrowlHears"},methods:{logout:function(){this.$store.commit("removeToken"),this.$router.push("/auth")}}},r=o,l=a("2877"),c=a("6544"),u=a.n(c),d=a("7496"),v=Object(l["a"])(r,s,n,!1,null,null,null),m=v.exports;u()(v,{VApp:d["a"]});var p=a("0628"),h=a.n(p),f=a("df76"),_=a.n(f),g=a("f309");i["a"].use(g["a"]);var b=new g["a"]({}),y=a("8c4f"),x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:"","align-center":"","justify-center":"","fill-height":""}},[a("v-flex",{attrs:{xs12:"",sm8:"",lg4:"",md5:""}},[a("v-card",{staticClass:"login-card"},[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Login to PatrowlHears")])]),a("v-spacer"),a("v-card-text",[t.loading?a("v-layout",{attrs:{row:"","fill-height":"","justify-center":"","align-center":""}},[a("v-progress-circular",{attrs:{size:50,color:"primary",indeterminate:""}})],1):a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-container",[a("v-text-field",{attrs:{counter:70,label:"username",maxlength:"70",required:""},model:{value:t.credentials.username,callback:function(e){t.$set(t.credentials,"username",e)},expression:"credentials.username"}}),a("v-text-field",{attrs:{type:"password",counter:20,label:"password",rules:t.rules.password,maxlength:"20",required:""},model:{value:t.credentials.password,callback:function(e){t.$set(t.credentials,"password",e)},expression:"credentials.password"}})],1),a("v-btn",{staticClass:"pink white--text",attrs:{disabled:!t.valid},on:{click:t.login}},[t._v("Login")])],1)],1)],1)],1)],1)],1)},k=[],C=a("bc3a"),w=a.n(C),V=a("3d20"),j=a.n(V),T={name:"AuthLayout",data:function(){return{credentials:{},valid:!0,loading:!1,rules:{username:[function(t){return!!t||"Username is required"},function(t){return t&&t.length>3||"A username must be more than 3 characters long"},function(t){return/^[a-z0-9_]+$/.test(t)||"A username can only contain letters and digits"}],password:[function(t){return!!t||"Password is required"},function(t){return t&&t.length>7||"The password must be longer than 7 characters"}]}}},methods:{login:function(){var t=this;this.$refs.form.validate()&&(this.loading=!0,this.$store.commit("removeToken"),this.$api.post(this.$store.state.endpoints.obtainJWT,this.credentials).then((function(e){t.$store.commit("updateToken",e.data.access),t.$api.get("/users/api/current").then((function(e){t.$store.commit("setAuthUser",{authUser:e.data,isAuthenticated:!0}),t.$router.push({name:"Vulns"})}))})).catch((function(e){t.$store.commit("removeToken"),t.loading=!1,j.a.fire({title:"Error",text:"Wrong username or password",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})))}}},S=T,I=a("8336"),E=a("b0af"),A=a("99d9"),P=a("a523"),L=a("0e8f"),$=a("4bd4"),D=a("a722"),M=a("490a"),B=a("2fa4"),O=a("8654"),F=Object(l["a"])(S,x,k,!1,null,null,null),Y=F.exports;u()(F,{VBtn:I["a"],VCard:E["a"],VCardText:A["c"],VCardTitle:A["d"],VContainer:P["a"],VFlex:L["a"],VForm:$["a"],VLayout:D["a"],VProgressCircular:M["a"],VSpacer:B["a"],VTextField:O["a"]});var N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:"","align-center":"","justify-center":"","fill-height":""}},[a("v-flex",{attrs:{xs12:"",sm8:"",lg4:"",md5:""}},[a("v-card",{staticClass:"login-card"},[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Login to PatrowlHears")])]),a("v-spacer"),a("v-card-text",[t.loading?a("v-layout",{attrs:{row:"","fill-height":"","justify-center":"","align-center":""}},[a("v-progress-circular",{attrs:{size:50,color:"primary",indeterminate:""}})],1):a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-container",[a("v-text-field",{attrs:{counter:70,label:"username",maxlength:"70",required:""},model:{value:t.credentials.username,callback:function(e){t.$set(t.credentials,"username",e)},expression:"credentials.username"}}),a("v-text-field",{attrs:{type:"password",counter:20,label:"password",rules:t.rules.password,maxlength:"20",required:""},model:{value:t.credentials.password,callback:function(e){t.$set(t.credentials,"password",e)},expression:"credentials.password"}})],1),a("v-btn",{staticClass:"pink white--text",attrs:{disabled:!t.valid},on:{click:t.login}},[t._v("Login")])],1)],1)],1)],1)],1)],1)},R=[],U={name:"UserAuth",data:function(){return{credentials:{},valid:!0,loading:!1,rules:{username:[function(t){return!!t||"Username is required"},function(t){return t&&t.length>3||"A username must be more than 3 characters long"},function(t){return/^[a-z0-9_]+$/.test(t)||"A username can only contain letters and digits"}],password:[function(t){return!!t||"Password is required"},function(t){return t&&t.length>7||"The password must be longer than 7 characters"}]}}},methods:{login:function(){var t=this;this.$refs.form.validate()&&(this.loading=!0,w.a.post("http://localhost:8000/auth-jwt/obtain_jwt_token/",this.credentials).then((function(e){t.$session.start(),t.$session.set("token",e.data.token),localStorage.setItem("authToken",e.data.token),localStorage.setItem("username",t.credentials.username),fa.push("/")})).catch((function(e){console.log(e),t.loading=!1,j.a.fire({title:"Error",text:"Wrong username or password",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})))}}},z=U,X=Object(l["a"])(z,N,R,!1,null,null,null);X.exports;u()(X,{VBtn:I["a"],VCard:E["a"],VCardText:A["c"],VCardTitle:A["d"],VContainer:P["a"],VFlex:L["a"],VForm:$["a"],VLayout:D["a"],VProgressCircular:M["a"],VSpacer:B["a"],VTextField:O["a"]});var H=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-navigation-drawer",{attrs:{clipped:"",app:"",color:"grey lighten-4"},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("v-list",{staticClass:"grey lighten-4",attrs:{dense:""}},[t._l(t.menu_items,(function(e,i){return[e.submenu?a("v-list-group",{attrs:{"no-action":"","prepend-icon":e.icon},scopedSlots:t._u([{key:"activator",fn:function(){return[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.text)}})],1)]},proxy:!0}],null,!0)},t._l(e.submenu,(function(e,i){return a("v-list-item",{key:i,attrs:{to:e.to}},[a("v-list-item-content",[a("v-list-item-title",{attrs:{link:"",to:e.to},domProps:{textContent:t._s(e.text)}})],1)],1)})),1):e.divider?a("v-divider",{key:i}):a("v-list-item",{key:i,attrs:{link:"",to:e.to}},[a("v-list-item-action",[a("v-icon",[t._v(t._s(e.icon))])],1),a("v-list-item-content",[a("v-list-item-title",{staticClass:"grey-darken-3--text"},[t._v(" "+t._s(e.text)+" ")])],1)],1)]}))],2)],1),a("v-app-bar",{attrs:{app:"","clipped-left":"",color:"grey lighten-2",dense:""}},[a("v-app-bar-nav-icon",{on:{click:function(e){t.drawer=!t.drawer}}}),a("span",{staticClass:"title ml-3 mr-5 deep-orange--text"},[t._v("Patrowl "),a("span",{staticClass:"font-weight-light deep"},[t._v("Hears")])]),a("v-text-field",{attrs:{"solo-inverted":"",flat:"","hide-details":"",label:"Search","prepend-inner-icon":"mdi-magnify",dense:""},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search()}},model:{value:t.appsearch,callback:function(e){t.appsearch=e},expression:"appsearch"}}),a("v-spacer"),a("v-btn",{attrs:{icon:""}},[a("v-icon",[t._v("mdi-bell")])],1),t._v(" "+t._s(t.username)+" "),a("v-btn",{attrs:{icon:""},on:{click:t.logout}},[a("v-icon",[t._v("mdi-logout")])],1)],1),a("v-content",[a("v-container",{attrs:{fluid:""}},[a("router-view")],1)],1),a("v-footer",[a("v-spacer"),a("div",{staticClass:"caption"},[t._v("© "+t._s((new Date).getFullYear())+" - Patrowl Hears")])],1)],1)},W=[],q={name:"AppLayout",data:function(){return{drawer:null,appsearch:"",menu_items:[{icon:"mdi-home",text:"Home",to:"/homepage"},{divider:!0},{icon:"mdi-bookmark",text:"KB",to:"",submenu:[{icon:"mdi-bookmark",text:"Vendors & Products",to:"/kb/products"},{icon:"mdi-bookmark",text:"CVE",to:"/kb/cves"},{icon:"mdi-bookmark",text:"Bulletins",to:"/kb/bulletins"}]},{icon:"mdi-file-find",text:"Vulnerabilities",to:"/vulns"},{icon:"mdi-knife-military",text:"Exploits",to:"/exploits"},{icon:"mdi-security",text:"Ratings",to:"/ratings"},{divider:!0},{icon:"mdi-settings",text:"Settings",to:"/settings"},{icon:"mdi-help-circle",text:"Help"}],username:""}},computed:{isAuthenticated:function(){return this.$store.getters.isAuthenticated}},mounted:function(){this.getUsername()},methods:{logout:function(){localStorage.removeItem("authToken"),localStorage.removeItem("username"),this.$router.push("/auth")},getUsername:function(){this.username=this.$store.state.authUser.username},search:function(){this.$route.path==="/search/"+this.appsearch?this.$router.go():this.$router.push({path:"/search/"+this.appsearch})}}},J=q,K=a("40dc"),G=a("5bc1"),Z=a("a75b"),Q=a("ce7e"),tt=a("553a"),et=a("132d"),at=a("8860"),it=a("56b0"),st=a("da13"),nt=a("1800"),ot=a("5d23"),rt=a("f774"),lt=Object(l["a"])(J,H,W,!1,null,null,null),ct=lt.exports;u()(lt,{VApp:d["a"],VAppBar:K["a"],VAppBarNavIcon:G["a"],VBtn:I["a"],VContainer:P["a"],VContent:Z["a"],VDivider:Q["a"],VFooter:tt["a"],VIcon:et["a"],VList:at["a"],VListGroup:it["a"],VListItem:st["a"],VListItemAction:nt["a"],VListItemContent:ot["a"],VListItemTitle:ot["c"],VNavigationDrawer:rt["a"],VSpacer:B["a"],VTextField:O["a"]});var ut=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md4:""}},[a("v-card",{attrs:{color:"deep-orange"}},[a("v-card-title",[t._v("Vulnerabilities")]),a("v-card-subtitle",{attrs:{primary:""}},[t._v("CVE, 0days, ...")]),a("v-card-text",{staticClass:"display-3 text-center"},[t._v(" "+t._s(t.stats.vulns)+" ")])],1)],1),a("v-flex",{attrs:{md4:""}},[a("v-card",{attrs:{color:"lime"}},[a("v-card-title",{attrs:{primary:""}},[t._v("Metadata")]),a("v-card-subtitle",{attrs:{primary:""}},[t._v("Exploits & Threats activities")]),a("v-card-text",{staticClass:"display-3 text-center"},[t._v(" "+t._s(t.stats.exploits+t.stats.threats)+" ")])],1)],1),a("v-flex",{attrs:{md4:""}},[a("v-card",{attrs:{color:"teal"}},[a("v-card-title",{attrs:{primary:""}},[t._v("Monitored")]),a("v-card-subtitle",{attrs:{primary:""}},[t._v("Vendor / Products")]),a("v-card-text",{staticClass:"display-3 text-center"},[t._v(" "+t._s(t.stats.monitored)+" ")])],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[a("v-card",{attrs:{outlined:""}},[a("v-card-title",[t._v("Latest Monitored Vulnerabilities")]),a("v-card-text",{staticClass:"text-center"},[a("v-data-table",{attrs:{headers:t.monitored_vulns_headers,items:t.monitored_vulns,"items-per-page":5},on:{"click:row":t.viewVuln},scopedSlots:t._u([{key:"item.summary",fn:function(e){var i=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1}},[t._v(" "+t._s(i.summary)+" ")])]}},{key:"item.score",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"text-center",attrs:{color:t.getRatingColor(i.score),small:""}},[t._v(" "+t._s(i.score)+" ")])]}},{key:"item.is_confirmed",fn:function(e){var i=e.item;return[1==i.is_confirmed?a("v-icon",{staticClass:"mdi mdi-check",attrs:{small:"",color:"gray"}}):t._e()]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD, hh:mm:ss")))])]}}])})],1)],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md6:""}},[a("v-card",{attrs:{outlined:""}},[a("v-card-title",[t._v("Latest Vulnerabilities")]),a("v-card-text",{staticClass:"text-center"},[a("v-data-table",{attrs:{headers:t.vulns_headers,items:t.vulns,"items-per-page":5},on:{"click:row":t.viewVuln},scopedSlots:t._u([{key:"item.summary",fn:function(e){var i=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1}},[t._v(" "+t._s(i.summary)+" ")])]}}])})],1)],1)],1),a("v-flex",{attrs:{md6:""}},[a("v-card",{attrs:{outlined:""}},[a("v-card-title",{attrs:{primary:""}},[t._v("Latest exploits")]),a("v-card-text",{staticClass:"text-center"},[a("v-data-table",{attrs:{headers:t.exploits_headers,items:t.exploits,"items-per-page":5},scopedSlots:t._u([{key:"item.link",fn:function(e){var i=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1}},[t._v(" "+t._s(i.link)+" ")])]}}])})],1)],1)],1)],1)],1)},dt=[],vt=a("3f87"),mt={methods:{getCVSSColor:function(t){return t>=9?"red darken-4":t>=7?"red":t>=4?"orange":t>=.1?"yellow":"grey"},getTLPColor:function(t){return"white"===t?"":"green"===t?"green":"amber"===t?"orange":"red"===t?"red":"black"===t?"black":"grey"},getRatingColor:function(t){return t>=80?"red":t>=60?"orange":t>=40?"yellow":t>=0?"blue":"grey"},getBoolColor:function(t){return t?"deep-orange":"grey"}},mounted:function(){},destroyed:function(){}},pt=a("c1df"),ht=a.n(pt),ft={name:"Home",mixins:[mt],components:{VClamp:vt["a"]},data:function(){return{stats:{vulns:"n/a",exploits:"n/a",threats:"n/a",monitored:"n/a"},vulns:[],vulns_headers:[{text:"PHID",value:"id",fixed:!0},{text:"CVE",value:"cve",fixed:!0},{text:"Summary",value:"summary"}],monitored_vulns:[],monitored_vulns_headers:[{text:"PHID",value:"id",fixed:!0},{text:"CVE",value:"cve",fixed:!0},{text:"Summary",value:"summary"},{text:"Score",value:"score"},{text:"Exploits",value:"exploit_count",align:"center"},{text:"Confirm ?",value:"is_confirmed",align:"center"},{text:"Last update",value:"updated_at",align:"center"}],exploits:[],exploits_headers:[{text:"Source",value:"source",fixed:!0},{text:"Link",value:"link",fixed:!0},{text:"Trust",value:"trust_level",fixed:!0}]}},mounted:function(){this.getStats(),this.getLastVulns()},methods:{getStats:function(){var t=this;this.$api.get("/api/vulns/stats").then((function(e){e&&200===e.status&&(t.stats=e.data)})).catch((function(t){j.a.fire({title:"Error",text:"Unable to get stats",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},getLastVulns:function(){var t=this;this.$api.get("/api/vulns/latest?timedelta=30").then((function(e){e&&200===e.status&&(t.vulns=e.data.vulns,t.exploits=e.data.exploits,t.monitored_vulns=e.data.monitored_vulns)})).catch((function(t){j.a.fire({title:"Error",text:"Unable to get vulnerabilities and exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},viewVuln:function(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t.id}})}}},_t=ft,gt=(a("3437"),a("cc20")),bt=a("8fea"),yt=Object(l["a"])(_t,ut,dt,!1,null,null,null),xt=yt.exports;u()(yt,{VCard:E["a"],VCardSubtitle:A["b"],VCardText:A["c"],VCardTitle:A["d"],VChip:gt["a"],VContainer:P["a"],VDataTable:bt["a"],VFlex:L["a"],VIcon:et["a"],VLayout:D["a"]});var kt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v(" Alert Page - TODO ")])},Ct=[],wt={name:"Alerts",mounted:function(){},methods:{}},Vt=wt,jt=Object(l["a"])(Vt,kt,Ct,!1,null,null,null),Tt=jt.exports,St=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md8:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-1",raised:""}},[a("v-card-title",[t._v("Vector")]),a("v-card-text",[t._v(t._s(t.rating_vector))])],1)],1),a("v-flex",{attrs:{md3:"","align-stretch":""}},[a("v-card",{attrs:{color:t.getRatingColor(parseInt(t.score)),raised:""}},[a("v-card-title",[t._v("Global Score")]),a("v-card-text",{staticClass:"display-2 text-center"},[t._v(t._s(parseInt(t.score)))])],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md8:""}},[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Vulnerability metrics")]),a("v-card-text",[a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Access - Attack Vector ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.access.vector,callback:function(e){t.$set(t.vulnerability.access,"vector",e)},expression:"vulnerability.access.vector"}},[a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Local (AV:L)")]),a("v-btn",{attrs:{small:"",value:"A"}},[t._v("Adjacent Network (AV:A)")]),a("v-btn",{attrs:{small:"",value:"N"}},[t._v("Network (AV:N)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Access - Attack Complexity ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.access.complexity,callback:function(e){t.$set(t.vulnerability.access,"complexity",e)},expression:"vulnerability.access.complexity"}},[a("v-btn",{attrs:{small:"",value:"H"}},[t._v("High (AC:H)")]),a("v-btn",{attrs:{small:"",value:"M"}},[t._v("Medium (AC:M)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (AC:L)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Access - Authentication ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.access.authentication,callback:function(e){t.$set(t.vulnerability.access,"authentication",e)},expression:"vulnerability.access.authentication"}},[a("v-btn",{attrs:{small:"",value:"M"}},[t._v("Multiple (Au:M)")]),a("v-btn",{attrs:{small:"",value:"S"}},[t._v("Single (Au:S)")]),a("v-btn",{attrs:{small:"",value:"N"}},[t._v("None (Au:N)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Impact - Confidentiality ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.impact.confidentiality,callback:function(e){t.$set(t.vulnerability.impact,"confidentiality",e)},expression:"vulnerability.impact.confidentiality"}},[a("v-btn",{attrs:{small:"",value:"N"}},[t._v("None (C:N)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (C:L)")]),a("v-btn",{attrs:{small:"",value:"C"}},[t._v("Complete (C:C)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Impact - Integrity ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.impact.integrity,callback:function(e){t.$set(t.vulnerability.impact,"integrity",e)},expression:"vulnerability.impact.integrity"}},[a("v-btn",{attrs:{small:"",value:"N"}},[t._v("None (I:N)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (I:L)")]),a("v-btn",{attrs:{small:"",value:"C"}},[t._v("Complete (I:C)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Impact - Availability ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.impact.availability,callback:function(e){t.$set(t.vulnerability.impact,"availability",e)},expression:"vulnerability.impact.availability"}},[a("v-btn",{attrs:{small:"",value:"N"}},[t._v("None (A:N)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (A:L)")]),a("v-btn",{attrs:{small:"",value:"C"}},[t._v("Complete (A:C)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Remediation ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.remediation,callback:function(e){t.$set(t.vulnerability,"remediation",e)},expression:"vulnerability.remediation"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (R:X)")]),a("v-btn",{attrs:{small:"",value:"U"}},[t._v("Unavailable (R:H)")]),a("v-btn",{attrs:{small:"",value:"W"}},[t._v("Workaround (R:W)")]),a("v-btn",{attrs:{small:"",value:"T"}},[t._v("Temporary (R:T)")]),a("v-btn",{attrs:{small:"",value:"O"}},[t._v("Official (R:O)")])],1)],1),a("v-row",[a("v-col",{staticClass:"py-2 pa-6",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Vulnerability Age ")]),a("v-menu",{ref:"menu_vage",attrs:{"close-on-content-click":!1,"return-value":t.vulnerability.age,transition:"scale-transition","offset-y":"","min-width":"290px"},on:{"update:returnValue":function(e){return t.$set(t.vulnerability,"age",e)},"update:return-value":function(e){return t.$set(t.vulnerability,"age",e)}},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-text-field",t._g({model:{value:t.vulnerability.age,callback:function(e){t.$set(t.vulnerability,"age",e)},expression:"vulnerability.age"}},i))]}}]),model:{value:t.menu_vage,callback:function(e){t.menu_vage=e},expression:"menu_vage"}},[a("v-date-picker",{attrs:{scrollable:"",landscape:""},model:{value:t.vulnerability.age,callback:function(e){t.$set(t.vulnerability,"age",e)},expression:"vulnerability.age"}},[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){t.menu_vage=!1}}},[t._v("Cancel")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.$refs.menu_vage.save("")}}},[t._v("Reset")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.$refs.menu_vage.save(t.vulnerability.age)}}},[t._v("OK")])],1)],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"8"}},[a("span",{staticClass:"subtitle-1"},[t._v("Confirmation ")]),a("v-row",[a("v-col",{staticClass:"py-2",attrs:{cols:"12"}},[a("v-switch",{attrs:{label:"Confirmed by trusted parties: "+t.vulnerability.confirmation.toString(),color:"deep-orange"},model:{value:t.vulnerability.confirmation,callback:function(e){t.$set(t.vulnerability,"confirmation",e)},expression:"vulnerability.confirmation"}})],1)],1)],1)],1)],1)],1)],1),a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1 flex-shrink-0",attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Vulnerability Score")]),a("v-card-text",{staticClass:"text-center"},[a("v-progress-circular",{attrs:{value:20*t.vuln_score,size:100,width:5,color:"deep-orange"}},[t._v(t._s(parseInt(20*t.vuln_score))+" ("+t._s(t.vuln_score)+") ")])],1)],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md8:""}},[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Threat metrics")]),a("v-card-text",[a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Exploit Availability ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.threat.exploit_availability,callback:function(e){t.$set(t.threat,"exploit_availability",e)},expression:"threat.exploit_availability"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (EA:X)")]),a("v-btn",{attrs:{small:"",value:"R"}},[t._v("Private (EA:R)")]),a("v-btn",{attrs:{small:"",value:"U"}},[t._v("Public (EA:U)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Exploit Maturity ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.threat.exploit_maturity,callback:function(e){t.$set(t.threat,"exploit_maturity",e)},expression:"threat.exploit_maturity"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (EM:X)")]),a("v-btn",{attrs:{small:"",value:"U"}},[t._v("Unproven (EM:U)")]),a("v-btn",{attrs:{small:"",value:"P"}},[t._v("PoC (EM:P)")]),a("v-btn",{attrs:{small:"",value:"F"}},[t._v("Functional (EM:F)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Exploit Confidence ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.threat.exploit_trust,callback:function(e){t.$set(t.threat,"exploit_trust",e)},expression:"threat.exploit_trust"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (ET:X)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (ET:L)")]),a("v-btn",{attrs:{small:"",value:"M"}},[t._v("Medium (ET:M)")]),a("v-btn",{attrs:{small:"",value:"H"}},[t._v("High (ET:H)")])],1)],1),a("v-row",[a("v-col",{staticClass:"py-2 pa-6",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Exploit Age ")]),a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"return-value":t.threat.exploit_age,transition:"scale-transition","offset-y":"","min-width":"290px"},on:{"update:returnValue":function(e){return t.$set(t.threat,"exploit_age",e)},"update:return-value":function(e){return t.$set(t.threat,"exploit_age",e)}},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-text-field",t._g({model:{value:t.threat.exploit_age,callback:function(e){t.$set(t.threat,"exploit_age",e)},expression:"threat.exploit_age"}},i))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[a("v-date-picker",{attrs:{scrollable:"",landscape:""},model:{value:t.threat.exploit_age,callback:function(e){t.$set(t.threat,"exploit_age",e)},expression:"threat.exploit_age"}},[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){t.menu}}},[t._v("Cancel")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.$refs.menu.save("")}}},[t._v("Reset")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.$refs.menu.save(t.threat.exploit_age)}}},[t._v("OK")])],1)],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"8"}},[a("span",{staticClass:"subtitle-1"},[t._v("Mediatisation ")]),a("v-row",[a("v-col",{staticClass:"py-2",attrs:{cols:"6"}},[a("v-switch",{attrs:{label:"In the News ? : "+t.threat.in_the_news.toString(),color:"deep-orange"},model:{value:t.threat.in_the_news,callback:function(e){t.$set(t.threat,"in_the_news",e)},expression:"threat.in_the_news"}})],1),a("v-col",{staticClass:"py-2",attrs:{cols:"6"}},[a("v-switch",{attrs:{label:"In the Wild ? : "+t.threat.in_the_wild.toString(),color:"deep-orange"},model:{value:t.threat.in_the_wild,callback:function(e){t.$set(t.threat,"in_the_wild",e)},expression:"threat.in_the_wild"}})],1)],1)],1)],1)],1)],1)],1),a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1 flex-shrink-0",attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Threat Score")]),a("v-card-text",{staticClass:"text-center"},[a("v-progress-circular",{attrs:{value:20*t.threat_score,size:100,width:5,color:"deep-orange"}},[t._v(t._s(parseInt(20*t.threat_score))+" ")])],1)],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md8:""}},[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Asset metrics")]),a("v-card-text",[a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Criticality ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.asset.criticality,callback:function(e){t.$set(t.asset,"criticality",e)},expression:"asset.criticality"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (Cr:X)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (Cr:L)")]),a("v-btn",{attrs:{small:"",value:"M"}},[t._v("Medium (Cr:M)")]),a("v-btn",{attrs:{small:"",value:"H"}},[t._v("High (Cr:H)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Exposure ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.asset.exposure,callback:function(e){t.$set(t.asset,"exposure",e)},expression:"asset.exposure"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (E:X)")]),a("v-btn",{attrs:{small:"",value:"R"}},[t._v("Restricted/DMZ (E:R)")]),a("v-btn",{attrs:{small:"",value:"I"}},[t._v("Internal (E:I)")]),a("v-btn",{attrs:{small:"",value:"E"}},[t._v("External (E:E)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Distribution ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.asset.distribution,callback:function(e){t.$set(t.asset,"distribution",e)},expression:"asset.distribution"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (D:X)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low <15 (D:L)")]),a("v-btn",{attrs:{small:"",value:"M"}},[t._v("Medium <45 (D:M)")]),a("v-btn",{attrs:{small:"",value:"H"}},[t._v("High ≥45 (D:H)")])],1)],1)],1)],1)],1),a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1 flex-shrink-0",attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Asset Score")]),a("v-card-text",{staticClass:"text-center"},[a("v-progress-circular",{attrs:{value:25*t.asset_score,size:100,width:5,color:"deep-orange"}},[t._v(t._s(parseInt(25*t.asset_score))+" ")])],1)],1)],1)],1)],1)},It=[],Et=(a("99af"),a("a15b"),a("b64b"),a("ac1f"),a("1276"),a("caad"),a("b680"),{methods:{calcVulnScore:function(t,e){if(void 0==e||0===Object.keys(e).length)return 0;for(var a=0,i={vector:0,complexity:0,authentication:0,confidentiality:0,integrity:0,availability:0},s="",n=[],o=0;o<t.length;o++)s=t[o].split(":"),"AV"===s[0]&&!["N","A","L"].includes(s[1])&&(i.vector+=e.cvss2.access.vector.default),"AV"===s[0]&&"N"===s[1]&&(i.vector+=e.cvss2.access.vector.network),"AV"===s[0]&&"A"===s[1]&&(i.vector+=e.cvss2.access.vector.adjacent),"AV"===s[0]&&"L"===s[1]&&(i.vector+=e.cvss2.access.vector.local),"AV"===s[0]&&n.push("AV"),"AC"===s[0]&&!["L","M","H"].includes(s[1])&&(i.complexity+=e.cvss2.access.complexity.default),"AC"===s[0]&&"L"===s[1]&&(i.complexity+=e.cvss2.access.complexity.low),"AC"===s[0]&&"M"===s[1]&&(i.complexity+=e.cvss2.access.complexity.medium),"AC"===s[0]&&"H"===s[1]&&(i.complexity+=e.cvss2.access.complexity.high),"AC"===s[0]&&n.push("AC"),"Au"===s[0]&&!["N","S","M"].includes(s[1])&&(i.authentication+=e.cvss2.access.authentication.default),"Au"===s[0]&&"N"===s[1]&&(i.authentication+=e.cvss2.access.authentication.none),"Au"===s[0]&&"S"===s[1]&&(i.authentication+=e.cvss2.access.authentication.single),"Au"===s[0]&&"M"===s[1]&&(i.authentication+=e.cvss2.access.authentication.multiple),"Au"===s[0]&&n.push("Au"),"C"===s[0]&&!["N","L","P","C","H"].includes(s[1])&&(i.confidentiality+=e.cvss2.impact.confidentiality.default),"C"===s[0]&&"N"===s[1]&&(i.confidentiality+=e.cvss2.impact.confidentiality.none),"C"===s[0]&&"L"===s[1]&&(i.confidentiality+=e.cvss2.impact.confidentiality.partial),"C"===s[0]&&"P"===s[1]&&(i.confidentiality+=e.cvss2.impact.confidentiality.partial),"C"===s[0]&&"C"===s[1]&&(i.confidentiality+=e.cvss2.impact.confidentiality.complete),"C"===s[0]&&"H"===s[1]&&(i.confidentiality+=e.cvss2.impact.confidentiality.complete),"C"===s[0]&&n.push("C"),"I"===s[0]&&!["N","L","P","C","H"].includes(s[1])&&(i.integrity+=e.cvss2.impact.integrity.default),"I"===s[0]&&"N"===s[1]&&(i.integrity+=e.cvss2.impact.integrity.none),"I"===s[0]&&"L"===s[1]&&(i.integrity+=e.cvss2.impact.integrity.partial),"I"===s[0]&&"P"===s[1]&&(i.integrity+=e.cvss2.impact.integrity.partial),"I"===s[0]&&"C"===s[1]&&(i.integrity+=e.cvss2.impact.integrity.complete),"I"===s[0]&&"H"===s[1]&&(i.integrity+=e.cvss2.impact.integrity.complete),"I"===s[0]&&n.push("I"),"A"===s[0]&&!["N","L","P","C","H"].includes(s[1])&&(i.availability+=e.cvss2.impact.availability.default),"A"===s[0]&&"N"===s[1]&&(i.availability+=e.cvss2.impact.availability.none),"A"===s[0]&&"L"===s[1]&&(i.availability+=e.cvss2.impact.availability.partial),"A"===s[0]&&"P"===s[1]&&(i.availability+=e.cvss2.impact.availability.partial),"A"===s[0]&&"C"===s[1]&&(i.availability+=e.cvss2.impact.availability.complete),"A"===s[0]&&"H"===s[1]&&(i.availability+=e.cvss2.impact.availability.complete),"A"===s[0]&&n.push("A"),"R"===s[0]&&!["U","W","T","O"].includes(s[1])&&(a+=e.remediation.default),"R"===s[0]&&"U"===s[1]&&(a+=e.remediation.unavailable),"R"===s[0]&&"W"===s[1]&&(a+=e.remediation.workaround),"R"===s[0]&&"T"===s[1]&&(a+=e.remediation.temporary),"R"===s[0]&&"O"===s[1]&&(a+=e.remediation.official),"R"===s[0]&&n.push("R"),"VX"===s[0]&&s[1]<=15&&(a+=e.age.caps["15"]),"VX"===s[0]&&s[1]>15&&s[1]<=45&&(a+=e.age.caps["45"]),"VX"===s[0]&&s[1]>45&&(a+=e.age.caps["10000000"]),"VX"===s[0]&&n.push("VX"),"CL"===s[0]&&"Y"===s[1]&&(a+=e.confirmation.is_confirmed),n.push("CL");!n.includes("AV")&&(i.vector=e.cvss2.access.vector.default),!n.includes("AC")&&(i.complexity=e.cvss2.access.complexity.default),!n.includes("Au")&&(i.authentication=e.cvss2.access.authentication.default),!n.includes("C")&&(i.confidentiality=e.cvss2.impact.confidentiality.default),!n.includes("I")&&(i.integrity=e.cvss2.impact.integrity.default),!n.includes("A")&&(i.availability=e.cvss2.impact.availability.default),!n.includes("VX")&&(a+=e.age.default),!n.includes("R")&&(a+=e.remediation.default);var r=10.41*(1-(1-i.confidentiality)*(1-i.integrity)*(1-i.availability)),l=20*i.complexity*i.vector*i.authentication,c=0;c=0==r?0:1.176;var u=(.6*r+.4*l-1.5)*c;return a+=70*parseFloat(u).toFixed(1)/100/2,a>e.max_score&&(a=e.max_score),parseFloat(a).toFixed(1)},calcThreatScore:function(t,e){if(void 0==e||0===Object.keys(e).length)return 0;for(var a=0,i="",s=[],n=0;n<t.length;n++)i=t[n].split(":"),"EA"===i[0]&&!["X","R","U"].includes(i[1])&&(a+=e.exploit_availability.default),"EA"===i[0]&&"X"===i[1]&&(a+=e.exploit_availability.unknown),"EA"===i[0]&&"R"===i[1]&&(a+=e.exploit_availability.private),"EA"===i[0]&&"U"===i[1]&&(a+=e.exploit_availability.public),"EA"===i[0]&&s.push("EA"),"EM"===i[0]&&!["X","U","P","F"].includes(i[1])&&(a+=e.exploit_maturity.default),"EM"===i[0]&&"X"===i[1]&&(a+=e.exploit_maturity.unknown),"EM"===i[0]&&"U"===i[1]&&(a+=e.exploit_maturity.unproven),"EM"===i[0]&&"P"===i[1]&&(a+=e.exploit_maturity.poc),"EM"===i[0]&&"F"===i[1]&&(a+=e.exploit_maturity.functional),"EM"===i[0]&&s.push("EM"),"ET"===i[0]&&!["X","L","M","H"].includes(i[1])&&(a+=e.exploit_trust.default),"ET"===i[0]&&"X"===i[1]&&(a+=e.exploit_trust.unknown),"ET"===i[0]&&"L"===i[1]&&(a+=e.exploit_trust.low),"ET"===i[0]&&"M"===i[1]&&(a+=e.exploit_trust.medium),"ET"===i[0]&&"H"===i[1]&&(a+=e.exploit_trust.high),"ET"===i[0]&&s.push("ET"),"EX"===i[0]&&i[1]<=15&&(a+=e.exploit_age.caps["15"]),"EX"===i[0]&&i[1]>15&&i[1]<=45&&(a+=e.exploit_age.caps["45"]),"EX"===i[0]&&i[1]>45&&(a+=e.exploit_age.caps["10000000"]),"N"===i[0]&&"Y"===i[1]&&(a+=e.threat_intensity.is_in_the_news),"W"===i[0]&&"Y"===i[1]&&(a+=e.threat_intensity.is_in_the_wild);return!s.includes("EA")&&(a+=e.exploit_availability.default),!s.includes("EM")&&(a+=e.exploit_maturity.default),!s.includes("ET")&&(a+=e.exploit_trust.default),!s.includes("EX")&&(a+=e.exploit_age.default),a>e.max_score&&(a=e.max_score),parseFloat(a).toFixed(1)},calcAssetScore:function(t,e){if(void 0==e||0===Object.keys(e).length)return 0;for(var a=0,i="",s=[],n=0;n<t.length;n++)i=t[n].split(":"),"Cr"===i[0]&&!["L","M","H"].includes(i[1])&&(a+=e.criticality.default),"Cr"===i[0]&&"L"===i[1]&&(a+=e.criticality.low),"Cr"===i[0]&&"M"===i[1]&&(a+=e.criticality.medium),"Cr"===i[0]&&"H"===i[1]&&(a+=e.criticality.high),"Cr"===i[0]&&s.push("Cr"),"E"===i[0]&&!["R","I","E"].includes(i[1])&&(a+=e.exposure.default),"E"===i[0]&&"R"===i[1]&&(a+=e.exposure.restricted),"E"===i[0]&&"I"===i[1]&&(a+=e.exposure.internal),"E"===i[0]&&"E"===i[1]&&(a+=e.exposure.external),"E"===i[0]&&s.push("E"),"D"===i[0]&&!["L","M","H"].includes(i[1])&&(a+=e.distribution.default),"D"===i[0]&&"L"===i[1]&&(a+=e.distribution.low),"D"===i[0]&&"M"===i[1]&&(a+=e.distribution.medium),"D"===i[0]&&"H"===i[1]&&(a+=e.distribution.high),"D"===i[0]&&s.push("D");return!s.includes("Cr")&&(a+=e.criticality.default),!s.includes("E")&&(a+=e.exposure.default),!s.includes("D")&&(a+=e.distribution.default),a>e.max_score&&(a=e.max_score),parseFloat(a).toFixed(1)}},mounted:function(){},destroyed:function(){}}),At={name:"Ratings",mixins:[mt,Et],data:function(){return{loading:!1,vulnerability:{access:{vector:"N",complexity:"L",authentication:"N"},impact:{confidentiality:"N",integrity:"N",availability:"N"},confirmation:!0,remediation:"X",age:(new Date).toISOString().substr(0,10)},threat:{exploit_availability:"X",exploit_maturity:"X",exploit_trust:"X",exploit_age:(new Date).toISOString().substr(0,10),in_the_news:!1,in_the_wild:!1},asset:{criticality:"X",exposure:"X",distribution:"X"},metrics_values:{},base_vector:"",base_vector_format:"VPRv1",score:"n/a",vuln_score:80,threat_score:0,asset_score:0,menu:!1,menu_vage:!1}},mounted:function(){this.base_vector=this.$route.query.vector,this.getDataFromApi(),null==this.base_vector&&""==this.base_vector||this.init_vector(this.base_vector)},computed:{rating_vector:function(){var t=[],e=[];e.push("AV:"+this.vulnerability.access.vector),e.push("AC:"+this.vulnerability.access.complexity),e.push("Au:"+this.vulnerability.access.authentication),e.push("C:"+this.vulnerability.impact.confidentiality),e.push("I:"+this.vulnerability.impact.integrity),e.push("A:"+this.vulnerability.impact.availability),1==this.vulnerability.confirmation&&e.push("CL:Y"),"X"!=this.vulnerability.remediation&&e.push("R:"+this.vulnerability.remediation),""!=this.vulnerability.age&&e.push("VX:"+ht()().diff(this.vulnerability.age,"days")),this.vuln_score=this.calcVulnScore(e,this.metrics_values.vulnerability),t=t.concat(e);var a=[];"X"!=this.threat.exploit_availability&&a.push("EA:"+this.threat.exploit_availability),"X"!=this.threat.exploit_maturity&&a.push("EM:"+this.threat.exploit_maturity),"X"!=this.threat.exploit_trust&&a.push("ET:"+this.threat.exploit_trust),!0===this.threat.in_the_news&&a.push("N:Y"),!0===this.threat.in_the_wild&&a.push("W:Y"),""!=this.threat.exploit_age&&a.push("EX:"+ht()().diff(this.threat.exploit_age,"days")),this.threat_score=this.calcThreatScore(a,this.metrics_values.threat),t=t.concat(a);var i=[];return"X"!=this.asset.criticality&&i.push("Cr:"+this.asset.criticality),"X"!=this.asset.exposure&&i.push("E:"+this.asset.exposure),"X"!=this.asset.distribution&&i.push("D:"+this.asset.distribution),this.asset_score=this.calcAssetScore(i,this.metrics_values.asset),t=t.concat(i),this.score=12*this.vuln_score+4*this.threat_score+5*this.asset_score,t.join("/")}},methods:{init_vector:function(t){if(void 0==t||0===Object.keys(t).length)return 0;for(var e="",a=t.split("/"),i=0;i<a.length;i++)e=a[i].split(":"),"AV"==e[0]&&(this.vulnerability.access.vector=e[1]),"AC"==e[0]&&(this.vulnerability.access.complexity=e[1]),"Au"==e[0]&&(this.vulnerability.access.authentication=e[1]),"C"==e[0]&&(this.vulnerability.impact.confidentiality=e[1]),"P"==this.vulnerability.impact.confidentiality&&(this.vulnerability.impact.confidentiality="L"),"I"==e[0]&&(this.vulnerability.impact.integrity=e[1]),"P"==this.vulnerability.impact.integrity&&(this.vulnerability.impact.integrity="L"),"A"==e[0]&&(this.vulnerability.impact.availability=e[1]),"P"==this.vulnerability.impact.availability&&(this.vulnerability.impact.availability="L"),"CL:Y"==a[i]&&(this.vulnerability.confirmation=!0),"R"==e[0]&&(this.vulnerability.remediation=e[1]),"VX"==e[0]&&(this.vulnerability.age=ht()().subtract(e[1],"days").toISOString(!0).substr(0,10)),"EA"==e[0]&&(this.threat.exploit_availability=e[1]),"EM"==e[0]&&(this.threat.exploit_maturity=e[1]),"ET"==e[0]&&(this.threat.exploit_trust=e[1]),"N:Y"==a[i]&&(this.threat.in_the_news=!0),"W:Y"==a[i]&&(this.threat.in_the_wild=!0),"VX"==e[0]&&(this.threat.exploit_age=ht()().subtract(e[1],"days").toISOString(!0).substr(0,10)),"Cr"==e[0]&&(this.asset.criticality=e[1]),"E"==e[0]&&(this.asset.exposure=e[1]),"D"==e[0]&&(this.asset.distribution=e[1])},getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.getMetricValues();setTimeout((function(){e({metrics_values:i})}),300)}))},getMetricValues:function(){var t=this;this.$api.get("/api/ratings/metrics").then((function(e){return t.metrics_values=e.data,t.loading=!1,t.metrics_values})).catch((function(e){t.metrics_values={},t.loading=!1,swal.fire({title:"Error",text:"unable to get metrics values",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))}}},Pt=At,Lt=a("a609"),$t=a("62ad"),Dt=a("2e4b"),Mt=a("e449"),Bt=a("0fd9"),Ot=a("b73d"),Ft=Object(l["a"])(Pt,St,It,!1,null,null,null),Yt=Ft.exports;u()(Ft,{VBtn:I["a"],VBtnToggle:Lt["a"],VCard:E["a"],VCardText:A["c"],VCardTitle:A["d"],VCol:$t["a"],VContainer:P["a"],VDatePicker:Dt["a"],VFlex:L["a"],VLayout:D["a"],VMenu:Mt["a"],VProgressCircular:M["a"],VRow:Bt["a"],VSpacer:B["a"],VSwitch:Ot["a"],VTextField:O["a"]});var Nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v(" Settings Page "),a("v-row",[a("v-col",{attrs:{cols:"3"}},[a("v-card",{staticClass:"mx-auto"},[a("v-list",{attrs:{dense:""}},[a("v-subheader",[t._v("Synchronize data")]),a("v-list-item-group",{attrs:{color:"primary"},model:{value:t.async_item,callback:function(e){t.async_item=e},expression:"async_item"}},t._l(t.async_items,(function(e,i){return a("v-list-item",{key:i,on:{click:function(a){return t.callAction(e)}}},[a("v-list-item-icon",[a("v-icon",{attrs:{color:"deep-orange"},domProps:{textContent:t._s(e.icon)}})],1),a("v-list-item-content",[a("v-list-item-title",{attrs:{link:"",to:e.to},domProps:{textContent:t._s(e.text)}})],1)],1)})),1)],1)],1)],1)],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)},Rt=[],Ut={name:"Settings",data:function(){return{async_item:1,async_items:[{text:"CWE",icon:"mdi-clock",to:"/api/kb/cwes/async"},{text:"CPE",icon:"mdi-clock",to:"/api/kb/cpes/async"},{text:"Bulletins",icon:"mdi-clock",to:"/api/kb/bulletins/async"},{text:"CVE",icon:"mdi-clock",to:"/api/kb/cves/async"},{text:"VIA",icon:"mdi-clock",to:"/api/kb/vias/async"}],snack:!1,snackColor:"",snackText:""}},mounted:function(){},methods:{callAction:function(t){var e=this;this.$api.get(t.to).then((function(t){t&&200===t.status?(e.snack=!0,e.snackColor="success",e.snackText="Sync successfuly enqueued."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to sync :/")})).catch((function(t){swal.fire({title:"Error",text:"Unable to call action",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))}}},zt=Ut,Xt=a("1baa"),Ht=a("34c3"),Wt=a("2db4"),qt=a("e0c7"),Jt=Object(l["a"])(zt,Nt,Rt,!1,null,null,null),Kt=Jt.exports;u()(Jt,{VBtn:I["a"],VCard:E["a"],VCol:$t["a"],VIcon:et["a"],VList:at["a"],VListItem:st["a"],VListItemContent:ot["a"],VListItemGroup:Xt["a"],VListItemIcon:Ht["a"],VListItemTitle:ot["c"],VRow:Bt["a"],VSnackbar:Wt["a"],VSubheader:qt["a"]});var Gt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v(" Search page - Results for "+t._s(this.appsearch)+" "),!0===t.loading?a("v-progress-circular",{attrs:{indeterminate:"",rotate:"0",size:"24",width:"4",color:"deep-orange"}}):t._e(),a("v-container",{attrs:{fluid:""}},[a("v-row",{attrs:{dense:""}},t._l(t.results,(function(e){return a("v-col",{key:e.type+e.value.id,attrs:{cols:"4"}},[a("v-card",["vuln"==e.type?a("v-card-title",[t._v(" Vulnerability #PHID-"+t._s(e.value.id)+" ")]):t._e(),"vuln"==e.type?a("v-card-subtitle",[a("v-clamp",{attrs:{autoresize:"","max-lines":3},scopedSlots:t._u([{key:"after",fn:function(e){var i=e.toggle,s=e.expanded,n=e.clamped;return s||n?a("button",{staticClass:"toggle btn btn-sm",on:{click:i}},[t._v(" "+t._s(" more")+" ")]):t._e()}}],null,!0)},[t._v(" "+t._s(e.value.summary)+" ")])],1):t._e(),"vuln"==e.type?a("v-card-text",[a("dl",[a("dt",[t._v("Score")]),a("dd",[a("v-chip",{staticClass:"pa-2",attrs:{small:"",label:"",color:t.getRatingColor(e.value.score)}},[t._v(" "+t._s(e.value.score)+" ")])],1),a("dt",[t._v("CVE")]),a("dd",[t._v(t._s(e.value.cve_id))]),a("dt",[t._v("CVSSv2")]),a("dd",[t._v(t._s(e.value.cvss)+" - "+t._s(e.value.cvss_vector))]),a("dt",[t._v("Products")]),a("dd",[t._v(t._s(t.getVendorProduct(e.value.vulnerable_products)))]),a("dt",[t._v("Last update")]),a("dd",[t._v(t._s(t.moment(e.value.updated_at).format("YYYY-MM-DD")))])]),a("v-chip",{staticClass:"pa-2",staticStyle:{height:"20px"},attrs:{outlined:"",color:t.getBoolColor(e.value.is_exploitable)}},[t._v(" Exploitable: "+t._s(t.getBoolValue(e.value.is_exploitable))+" ")]),t._v(" "),a("v-chip",{staticClass:"pa-2",staticStyle:{height:"20px"},attrs:{outlined:"",color:t.getBoolColor(e.value.is_confirmed)}},[t._v(" Confirmed: "+t._s(t.getBoolValue(e.value.is_confirmed))+" ")]),t._v(" "),a("v-chip",{staticClass:"pa-2",staticStyle:{height:"20px"},attrs:{outlined:"",color:t.getBoolColor(e.value.is_in_the_news)}},[t._v(" In the news: "+t._s(t.getBoolValue(e.value.is_in_the_news))+" ")]),t._v(" "),a("v-chip",{staticClass:"pa-2",staticStyle:{height:"20px"},attrs:{outlined:"",color:t.getBoolColor(e.value.is_in_the_wild)}},[t._v(" In the wild: "+t._s(t.getBoolValue(e.value.is_in_the_wild))+" ")])],1):t._e(),"exploit"==e.type?a("v-card-title",[t._v(" Exploit for #PHID-"+t._s(e.value.vuln)+" ")]):t._e(),"exploit"==e.type?a("v-card-subtitle",[t._v(" "+t._s(e.value.link)+" ")]):t._e(),"exploit"==e.type?a("v-card-text",[a("dl",[a("dt",[t._v("Trust Level")]),a("dd",[t._v(t._s(t._f("capitalize")(e.value.trust_level)))]),a("dt",[t._v("TLP")]),a("dd",[t._v(t._s(t._f("capitalize")(e.value.tlp_level)))]),a("dt",[t._v("Source")]),a("dd",[t._v(t._s(t._f("capitalize")(e.value.source)))]),a("dt",[t._v("Availability")]),a("dd",[t._v(t._s(t._f("capitalize")(e.value.availability)))]),a("dt",[t._v("Maturity")]),a("dd",[t._v(t._s(t._f("capitalize")(e.value.maturity)))]),a("dt",[t._v("Notes")]),a("dd",[a("v-clamp",{attrs:{autoresize:"","max-lines":5},scopedSlots:t._u([{key:"after",fn:function(e){var i=e.toggle,s=e.expanded,n=e.clamped;return s||n?a("button",{on:{click:i}},[t._v(" "+t._s(" more")+" ")]):t._e()}}],null,!0)},[t._v(" "+t._s(e.value.notes)+" ")])],1),a("dt",[t._v("Last update")]),a("dd",[t._v(t._s(t.moment(e.value.modified).format("YYYY-MM-DD")))])])]):t._e(),a("v-card-actions",["exploit"==e.type?a("v-btn",{attrs:{text:"",color:"deep-orange accent-4",to:"/vulns/"+e.value.vuln}},[t._v("Explore")]):t._e(),"vuln"==e.type?a("v-btn",{attrs:{text:"",color:"deep-orange accent-4",to:"/vulns/"+e.value.id}},[t._v("Explore")]):t._e()],1)],1)],1)})),1)],1)],1)},Zt=[],Qt=(a("a4d3"),a("e01a"),a("d28b"),a("6062"),a("3ca3"),a("5319"),a("498a"),a("ddb0"),a("2909")),te={name:"Search",mixins:[mt],components:{VClamp:vt["a"]},data:function(){return{results:[],totalresults:0,loading:!0,limit:25,options:{},appsearch:""}},beforeRouteUpdate:function(t){this.appsearch=t.params.appsearch},mounted:function(){this.appsearch=this.$router.currentRoute.params.appsearch},watch:{appsearch:{handler:function(t){this.appsearch=t,this.getDataFromApi()}}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,s=i.sortBy,n=i.sortDesc,o=i.page,r=(i.itemsPerPage,t.search_query(o,t.limit,s,n));setTimeout((function(){e({items:r})}),300)}))},search_query:function(t,e,a,i){var s=this,n="",o=this.appsearch.trim().toLowerCase();this.$api.get("/api/search/"+o+"?limit="+e+"&page="+t+n).then((function(t){return s.results=t.data,s.loading=!1,s.vulns})).catch((function(t){s.results=[],s.loading=!1,swal.fire({title:"Error",text:"unable to get results from search query",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},getBoolValue:function(t){return t?"Yes":"No"},getVendorProduct:function(t){if(void 0==t)return"unknown";var e,a,i=Array(),s=!0,n=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(s=(r=l.next()).done);s=!0)e=r.value,a=e.split(":")[4].replace(/_/g," ")+" ("+e.split(":")[3].replace(/_/g," ")+")",i.push(a)}catch(c){n=!0,o=c}finally{try{s||null==l.return||l.return()}finally{if(n)throw o}}return i=Object(Qt["a"])(new Set(i)),i.join(", ")}}},ee=te,ae=(a("3f07"),Object(l["a"])(ee,Gt,Zt,!1,null,null,null)),ie=ae.exports;u()(ae,{VBtn:I["a"],VCard:E["a"],VCardActions:A["a"],VCardSubtitle:A["b"],VCardText:A["c"],VCardTitle:A["d"],VChip:gt["a"],VCol:$t["a"],VContainer:P["a"],VProgressCircular:M["a"],VRow:Bt["a"]});var se=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Vulnerabilities ")]),a("v-col",{staticClass:"pa-2"},[a("v-chip",{attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(this.show_all)},on:{click:function(e){return t.toggleShowAll()}}},[t._v("All")]),t._v(" "),a("v-chip",{attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(this.show_last_day)},on:{click:function(e){return t.toggleShowLastDay()}}},[t._v("Last 24h")]),t._v(" "),a("v-chip",{attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(this.show_last_week)},on:{click:function(e){return t.toggleShowLastWeek()}}},[t._v("Last Week")])],1),a("v-col",{staticClass:"pa-2",attrs:{md:"6"}},[a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)],1)],1)],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.vulns.results,options:t.options,"server-items-length":t.vulns.count,search:t.search,"items-per-page":20,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id","show-select":"","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.summary",fn:function(e){var i=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1},scopedSlots:t._u([{key:"after",fn:function(e){var i=e.toggle,s=e.expanded,n=e.clamped;return s||n?a("button",{staticClass:"toggle btn btn-sm",on:{click:i}},[t._v(" "+t._s(" more")+" ")]):t._e()}}],null,!0)},[t._v(" "+t._s(i.summary)+" ")])]}},{key:"item.score",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"text-center",attrs:{color:t.getRatingColor(i.score),small:""}},[t._v(" "+t._s(i.score)+" ")])]}},{key:"item.is_exploitable",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"text-center",attrs:{color:t.getBool(i.is_exploitable),small:"",label:""}})]}},{key:"item.is_confirmed",fn:function(e){var i=e.item;return[1==i.is_confirmed?a("v-icon",{staticClass:"mdi mdi-check",attrs:{small:"",color:"gray"}}):t._e()]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD, hh:mm:ss")))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewVuln(i.id)}}}),a("v-icon",{staticClass:"mdi mdi-pencil",attrs:{small:"",color:"orange"},on:{click:function(e){return t.editVuln(i)}}}),a("v-icon",{staticClass:"mdi mdi-delete",attrs:{small:"",color:"red"},on:{click:function(e){return t.deleteVuln(i)}}})]}}])})],1)],1)},ne=[],oe=(a("841c"),{name:"vulns",mixins:[mt],components:{VClamp:vt["a"]},data:function(){return{vulns:[],totalvulns:0,loading:!0,limit:20,search:"",show_all:!1,show_last_day:!0,show_last_week:!1,options:{},selected:[],headers:[{text:"PHID",value:"id"},{text:"CVE",value:"cve",width:"150px"},{text:"Summary",value:"summary"},{text:"CVSSv2",value:"cvss",align:"center"},{text:"Score",value:"score",align:"center"},{text:"Exploits",value:"exploit_count",align:"center"},{text:"Confirm ?",value:"is_confirmed",align:"center"},{text:"Last update",value:"updated_at",align:"center"},{text:"Actions",value:"action",sortable:!1}],rowsPerPageItems:[5,10,20,50,100]}},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi()},deep:!0},options:{handler:function(){this.getDataFromApi().then((function(t){}))},deep:!0},show_all:{handler:function(){this.getDataFromApi()},deep:!0},show_last_day:{handler:function(){this.getDataFromApi()},deep:!0},show_last_week:{handler:function(){this.getDataFromApi()},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.search.trim().toLowerCase();t.limit=r;var l=t.getVulns(o,t.limit,s,n);setTimeout((function(){e({items:l})}),300)}))},getVulns:function(t,e,a,i){var s=this,n="";a.length>0&&(n=!0===i[0]?"sorted_by=-"+a:"sorted_by="+a);var o="";1==this.show_last_day?o="&updated_at__gte="+ht()(new Date).format("YYYY-MM-DD"):1==this.show_last_week&&(o="&updated_at__gte="+ht()(new Date).subtract(7,"day").format("YYYY-MM-DD")),this.$api.get("/api/vulns/?limit="+e+"&page="+t+"&search="+this.search+"&"+n+o).then((function(t){return s.vulns=t.data,s.loading=!1,s.vulns})).catch((function(t){s.vulns=[],s.loading=!1,j.a.fire({title:"Error",text:"unable to get vulns",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},viewVuln:function(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t}})},editVuln:function(t){},deleteVuln:function(t){},clickRow:function(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t.id}})},getBool:function(t){return 1==t?"red":"grey"},toggleShowAll:function(){0==this.show_all&&(this.show_all=!this.show_all),1==this.show_all&&(this.show_last_day=!1,this.show_last_week=!1)},toggleShowLastDay:function(){1==this.show_last_day&&(this.show_all=!0,this.show_last_day=!1,this.show_last_week=!1),0==this.show_last_day&&(this.show_last_day=!0,this.show_all=!1,this.show_last_week=!1)},toggleShowLastWeek:function(){1==this.show_last_week&&(this.show_all=!0,this.show_last_day=!1,this.show_last_week=!1),0==this.show_last_week&&(this.show_last_week=!0,this.show_all=!1,this.show_last_day=!1)}}}),re=oe,le=(a("8083"),Object(l["a"])(re,se,ne,!1,null,null,null)),ce=le.exports;u()(le,{VCard:E["a"],VCardTitle:A["d"],VChip:gt["a"],VCol:$t["a"],VContainer:P["a"],VDataTable:bt["a"],VIcon:et["a"],VRow:Bt["a"],VTextField:O["a"]});var ue=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("Summary")]),a("v-tab",[this.exploits.length>0?a("v-badge",{attrs:{color:"deep-orange",content:this.exploits.length}},[t._v("Exploits")]):t._e(),0==this.exploits.length?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Exploits")]):t._e()],1),a("v-tab",[this.threats.length>0?a("v-badge",{attrs:{color:"deep-orange",content:this.threats.length}},[t._v("Threat activities")]):t._e(),0==this.threats.length?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Threat activities")]):t._e()],1),a("v-tab",[t._v("Timeline")]),a("v-tab-item",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md8:""}},[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[a("v-container",{staticClass:"grey lighten-5"},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Vuln ID: PH-"+t._s(t.$route.params.vuln_id)+" ")]),a("v-col",{staticClass:"pa-2"},[this.vuln.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.toggleMonitored}},[t._v("Monitored")]):t._e(),this.vuln.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.toggleMonitored}},[t._v("Not monitored")])],1)],1)],1)],1),a("v-card-text",[a("v-list",{attrs:{subheader:"",color:"grey lighten-5"}},[a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("CVE")]),t._v(" "+t._s(this.vuln.cve)+" ")],1)],1),a("v-list-item",[a("v-list-item-content",{staticClass:"d-inline"},[a("v-list-item-subtitle",[t._v("CVSSv2")]),a("v-chip",{attrs:{small:"",label:"",color:t.getCVSSColor(this.vuln.cvss)}},[t._v(" "+t._s(this.vuln.cvss)+" ")]),t._v(" - "+t._s(this.vuln.cvss_vector)+" ("+t._s(t.moment(this.vuln.cvss_time).format("YYYY-MM-DD"))+") ")],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Summary")]),t._v(" "+t._s(this.vuln.summary)+" ")],1)],1),""!=this.vuln.cwe_id?a("v-list-item",{attrs:{href:"https://cwe.mitre.org/data/definitions/"+this.vuln.cwe_id+".html"}},[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("CWE")]),t._v(" CWE-"+t._s(this.vuln.cwe_id)+" ")],1)],1):t._e(),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Links")]),a("ul",{attrs:{id:"v-for-reflinks"}},t._l(this.vuln.reflinks,(function(e){return a("li",{attrs:{link:""}},[a("a",{attrs:{href:e}},[t._v(" "+t._s(e)+" ")])])})),0)],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Vulnerable products (CPE)")]),a("ul",{attrs:{id:"v-for-cpe"}},t._l(this.vuln.vulnerable_products,(function(e){return a("li",[t._v(" "+t._s(e)+" ")])})),0)],1)],1)],1)],1)],1)],1),a("v-flex",{attrs:{md4:""}},[a("v-flex",[this.ratings.score>=0?a("v-card",{attrs:{color:t.getRatingColor(t.vprating)},on:{click:function(e){return t.viewRating()}}},[a("v-card-title",{staticClass:"title"},[t._v("Rating Scores")]),a("v-card-text",[a("v-row",{attrs:{align:"center"}},[a("v-col",{staticClass:"display-3 font-weight-bold",attrs:{cols:"4",align:"center"}},[t._v(" "+t._s(t.vprating)+" ")]),a("v-col",{attrs:{cols:"6"}},[t._v(" CVSSv2 Base: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(t.cvssv2adj[0]))]),a("br"),t._v(" CVSSv2 Temporal: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(t.cvssv2adj[1]))])])],1)],1)],1):t._e()],1),a("v-flex",[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v("Metrics")]),a("v-card-text",[a("v-switch",{staticStyle:{"margin-top":"0px"},attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Exploitable"},model:{value:t.is_exploitable,callback:function(e){t.is_exploitable=e},expression:"is_exploitable"}}),a("v-switch",{staticStyle:{"margin-top":"0px"},attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Confirmed"},model:{value:t.is_confirmed,callback:function(e){t.is_confirmed=e},expression:"is_confirmed"}}),a("v-switch",{staticStyle:{"margin-top":"0px"},attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Relayed in the News"},model:{value:t.is_in_the_news,callback:function(e){t.is_in_the_news=e},expression:"is_in_the_news"}}),a("v-switch",{staticStyle:{"margin-top":"0px"},attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Exploited in the Wild"},model:{value:t.is_in_the_wild,callback:function(e){t.is_in_the_wild=e},expression:"is_in_the_wild"}})],1)],1)],1),a("v-flex",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-card",{attrs:{color:"grey lighten-5",height:"100%"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v("Impact")]),a("v-card-text",[t._v(" Confidentiality: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.impact.confidentiality))]),a("br"),t._v(" Integrity: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.impact.integrity))]),a("br"),t._v(" Availability: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.impact.availability))])])],1)],1),a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-card",{attrs:{color:"grey lighten-5",height:"100%"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v("Access")]),a("v-card-text",[t._v(" Authentication: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.access.authentication))]),a("br"),t._v(" Complexity: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.access.complexity))]),a("br"),t._v(" Vector: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.access.vector))])])],1)],1)],1)],1)],1)],1)],1)],1),a("v-tab-item",[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.exploit_headers,items:t.exploits,"item-key":"id","multi-sort":"","show-expand":"",expanded:t.expanded},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"item.link",fn:function(e){var i=e.item;return[a("a",{attrs:{href:i.link}},[t._v(t._s(i.link))])]}},{key:"item.trust_level",fn:function(e){var a=e.item;return[t._v(" "+t._s(t._f("capitalize")(a.trust_level))+" ")]}},{key:"item.tlp_level",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",small:"",color:t.getTLPColor(i.tlp_level)}},[t._v(" TLP:"+t._s(t._f("capitalize")(i.tlp_level))+" ")])]}},{key:"item.modified",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.modified).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-pencil",attrs:{small:"",color:"orange"},on:{click:function(e){return t.editExploit(i)}}}),a("v-icon",{staticClass:"mdi mdi-delete",attrs:{small:"",color:"red"},on:{click:function(e){return t.deleteExploit(i)}}})]}},{key:"expanded-item",fn:function(e){var i=e.headers,s=e.item;return[a("td",{attrs:{colspan:i.length}},[t._v(t._s(s.notes))])]}}])}),a("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-btn",t._g({attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"}},i),[a("v-icon",[t._v("mdi-plus")])],1)]}}]),model:{value:t.dialog_exploit,callback:function(e){t.dialog_exploit=e},expression:"dialog_exploit"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v(t._s(t.formExploitTitle))])]),a("v-card-text",[a("v-container",[a("v-form",{ref:"form-new-exploit"},[a("v-text-field",{attrs:{label:"link"},model:{value:t.editedItem.link,callback:function(e){t.$set(t.editedItem,"link",e)},expression:"editedItem.link"}}),a("v-select",{attrs:{label:"Trust Level",items:t.editedItem.trust_level_items},model:{value:t.editedItem.trust_level,callback:function(e){t.$set(t.editedItem,"trust_level",e)},expression:"editedItem.trust_level"}}),a("v-select",{attrs:{label:"TLP Level",items:t.editedItem.tlp_level_items},model:{value:t.editedItem.tlp_level,callback:function(e){t.$set(t.editedItem,"tlp_level",e)},expression:"editedItem.tlp_level"}}),a("v-text-field",{attrs:{label:"Source"},model:{value:t.editedItem.source,callback:function(e){t.$set(t.editedItem,"source",e)},expression:"editedItem.source"}}),a("v-select",{attrs:{label:"Availability",items:t.editedItem.availability_items},model:{value:t.editedItem.availability,callback:function(e){t.$set(t.editedItem,"availability",e)},expression:"editedItem.availability"}}),a("v-select",{attrs:{label:"Maturity",items:t.editedItem.maturity_items},model:{value:t.editedItem.maturity,callback:function(e){t.$set(t.editedItem,"maturity",e)},expression:"editedItem.maturity"}}),a("v-text-field",{attrs:{label:"Notes"},model:{value:t.editedItem.notes,callback:function(e){t.$set(t.editedItem,"notes",e)},expression:"editedItem.notes"}}),a("v-btn",{attrs:{color:"success"},on:{click:t.saveNewExploit}},[t._v("Save")]),a("v-btn",{attrs:{color:"warning",type:"reset"}},[t._v("Reset")])],1)],1)],1),a("v-card-actions",[a("v-spacer")],1)],1)],1)],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1),a("v-tab-item",[a("v-card",[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.threat_headers,items:t.threats,"item-key":"id","multi-sort":"","show-expand":"",expanded:t.expanded},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"item.link",fn:function(e){var i=e.item;return[a("a",{attrs:{href:i.link}},[t._v(t._s(i.link))])]}},{key:"item.trust_level",fn:function(e){var a=e.item;return[t._v(" "+t._s(t._f("capitalize")(a.trust_level))+" ")]}},{key:"item.tlp_level",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",small:"",color:t.getTLPColor(i.tlp_level)}},[t._v(" TLP:"+t._s(t._f("capitalize")(i.tlp_level))+" ")])]}},{key:"item.modified",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.modified).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-pencil",attrs:{small:"",color:"orange"},on:{click:function(e){return t.editThreat(i)}}}),a("v-icon",{staticClass:"mdi mdi-delete",attrs:{small:"",color:"red"},on:{click:function(e){return t.deleteThreat(i)}}})]}},{key:"expanded-item",fn:function(e){var i=e.headers,s=e.item;return[a("td",{attrs:{colspan:i.length}},[t._v(t._s(s.notes))])]}}])}),a("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-btn",t._g({attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"}},i),[a("v-icon",[t._v("mdi-plus")])],1)]}}]),model:{value:t.dialog_threat,callback:function(e){t.dialog_threat=e},expression:"dialog_threat"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v(t._s(t.formThreatTitle))])]),a("v-card-text",[a("v-container",[a("v-form",{ref:"form-new-threat"},[a("v-text-field",{attrs:{label:"link"},model:{value:t.editedItem.link,callback:function(e){t.$set(t.editedItem,"link",e)},expression:"editedItem.link"}}),a("v-select",{attrs:{label:"Trust Level",items:t.editedItem.trust_level_items},model:{value:t.editedItem.trust_level,callback:function(e){t.$set(t.editedItem,"trust_level",e)},expression:"editedItem.trust_level"}}),a("v-select",{attrs:{label:"TLP Level",items:t.editedItem.tlp_level_items},model:{value:t.editedItem.tlp_level,callback:function(e){t.$set(t.editedItem,"tlp_level",e)},expression:"editedItem.tlp_level"}}),a("v-text-field",{attrs:{label:"Source"},model:{value:t.editedItem.source,callback:function(e){t.$set(t.editedItem,"source",e)},expression:"editedItem.source"}}),a("v-select",{attrs:{label:"Availability",items:t.editedItem.availability_items},model:{value:t.editedItem.availability,callback:function(e){t.$set(t.editedItem,"availability",e)},expression:"editedItem.availability"}}),a("v-select",{attrs:{label:"Maturity",items:t.editedItem.maturity_items},model:{value:t.editedItem.maturity,callback:function(e){t.$set(t.editedItem,"maturity",e)},expression:"editedItem.maturity"}}),a("v-text-field",{attrs:{label:"Notes"},model:{value:t.editedItem.notes,callback:function(e){t.$set(t.editedItem,"notes",e)},expression:"editedItem.notes"}}),a("v-btn",{attrs:{color:"success"},on:{click:t.saveNewThreat}},[t._v("Save")])],1)],1)],1),a("v-card-actions",[a("v-spacer")],1)],1)],1)],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1),a("v-tab-item",[this.history?a("v-card",{attrs:{color:"grey lighten-5"}},[this.history.length>0?a("v-timeline",{attrs:{clipped:"",dense:""}},t._l(this.history,(function(e){return a("v-timeline-item",{key:e.date,attrs:{color:"blue",small:"","fill-dot":""}},[a("v-card",{staticClass:"elevation-2"},[a("v-card-title",{staticClass:"headline"},[t._v(t._s(e.reason)+" at '"+t._s(e.date)+"'")]),a("v-card-text",t._l(e.changes,(function(e){return a("span",{key:e},[t._v(t._s(e)),a("br")])})),0)],1)],1)})),1):t._e()],1):t._e()],1)],1)},de=[],ve=(a("c975"),a("a434"),{name:"VulnDetails",data:function(){return{expanded:[],vuln_id:"",vuln:{cwe_id:"",impact:{confidentiality:"",integrity:"",availability:""},access:{authentication:"",complexity:"",vector:""}},ratings:{},history:{},threats:{},threat_headers:[{text:"Link",value:"link"},{text:"Trust level",value:"trust_level"},{text:"TLP",value:"tlp_level",align:"center"},{text:"Source",value:"source",align:"center"},{text:"In the Wild ?",value:"is_in_the_wild",align:"center"},{text:"In the News ?",value:"is_in_the_news",align:"center"},{text:"Last update",value:"modified",align:"center"},{text:"Actions",value:"action",sortable:!1},{text:"",value:"data-table-expand"}],exploits:[],exploit_headers:[{text:"Link",value:"link"},{text:"Trust level",value:"trust_level"},{text:"TLP",value:"tlp_level",align:"center"},{text:"Source",value:"source",align:"center"},{text:"Availability",value:"availability",align:"center"},{text:"Maturity",value:"maturity",align:"center"},{text:"Last update",value:"modified",align:"center"},{text:"Actions",value:"action",sortable:!1},{text:"",value:"data-table-expand"}],editedIndex:-1,defaultMetadata:{link:"https://",notes:"",trust_level:"high",trust_level_items:["unknown","low","medium","high"],tlp_level:"white",tlp_level_items:["white","green","amber","red","black"],source:"manual",availability:"public",availability_items:["unknown","private","public"],maturity:"unknown",maturity_items:["unknown","unproven","poc","functional"],modified:"",is_in_the_wild:0,is_in_the_news:0,published:""},editedItem:{},dialog_exploit:!1,dialog_threat:!1,snack:!1,snackColor:"",snackText:""}},mounted:function(){this.vuln_id=this.$router.currentRoute.params.vuln_id,this.editedItem=this.defaultMetadata,this.getDataFromApi(this.vuln_id)},computed:{formExploitTitle:function(){return-1===this.editedIndex?"New Exploit":"Edit Exploit"},formThreatTitle:function(){return-1===this.editedIndex?"New threat activity":"Edit threat activity"},is_exploitable:function(){return this.vuln.is_exploitable},is_confirmed:function(){return this.vuln.is_confirmed},is_in_the_news:function(){return this.vuln.is_in_the_news},is_in_the_wild:function(){return this.vuln.is_in_the_wild},vprating:function(){return this.ratings.score},cvssv2adj:function(){return this.ratings.cvssv2adj},vuln_vector:function(){var t="";t+=this.vuln.cvss_vector,this.vuln.is_confirmed&&(t+="/CL:Y"),ht()(this.vuln.published).isValid()&&(t+="/VX:"+ht()().diff(ht()(this.vuln.published),"days"));for(var e,a,i,s=["unknown","private","public"],n=["X","R","U"],o=["unknown","unproven","poc","functional"],r=["X","U","P","F"],l=["unknown","low","medium","high","trusted"],c=["X","L","M","H","H"],u=0,d=0,v=0,m=0,p=0;p<this.exploits.length;p++)e=s.indexOf(this.exploits[p].availability),e>u&&(u=e),a=o.indexOf(this.exploits[p].maturity),a>d&&(d=a),i=l.indexOf(this.exploits[p].trust_level),i>v&&(v=i),ht()(this.exploits[p].published).isValid()&&ht()().diff(ht()(this.exploits[p].published),"days")>m&&(m=ht()().diff(ht()(this.exploits[p].published),"days"));return t+="/EA:"+n[u],t+="/EM:"+r[d],t+="/ET:"+c[v],t+="/EX:"+m,this.is_in_the_news&&(t+="/N:Y"),this.is_in_the_wild&&(t+="/W:Y"),t}},methods:{getDataFromApi:function(t){var e=this;return new Promise((function(a,i){var s=e.getVulnDetails(t),n=e.getHistory(t),o=e.getRatings(t),r=e.getExploits(t),l=e.getThreats(t);setTimeout((function(){e.loading=!1,a({vuln:s,history:n,ratings:o,exploits:r,threats:l})}),300)}))},getVulnDetails:function(t){var e=this;this.loading=!0,this.$api.get("/api/vulns/"+t).then((function(t){return e.vuln=t.data,e.vuln})).catch((function(t){e.vuln={},e.loading=!1,j.a.fire({title:"Error",text:"unable to get vuln details",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getRatings:function(t){var e=this;this.loading=!0,this.$api.get("/api/ratings/calc/"+t).then((function(t){return e.ratings=t.data,e.vuln})).catch((function(t){e.ratings={},e.loading=!1,j.a.fire({title:"Error",text:"unable to get vuln ratings",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getExploits:function(t){var e=this;this.loading=!0,this.$api.get("/api/vulns/"+t+"/exploits").then((function(t){return e.exploits=t.data,e.exploits})).catch((function(t){e.exploits={},e.loading=!1,j.a.fire({title:"Error",text:"unable to get related exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getThreats:function(t){var e=this;this.loading=!0,this.$api.get("/api/vulns/"+t+"/threats").then((function(t){return e.threats=t.data,e.threats})).catch((function(t){e.threats={},e.loading=!1,j.a.fire({title:"Error",text:"unable to get related threats",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getHistory:function(t){var e=this;this.loading=!0,this.$api.get("/api/vulns/"+t+"/history").then((function(t){return e.history=t.data,e.threats})).catch((function(t){e.history={},e.loading=!1,j.a.fire({title:"Error",text:"unable to get vuln history",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getCVSSColor:function(t){return t>=9?"red darken-4":t>=7?"red":t>=4?"orange":t>=.1?"yellow":"grey"},getTLPColor:function(t){return"white"===t?"":"green"===t?"green":"amber"===t?"orange":"red"===t?"red":"black"===t?"black":"grey"},getRatingColor:function(t){return t>=80?"red":t>=60?"orange":t>=40?"yellow":t>=0?"blue":"grey"},saveNewExploit:function(){var t=this;this.editedItem.modified=new Date,this.$api.post("/api/vulns/"+this.vuln_id+"/exploits/add",this.editedItem).then((function(e){e&&200===e.status?(t.snack=!0,t.snackColor="success",t.snackText="Exploit successfuly saved."):(t.snack=!0,t.snackColor="error",t.snackText="Unable to save the exploit metadata.")})).catch((function(e){t.loading=!1,j.a.fire({title:"Error",text:"unable to save related exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),t.dialog_exploit=!1,t.editedItem=t.defaultMetadata}));var e=JSON.parse(JSON.stringify(this.editedItem));this.editedIndex>-1?Object.assign(this.exploits[this.editedIndex],e):this.exploits.push(e),this.editedItem=JSON.parse(JSON.stringify(this.defaultMetadata)),this.dialog_exploit=!1},editExploit:function(t){this.editedIndex=this.exploits.indexOf(t),this.editedItem=Object.assign({},t),this.dialog_exploit=!0,this.snack=!0,this.snackColor="success",this.snackText="Exploit successfuly edited."},deleteExploit:function(t){var e=this;this.$api.get("/api/vulns/"+this.vuln_id+"/exploits/"+t.id+"/del").then((function(t){t?(e.snack=!0,e.snackColor="success",e.snackText="Exploit successfuly deleted."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to delete the exploit")})).catch((function(t){e.loading=!1,j.a.fire({title:"Error",text:"unable to delete related exploit",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),e.dialog_exploit=!1})),this.editedIndex=this.exploits.indexOf(t),this.exploits.splice(this.editedIndex,1)},saveNewThreat:function(){var t=this;this.editedItem.modified=new Date,this.$api.post("/api/vulns/"+this.vuln_id+"/threats/add",this.editedItem).then((function(e){e&&200===e.status?(t.snack=!0,t.snackColor="success",t.snackText="Threat activity successfuly saved."):(t.snack=!0,t.snackColor="error",t.snackText="Unable to save the threat activity.")})).catch((function(e){t.loading=!1,j.a.fire({title:"Error",text:"unable to save related threat activity",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),t.dialog_threat=!1}));var e=JSON.parse(JSON.stringify(this.editedItem));this.editedIndex>-1?Object.assign(this.threats[this.editedIndex],e):this.threats.push(e),this.editedItem=JSON.parse(JSON.stringify(this.defaultMetadata)),this.dialog_threat=!1},editThreat:function(t){this.editedIndex=this.threats.indexOf(t),this.editedItem=Object.assign({},t),this.dialog_threat=!0,this.snack=!0,this.snackColor="success",this.snackText="Threat activity successfuly edited."},deleteThreat:function(t){var e=this;this.$api.get("/api/vulns/"+this.vuln_id+"/threats/"+t.id+"/del").then((function(t){t?(e.snack=!0,e.snackColor="success",e.snackText="Threat activity successfuly deleted."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to delete the threat activity")})).catch((function(t){e.loading=!1,j.a.fire({title:"Error",text:"unable to delete related threat activity",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),e.dialog_threat=!1})),this.editedIndex=this.threats.indexOf(t),this.threats.splice(this.editedIndex,1)},viewRating:function(){this.$router.push({name:"Ratings",query:{vector:this.vuln_vector}})},toggleMonitored:function(t){var e=this,a={monitored:!this.vuln.monitored};this.$api.put("/api/vulns/"+this.vuln_id+"/",a).then((function(t){t?(e.vuln.monitored=!e.vuln.monitored,e.snack=!0,e.snackColor="success",e.snackText="Vulnerability monitoring successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the vulnerability monitoring status")})).catch((function(t){e.loading=!1,j.a.fire({title:"Error",text:"Unable to change the vulnerability monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))}}}),me=ve,pe=a("4ca6"),he=a("169a"),fe=a("b974"),_e=a("71a3"),ge=a("c671"),be=a("fe57"),ye=a("8414"),xe=a("1e06"),ke=Object(l["a"])(me,ue,de,!1,null,null,null),Ce=ke.exports;u()(ke,{VBadge:pe["a"],VBtn:I["a"],VCard:E["a"],VCardActions:A["a"],VCardText:A["c"],VCardTitle:A["d"],VChip:gt["a"],VCol:$t["a"],VContainer:P["a"],VDataTable:bt["a"],VDialog:he["a"],VFlex:L["a"],VForm:$["a"],VIcon:et["a"],VLayout:D["a"],VList:at["a"],VListItem:st["a"],VListItemContent:ot["a"],VListItemSubtitle:ot["b"],VRow:Bt["a"],VSelect:fe["a"],VSnackbar:Wt["a"],VSpacer:B["a"],VSwitch:Ot["a"],VTab:_e["a"],VTabItem:ge["a"],VTabs:be["a"],VTextField:O["a"],VTimeline:ye["a"],VTimelineItem:xe["a"]});var we=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",[t._v(" Exploits metadata "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.exploits.results,options:t.options,"server-items-length":t.exploits.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id","show-select":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.vp",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.getVendorProduct(i.vp)))])]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewVuln(i.vuln_id)}}})]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},Ve=[],je=a("2ef0"),Te=a.n(je),Se={name:"exploits",data:function(){return{exploits:[],loading:!0,limit:20,only_monitored:!1,search:"",options:{},selected:[],headers:[{text:"Link",value:"link"},{text:"Products",value:"vp",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}},watch:{search:Te.a.debounce((function(t){this.search=t,this.options.page=1,this.getDataFromApi()}),500),only_monitored:{handler:function(){this.getDataFromApi()},deep:!0},options:{handler:function(){this.getDataFromApi()},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.limit=r;var l=t.getExploits(o,t.limit,s,n);setTimeout((function(){e({items:l})}),300)}))},getExploits:function(t,e,a,i){var s=this,n="";a.length>0&&(n=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/exploits?limit="+e+"&page="+t+"&search="+this.search+n).then((function(t){return s.loading=!1,s.exploits=t.data,s.exploits})).catch((function(t){s.exploits=[],j.a.fire({title:"Error",text:"unable to get exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},viewVuln:function(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t}})},getVendorProduct:function(t){if(null==t)return"";var e,a,i=Array(),s=!0,n=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(s=(r=l.next()).done);s=!0)e=r.value,a=e.split(":")[4].replace(/_/g," ")+" ("+e.split(":")[3].replace(/_/g," ")+")",i.push(a)}catch(c){n=!0,o=c}finally{try{s||null==l.return||l.return()}finally{if(n)throw o}}return i=Object(Qt["a"])(new Set(i)),i.join(", ")}}},Ie=Se,Ee=Object(l["a"])(Ie,we,Ve,!1,null,null,null),Ae=Ee.exports;u()(Ee,{VBtn:I["a"],VCard:E["a"],VCardTitle:A["d"],VDataTable:bt["a"],VIcon:et["a"],VSnackbar:Wt["a"],VSpacer:B["a"],VTextField:O["a"]});var Pe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[!0===t.loading?a("div",{staticClass:"loading"},[t._v("Loading…")]):t._e(),a("v-card",[a("v-card-title",[t._v(" Vendors "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.vendors.results,options:t.options,"server-items-length":t.vendors.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"vendor","show-select":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.actions",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewProducts(i.vendor)}}})]}},{key:"item.monitored",fn:function(e){var i=e.item;return[i.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitored(i)}}},[t._v("Yes")]):t._e(),i.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitored(i)}}},[t._v("No")])]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},Le=[],$e={name:"vendors",data:function(){return{vendors:[],totalvendors:0,loading:!0,limit:20,search:"",options:{},selected:[],headers:[{text:"Vendor",value:"vendor"},{text:"Actions",value:"actions"}],rowsPerPageItems:[5,10,20,50,100]}},mounted:function(){},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi().then((function(t){}))},deep:!0},options:{handler:function(){this.getDataFromApi().then((function(t){}))},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.search.trim().toLowerCase();t.limit=r;var l=t.getvendors(o,t.limit,s,n);setTimeout((function(){t.loading=!1,e({items:l})}),300)}))},getvendors:function(t,e,a,i){var s=this;this.loading=!0;var n="";a.length>0&&(n=!0===i[0]?"sorted_by=-"+a:"sorted_by="+a),this.$api.get("/api/kb/vendors?limit="+e+"&page="+t+"&vendor__icontains="+this.search+"&"+n).then((function(t){return s.vendors=t.data,s.vendors})).catch((function(t){s.vendors=[],s.loading=!1,j.a.fire({title:"Error",text:"unable to get vendors",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},viewProducts:function(t){this.$router.push({name:"KBProductVersions",params:{vendor_name:t}})}}},De=$e,Me=Object(l["a"])(De,Pe,Le,!1,null,null,null),Be=Me.exports;u()(Me,{VBtn:I["a"],VCard:E["a"],VCardTitle:A["d"],VChip:gt["a"],VDataTable:bt["a"],VIcon:et["a"],VSnackbar:Wt["a"],VSpacer:B["a"],VTextField:O["a"]});var Oe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Products ")]),a("v-col",{staticClass:"pa-2"},[this.only_monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.toggleProductMonitored}},[t._v("Show all")]):t._e(),this.only_monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.toggleProductMonitored}},[t._v("Show monitored only")])],1),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.products.results,options:t.options,"server-items-length":t.products.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"item","show-select":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.monitored",fn:function(e){var i=e.item;return[i.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitored(i)}}},[t._v("Yes")]):t._e(),i.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitored(i)}}},[t._v("No")])]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD")))])]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},Fe=[],Ye={name:"products",data:function(){return{products:[],loading:!0,limit:20,totalproducts:0,only_monitored:!1,search:"",options:{},selected:[],headers:[{text:"Vendor",value:"vendor"},{text:"Product",value:"product"},{text:"Monitored",value:"monitored",align:"center",sortable:!1},{text:"Last update",value:"updated_at"}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}},mounted:function(){},watch:{search:Te.a.debounce((function(t){this.search=t,this.options.page=1,this.getDataFromApi()}),500),only_monitored:{handler:function(){this.getDataFromApi()},deep:!0},options:{handler:function(){this.getDataFromApi()},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.limit=r;var l=t.getProducts(o,t.limit,s,n);setTimeout((function(){e({items:l})}),300)}))},getProducts:function(t,e,a,i){var s=this,n="";a.length>0&&(n=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a);var o=this.only_monitored?"&monitored=yes":"";this.$api.get("/api/kb/products/?limit="+e+"&page="+t+"&search="+this.search+n+o).then((function(t){return s.loading=!1,s.products=t.data,s.products})).catch((function(t){s.products=[],j.a.fire({title:"Error",text:"unable to get products",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},toggleMonitored:function(t){var e=this,a={vendor:t.vendor,product:t.product,monitored:!t.monitored};this.$api.post("/api/monitor/product/toggle",a).then((function(a){e.loading=!1,a?(t.monitored=!t.monitored,e.snack=!0,e.snackColor="success",e.snackText="Monitoring status successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the monitoring status")})).catch((function(t){e.loading=!1,j.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})}))},toggleProductMonitored:function(){this.only_monitored=!this.only_monitored}}},Ne=Ye,Re=Object(l["a"])(Ne,Oe,Fe,!1,null,null,null),Ue=Re.exports;u()(Re,{VBtn:I["a"],VCard:E["a"],VCardTitle:A["d"],VChip:gt["a"],VCol:$t["a"],VContainer:P["a"],VDataTable:bt["a"],VRow:Bt["a"],VSnackbar:Wt["a"],VSpacer:B["a"],VTextField:O["a"]});var ze=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[!0===t.loading?a("div",{staticClass:"loading"},[t._v("Loading…")]):t._e(),a("v-card",[a("v-card-title",[t._v(" Product Versions for "+t._s(this.vendor_name)+" "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.products.results,options:t.options,"server-items-length":t.products.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"product","show-select":""},on:{"update:options":function(e){t.options=e}}})],1)],1)},Xe=[],He={name:"products",data:function(){return{vendor_name:"",products:[],loading:!0,limit:20,totalproducts:0,search:"",options:{},selected:[],headers:[{text:"Product",value:"product"},{text:"Version",value:"title"},{text:"Vector",value:"vector"}],rowsPerPageItems:[5,10,20,50,100]}},mounted:function(){this.vendor_name=this.$router.currentRoute.params.vendor_name,this.getDataFromApi()},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi().then((function(t){}))},deep:!0},options:{handler:function(){this.getDataFromApi().then((function(t){}))},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.search.trim().toLowerCase();t.limit=r;var l=t.getProducts(o,t.limit,s,n);setTimeout((function(){t.loading=!1,e({items:l})}),300)}))},getProducts:function(t,e,a,i){var s=this;this.loading=!0;var n="";a.length>0&&(n=!0===i[0]?"sorted_by=-"+a:"sorted_by="+a),this.$api.get("/api/kb/vendors/"+this.vendor_name+"/products?limit="+e+"&page="+t+"&product__icontains="+this.search+"&"+n).then((function(t){return s.products=t.data,s.products})).catch((function(t){s.products=[],s.loading=!1,j.a.fire({title:"Error",text:"unable to get products",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1}}},We=He,qe=Object(l["a"])(We,ze,Xe,!1,null,null,null),Je=qe.exports;u()(qe,{VCard:E["a"],VCardTitle:A["d"],VDataTable:bt["a"],VSpacer:B["a"],VTextField:O["a"]});var Ke=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",[t._v(" CVE "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.cves.results,"items-per-page":20,options:t.options,"server-items-length":t.cves.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"cve_id","show-select":"","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.summary",fn:function(e){var i=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1},scopedSlots:t._u([{key:"after",fn:function(e){var i=e.toggle,s=e.expanded,n=e.clamped;return s||n?a("button",{staticClass:"toggle btn btn-sm",on:{click:i}},[t._v(" "+t._s(" more")+" ")]):t._e()}}],null,!0)},[t._v(" "+t._s(i.summary)+" ")])]}},{key:"item.monitored",fn:function(e){var i=e.item;return[i.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitored(i)}}},[t._v("Yes")]):t._e(),i.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitored(i)}}},[t._v("No")])]}},{key:"item.modified",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.modified).format("YYYY-MM-DD")))])]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},Ge=[],Ze={name:"cves",components:{VClamp:vt["a"]},data:function(){return{cves:[],totalcves:0,loading:!0,limit:20,search:"",options:{},selected:[],headers:[{text:"CVE-ID",value:"cve_id",width:"150px"},{text:"Summary",value:"summary",sortable:!1},{text:"CVSS",value:"cvss",align:"center"},{text:"CVSS Vector",value:"cvss_vector",align:"center",sortable:!1},{text:"Monitored",value:"monitored",align:"center"},{text:"Modified",value:"modified",align:"center"}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}},mounted:function(){},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi().then((function(t){}))},deep:!0},options:{handler:function(){this.getDataFromApi().then((function(t){}))},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.search.trim().toLowerCase();t.limit=r;var l=t.getcves(o,t.limit,s,n);setTimeout((function(){e({items:l})}),300)}))},getcves:function(t,e,a,i){var s=this,n="";a.length>0&&(n=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/kb/cve?limit="+e+"&page="+t+n+"&search="+this.search).then((function(t){return s.cves=t.data,s.loading=!1,s.cves})).catch((function(t){s.cves=[],s.loading=!1,j.a.fire({title:"Error",text:"unable to get cves",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},toggleMonitored:function(t){var e=this,a={monitored:!t.monitored};this.$api.put("/api/kb/vendor/"+t.id+"/",a).then((function(a){a?(t.monitored=!t.monitored,e.snack=!0,e.snackColor="success",e.snackText="Monitoring status successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the monitoring status"),e.loading=!1})).catch((function(t){e.loading=!1,j.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))}}},Qe=Ze,ta=Object(l["a"])(Qe,Ke,Ge,!1,null,null,null),ea=ta.exports;u()(ta,{VBtn:I["a"],VCard:E["a"],VCardTitle:A["d"],VChip:gt["a"],VDataTable:bt["a"],VSnackbar:Wt["a"],VSpacer:B["a"],VTextField:O["a"]});var aa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[!0===t.loading?a("div",{staticClass:"loading"},[t._v("Loading…")]):t._e(),a("v-card",[a("v-card-title",[t._v(" Bulletins "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.bulletins.results,options:t.options,"server-items-length":t.bulletins.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"publicid","show-select":"","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.title",fn:function(e){var i=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1},scopedSlots:t._u([{key:"after",fn:function(e){var i=e.toggle,s=e.expanded,n=e.clamped;return s||n?a("button",{staticClass:"toggle btn btn-sm",on:{click:i}},[t._v(" "+t._s(" more")+" ")]):t._e()}}],null,!0)},[t._v(" "+t._s(i.title)+" ")])]}},{key:"item.monitored",fn:function(e){var i=e.item;return[i.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitored(i)}}},[t._v("Yes")]):t._e(),i.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitored(i)}}},[t._v("No")])]}},{key:"item.published",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.published).format("YYYY-MM-DD")))])]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},ia=[],sa={name:"bulletins",components:{VClamp:vt["a"]},data:function(){return{bulletins:[],totalbulletins:0,loading:!0,limit:20,search:"",options:{},selected:[],headers:[{text:"ID",value:"publicid",width:"150px"},{text:"Vendor",value:"vendor"},{text:"Title",value:"title"},{text:"Severity",value:"severity"},{text:"Monitored",value:"monitored",align:"center"},{text:"Published",value:"published"}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}},mounted:function(){},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi().then((function(t){}))},deep:!0},options:{handler:function(){this.getDataFromApi().then((function(t){}))},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.search.trim().toLowerCase();t.limit=r;var l=t.getbulletins(o,t.limit,s,n);setTimeout((function(){t.loading=!1,e({items:l})}),300)}))},getbulletins:function(t,e,a,i){var s=this;this.loading=!0;var n="";a.length>0&&(n=!0===i[0]?"sorted_by=-"+a:"sorted_by="+a),this.$api.get("/api/kb/bulletin?limit="+e+"&page="+t+"&"+n+"&search="+this.search).then((function(t){return s.bulletins=t.data,s.bulletins})).catch((function(t){s.bulletins=[],s.loading=!1,j.a.fire({title:"Error",text:"unable to get bulletins",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},toggleMonitored:function(t){var e=this,a={monitored:!t.monitored};this.$api.put("/api/kb/bulletin/"+t.id+"/",a).then((function(a){a?(t.monitored=!t.monitored,e.snack=!0,e.snackColor="success",e.snackText="Monitoring status successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the monitoring status")})).catch((function(t){e.loading=!1,j.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))}}},na=sa,oa=Object(l["a"])(na,aa,ia,!1,null,null,null),ra=oa.exports;u()(oa,{VBtn:I["a"],VCard:E["a"],VCardTitle:A["d"],VChip:gt["a"],VDataTable:bt["a"],VSnackbar:Wt["a"],VSpacer:B["a"],VTextField:O["a"]});var la=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-container",{attrs:{fluid:"","fill-height":""}},[a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("div",{staticClass:"text-md-center"},[a("h1",[t._v("404")]),a("h2",{staticClass:"my-3 headline"},[t._v("Sorry, page not found")]),a("div",[a("v-btn",{attrs:{color:"primary"},on:{click:t.goBack}},[t._v("Take me back!")]),a("v-btn",{attrs:{color:"primary"},on:{click:t.goHome}},[t._v("Go Home")])],1)])])],1)],1)},ca=[],ua={methods:{goBack:function(){this.$router.go(-1)},goHome:function(){this.$router.push({path:"/"})}}},da=ua,va=(a("3d91"),Object(l["a"])(da,la,ca,!1,null,"7cd99d3d",null)),ma=va.exports;u()(va,{VApp:d["a"],VBtn:I["a"],VContainer:P["a"],VLayout:D["a"]}),i["a"].use(y["a"]);var pa=[{path:"/auth",name:"AuthLayout",component:Y},{path:"/",component:ct,children:[{path:"homepage",name:"Homepage",component:xt},{path:"alerts",name:"Alerts",component:Tt},{path:"ratings",name:"Ratings",component:Yt},{path:"settings",name:"Settings",component:Kt},{path:"search",name:"Search",component:ie},{path:"search/:appsearch",name:"SearchData",component:ie,props:!0},{path:"/kb/products",name:"KBProducts",component:Ue},{path:"/kb/vendors",name:"KBVendors",component:Be},{path:"/kb/vendors/:vendor_name",name:"KBProductVersions",component:Je},{path:"/kb/cves",name:"KBCVE",component:ea},{path:"/kb/bulletins",name:"KBBulletins",component:ra},{path:"/vulns",name:"Vulns",component:ce},{path:"/vulns/:vuln_id",name:"VulnDetails",component:Ce},{path:"/exploits",name:"Exploits",component:Ae}]},{path:"*",component:ma}],ha=new y["a"]({base:"/",routes:pa});ha.beforeEach((function(t,e,a){null!==localStorage.getItem("authToken")||"/auth"===t.path?a():a("/auth")}));var fa=ha,_a=a("2f62"),ga=a("a7fe"),ba=a.n(ga),ya=a("04e1"),xa=a.n(ya);i["a"].use(_a["a"]),i["a"].use(ba.a,w.a);var ka=new _a["a"].Store({state:{authUser:{},isAuthenticated:!1,jwt_auth_token:localStorage.getItem("authToken"),jwt_refresh_token:localStorage.getItem("refreshToken"),endpoints:{obtainJWT:"/auth-jwt/obtain_jwt_token/",refreshJWT:"/auth-jwt/refresh_jwt_token/"}},getters:{isLoggedIn:function(t){return null!=t.jwt_auth_token}},mutations:{setAuthUser:function(t,e){var a=e.authUser,s=e.isAuthenticated;i["a"].set(t,"authUser",a),i["a"].set(t,"isAuthenticated",s)},updateToken:function(t,e){localStorage.setItem("authToken",e),t.jwt_auth_token=e},removeToken:function(t){localStorage.removeItem("authToken"),t.jwt_auth_token=null}},actions:{obtainToken:function(t,e){var a=this,i={username:t,password:e};this.$api.post(this.state.endpoints.obtainJWT,i).then((function(t){a.commit("updateToken",t.data.access)})).catch((function(t){console.log(t)}))},refreshToken:function(){var t=this,e={token:this.state.jwt_refresh_token};this.$api.post(this.state.endpoints.refreshJWT,e).then((function(e){t.commit("updateToken",e.data.access)})).catch((function(t){console.log(t)}))},inspectToken:function(){var t=this.state.jwt_auth_token;if(t){var e=xa()(t),a=e.exp,i=decode.orig_iat;a-Date.now()/1e3<1800&&Date.now()/1e3-i<628200?this.dispatch("refreshToken"):Date.now()}}},modules:{}});i["a"].filter("capitalize",(function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()+t.slice(1)):""})),i["a"].filter("truncate",(function(t,e,a){a=a||"...";var i=document.createElement("div");i.innerHTML=t;var s=i.textContent;return s.length>e?s.slice(0,e)+a:s})),w.a.interceptors.response.use((function(t){return t}),(function(t){t.response})),w.a.interceptors.request.use((function(t){return ka.state.jwt_auth_token&&(t.headers.Authorization="JWT "+ka.state.jwt_auth_token),t}),(function(t){return Promise.reject(t)})),i["a"].prototype.$api=w.a,i["a"].prototype.moment=ht.a,i["a"].config.productionTip=!1,new i["a"]({vuetify:b,router:fa,VueSession:h.a,store:ka,render:function(t){return t(m)}}).$mount("#app"),i["a"].filter("capitalize",(function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()+t.slice(1)):""})),i["a"].use(_.a)},"7e07":function(t,e,a){},8083:function(t,e,a){"use strict";var i=a("4cea"),s=a.n(i);s.a},b051:function(t,e,a){},f07e:function(t,e,a){}});
//# sourceMappingURL=app.445b660d.js.map