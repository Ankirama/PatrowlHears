(function(t){function e(e){for(var i,r,o=e[0],l=e[1],c=e[2],u=0,v=[];u<o.length;u++)r=o[u],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&v.push(n[r][0]),n[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);d&&d(e);while(v.length)v.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],i=!0,o=1;o<a.length;o++){var l=a[o];0!==n[l]&&(i=!1)}i&&(s.splice(e--,1),t=r(r.s=a[0]))}return t}var i={},n={app:0},s=[];function r(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=i,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(a,i,function(e){return t[e]}.bind(null,i));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var d=l;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"3d91":function(t,e,a){"use strict";var i=a("b051"),n=a.n(i);n.a},4678:function(t,e,a){var i={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(t){var e=s(t);return a(e)}function s(t){if(!a.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}n.keys=function(){return Object.keys(i)},n.resolve=s,t.exports=n,n.id="4678"},"56d7":function(t,e,a){"use strict";a.r(e);a("d3b7"),a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("router-view")],1)},s=[],r={name:"App",data:function(){return{section:"AppLayout"}},created:function(){document.title="PatrowlHears"},methods:{logout:function(){this.$store.commit("removeToken"),this.$router.push("/auth")}}},o=r,l=a("2877"),c=a("6544"),d=a.n(c),u=a("7496"),v=Object(l["a"])(o,n,s,!1,null,null,null),m=v.exports;d()(v,{VApp:u["a"]});var h=a("0628"),p=a.n(h),f=a("df76"),g=a.n(f),b=a("f309");i["a"].use(b["a"]);var _=new b["a"]({}),x=a("8c4f"),k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:"","align-center":"","justify-center":"","fill-height":""}},[a("v-flex",{attrs:{xs12:"",sm8:"",lg4:"",md5:""}},[a("v-card",{staticClass:"login-card"},[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Login to PatrowlHears")])]),a("v-spacer"),a("v-card-text",[t.loading?a("v-layout",{attrs:{row:"","fill-height":"","justify-center":"","align-center":""}},[a("v-progress-circular",{attrs:{size:50,color:"primary",indeterminate:""}})],1):a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-container",[a("v-text-field",{attrs:{counter:70,label:"username",maxlength:"70",required:""},model:{value:t.credentials.username,callback:function(e){t.$set(t.credentials,"username",e)},expression:"credentials.username"}}),a("v-text-field",{attrs:{type:"password",counter:20,label:"password",rules:t.rules.password,maxlength:"20",required:""},model:{value:t.credentials.password,callback:function(e){t.$set(t.credentials,"password",e)},expression:"credentials.password"}})],1),a("v-btn",{staticClass:"pink white--text",attrs:{disabled:!t.valid},on:{click:t.login}},[t._v("Login")])],1)],1)],1)],1)],1)],1)},y=[],w=a("bc3a"),j=a.n(w),C=a("3d20"),V=a.n(C),T={name:"AuthLayout",data:function(){return{credentials:{},valid:!0,loading:!1,rules:{username:[function(t){return!!t||"Username is required"},function(t){return t&&t.length>3||"A username must be more than 3 characters long"},function(t){return/^[a-z0-9_]+$/.test(t)||"A username can only contain letters and digits"}],password:[function(t){return!!t||"Password is required"},function(t){return t&&t.length>7||"The password must be longer than 7 characters"}]}}},methods:{login:function(){var t=this;this.$refs.form.validate()&&(this.loading=!0,this.$store.commit("removeToken"),this.$api.post(this.$store.state.endpoints.obtainJWT,this.credentials).then((function(e){t.$store.commit("updateToken",e.data.access),t.$api.get("/users/api/current").then((function(e){t.$store.commit("setAuthUser",{authUser:e.data,isAuthenticated:!0}),t.$router.push({name:"Homepage"})}))})).catch((function(e){t.$store.commit("removeToken"),t.loading=!1,V.a.fire({title:"Error",text:"Wrong username or password",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})))}}},I=T,S=a("8336"),P=a("b0af"),$=a("99d9"),E=a("a523"),B=a("0e8f"),A=a("4bd4"),D=a("a722"),L=a("490a"),O=a("2fa4"),z=a("8654"),F=Object(l["a"])(I,k,y,!1,null,null,null),M=F.exports;d()(F,{VBtn:S["a"],VCard:P["a"],VCardText:$["b"],VCardTitle:$["c"],VContainer:E["a"],VFlex:B["a"],VForm:A["a"],VLayout:D["a"],VProgressCircular:L["a"],VSpacer:O["a"],VTextField:z["a"]});var N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:"","align-center":"","justify-center":"","fill-height":""}},[a("v-flex",{attrs:{xs12:"",sm8:"",lg4:"",md5:""}},[a("v-card",{staticClass:"login-card"},[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Login to PatrowlHears")])]),a("v-spacer"),a("v-card-text",[t.loading?a("v-layout",{attrs:{row:"","fill-height":"","justify-center":"","align-center":""}},[a("v-progress-circular",{attrs:{size:50,color:"primary",indeterminate:""}})],1):a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-container",[a("v-text-field",{attrs:{counter:70,label:"username",maxlength:"70",required:""},model:{value:t.credentials.username,callback:function(e){t.$set(t.credentials,"username",e)},expression:"credentials.username"}}),a("v-text-field",{attrs:{type:"password",counter:20,label:"password",rules:t.rules.password,maxlength:"20",required:""},model:{value:t.credentials.password,callback:function(e){t.$set(t.credentials,"password",e)},expression:"credentials.password"}})],1),a("v-btn",{staticClass:"pink white--text",attrs:{disabled:!t.valid},on:{click:t.login}},[t._v("Login")])],1)],1)],1)],1)],1)],1)},U=[],Y={name:"UserAuth",data:function(){return{credentials:{},valid:!0,loading:!1,rules:{username:[function(t){return!!t||"Username is required"},function(t){return t&&t.length>3||"A username must be more than 3 characters long"},function(t){return/^[a-z0-9_]+$/.test(t)||"A username can only contain letters and digits"}],password:[function(t){return!!t||"Password is required"},function(t){return t&&t.length>7||"The password must be longer than 7 characters"}]}}},methods:{login:function(){var t=this;this.$refs.form.validate()&&(this.loading=!0,j.a.post("http://localhost:8000/auth-jwt/obtain_jwt_token/",this.credentials).then((function(e){t.$session.start(),t.$session.set("token",e.data.token),localStorage.setItem("authToken",e.data.token),localStorage.setItem("username",t.credentials.username),ke.push("/")})).catch((function(e){console.log(e),t.loading=!1,V.a.fire({title:"Error",text:"Wrong username or password",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})))}}},R=Y,H=Object(l["a"])(R,N,U,!1,null,null,null);H.exports;d()(H,{VBtn:S["a"],VCard:P["a"],VCardText:$["b"],VCardTitle:$["c"],VContainer:E["a"],VFlex:B["a"],VForm:A["a"],VLayout:D["a"],VProgressCircular:L["a"],VSpacer:O["a"],VTextField:z["a"]});var J=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-navigation-drawer",{attrs:{clipped:"",app:"",color:"grey lighten-4"},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("v-list",{staticClass:"grey lighten-4",attrs:{dense:""}},[t._l(t.menu_items,(function(e,i){return[e.submenu?a("v-list-group",{attrs:{"no-action":"","prepend-icon":e.icon},scopedSlots:t._u([{key:"activator",fn:function(){return[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.text)}})],1)]},proxy:!0}],null,!0)},t._l(e.submenu,(function(e,i){return a("v-list-item",{key:i,attrs:{to:e.to}},[a("v-list-item-content",[a("v-list-item-title",{attrs:{link:"",to:e.to},domProps:{textContent:t._s(e.text)}})],1)],1)})),1):e.divider?a("v-divider",{key:i}):a("v-list-item",{key:i,attrs:{link:"",to:e.to}},[a("v-list-item-action",[a("v-icon",[t._v(t._s(e.icon))])],1),a("v-list-item-content",[a("v-list-item-title",{staticClass:"grey-darken-3--text"},[t._v(" "+t._s(e.text)+" ")])],1)],1)]}))],2)],1),a("v-app-bar",{attrs:{app:"","clipped-left":"",color:"light-blue accent-4",dense:""}},[a("v-app-bar-nav-icon",{on:{click:function(e){t.drawer=!t.drawer}}}),a("span",{staticClass:"title ml-3 mr-5"},[t._v("Patrowl "),a("span",{staticClass:"font-weight-light"},[t._v("Hears")])]),a("v-text-field",{attrs:{"solo-inverted":"",flat:"","hide-details":"",label:"Search","prepend-inner-icon":"mdi-magnify",dense:""}}),a("v-spacer"),a("v-btn",{attrs:{icon:""}},[a("v-icon",[t._v("mdi-bell")])],1),t._v(" "+t._s(t.username)+" "),a("v-btn",{attrs:{icon:""},on:{click:t.logout}},[a("v-icon",[t._v("mdi-logout")])],1)],1),a("v-content",[a("v-container",{attrs:{fluid:""}},[a("router-view")],1)],1),a("v-footer",{attrs:{app:""}})],1)},W=[],q={name:"AppLayout",data:function(){return{drawer:null,menu_items:[{icon:"mdi-bookmark",text:"KB",to:"",submenu:[{icon:"mdi-bookmark",text:"Vendors & Products",to:"/kb/vendors"},{icon:"mdi-bookmark",text:"CVE",to:"/kb/cves"},{icon:"mdi-bookmark",text:"Bulletins",to:"/kb/bulletins"}]},{divider:!0},{icon:"mdi-file-find",text:"Vulnerabilities",to:"/vulns"},{icon:"mdi-security",text:"Ratings",to:"/ratings"},{icon:"mdi-cctv",text:"Monitoring",to:"/monitoring"},{icon:"mdi-alert",text:"Alerts",to:"/alerts"},{icon:"mdi-file-chart",text:"Reports",to:"/reports"},{divider:!0},{icon:"mdi-settings",text:"Settings"},{icon:"mdi-help-circle",text:"Help"}],username:""}},computed:{isAuthenticated:function(){return this.$store.getters.isAuthenticated}},mounted:function(){this.getUsername()},methods:{logout:function(){localStorage.removeItem("authToken"),localStorage.removeItem("username"),this.$router.push("/auth")},getUsername:function(){this.username=this.$store.state.authUser.username}}},K=q,G=a("40dc"),Q=a("5bc1"),X=a("a75b"),Z=a("ce7e"),tt=a("553a"),et=a("132d"),at=a("8860"),it=a("56b0"),nt=a("da13"),st=a("1800"),rt=a("5d23"),ot=a("f774"),lt=Object(l["a"])(K,J,W,!1,null,null,null),ct=lt.exports;d()(lt,{VApp:u["a"],VAppBar:G["a"],VAppBarNavIcon:Q["a"],VBtn:S["a"],VContainer:E["a"],VContent:X["a"],VDivider:Z["a"],VFooter:tt["a"],VIcon:et["a"],VList:at["a"],VListGroup:it["a"],VListItem:nt["a"],VListItemAction:st["a"],VListItemContent:rt["a"],VListItemTitle:rt["c"],VNavigationDrawer:ot["a"],VSpacer:O["a"],VTextField:z["a"]});var dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v(" Homepage ")])},ut=[],vt={name:"Home",mounted:function(){},methods:{}},mt=vt,ht=Object(l["a"])(mt,dt,ut,!1,null,null,null),pt=ht.exports,ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[!0===t.loading?a("div",{staticClass:"loading"},[t._v("Loading…")]):t._e(),a("v-card",[a("v-card-title",[t._v(" Vulnerabilities "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.vulns.results,options:t.options,"server-items-length":t.vulns.count,search:t.search,"items-per-page":20,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id","show-select":"","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.summary",fn:function(e){var i=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1},scopedSlots:t._u([{key:"after",fn:function(e){var i=e.toggle,n=e.expanded,s=e.clamped;return n||s?a("button",{staticClass:"toggle btn btn-sm",on:{click:i}},[t._v(" "+t._s(" more")+" ")]):t._e()}}],null,!0)},[t._v(" "+t._s(i.summary)+" ")])]}},{key:"item.rating",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"text-center",attrs:{color:t.getRatingColor(i.rating),small:""}},[t._v(" "+t._s(i.rating)+" ")])]}},{key:"item.is_exploitable",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"text-center",attrs:{color:t.getBool(i.is_exploitable),small:"",label:""}})]}},{key:"item.is_confirmed",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"text-center",attrs:{color:t.getBool(i.is_confirmed),small:"",label:""}})]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD, hh:mm:ss")))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewVuln(i.id)}}}),a("v-icon",{staticClass:"mdi mdi-pencil",attrs:{small:"",color:"orange"},on:{click:function(e){return t.editVuln(i)}}}),a("v-icon",{staticClass:"mdi mdi-delete",attrs:{small:"",color:"red"},on:{click:function(e){return t.deleteVuln(i)}}})]}}])})],1)],1)},gt=[],bt=(a("ac1f"),a("841c"),a("498a"),a("3f87")),_t={name:"vulns",components:{VClamp:bt["a"]},data:function(){return{vulns:[],totalvulns:0,loading:!0,limit:20,search:"",options:{},selected:[],headers:[{text:"PHID",value:"id"},{text:"CVE",value:"cve",width:"150px"},{text:"Summary",value:"summary"},{text:"CVSSv2",value:"cvss",align:"center"},{text:"Score",value:"rating",align:"center"},{text:"Exploits",value:"exploit_count",align:"center"},{text:"Confirm ?",value:"is_confirmed",align:"center"},{text:"Last update",value:"updated_at",align:"center"},{text:"Actions",value:"action",sortable:!1}],rowsPerPageItems:[5,10,20,50,100]}},mounted:function(){},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi().then((function(t){}))},deep:!0},options:{handler:function(){this.getDataFromApi().then((function(t){}))},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,n=i.sortBy,s=i.sortDesc,r=i.page,o=i.itemsPerPage;t.search.trim().toLowerCase();t.limit=o;var l=t.getvulns(r,t.limit,n,s);setTimeout((function(){t.loading=!1,e({items:l})}),300)}))},getvulns:function(t,e,a,i){var n=this;this.loading=!0;var s="";a.length>0&&(s=!0===i[0]?"sorted_by=-"+a:"sorted_by="+a),this.$api.get("/api/vulns/?limit="+e+"&page="+t+"&search="+this.search+"&"+s).then((function(t){return n.vulns=t.data,n.vulns})).catch((function(t){n.vulns=[],n.loading=!1,V.a.fire({title:"Error",text:"unable to get vulns",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},viewVuln:function(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t}})},editVuln:function(t){},deleteVuln:function(t){},clickRow:function(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t.id}})},getColor:function(t){return"info"==t?"blue":"low"==t?"yellow":"medium"==t?"orange":"high"==t?"red":"grey"},getRatingColor:function(t){return t>=80?"red":t>=60?"orange":t>=40?"yellow":t>=0?"blue":"grey"},getBool:function(t){return 1==t?"red":"grey"}}},xt=_t,kt=a("cc20"),yt=a("8fea"),wt=Object(l["a"])(xt,ft,gt,!1,null,null,null),jt=wt.exports;d()(wt,{VCard:P["a"],VCardTitle:$["c"],VChip:kt["a"],VDataTable:yt["a"],VIcon:et["a"],VSpacer:O["a"],VTextField:z["a"]});var Ct=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("Summary")]),a("v-tab",[this.exploits.length>0?a("v-badge",{attrs:{color:"deep-orange",content:this.exploits.length}},[t._v("Exploits")]):t._e(),0==this.exploits.length?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Exploits")]):t._e()],1),a("v-tab",[this.threats.length>0?a("v-badge",{attrs:{color:"deep-orange",content:this.threats.length}},[t._v("Threat activities")]):t._e(),0==this.threats.length?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Threat activities")]):t._e()],1),a("v-tab",[t._v("Timeline")]),a("v-tab-item",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md8:""}},[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v("Vuln ID: PH-"+t._s(t.$route.params.vuln_id))]),a("v-card-text",[a("v-list",{attrs:{subheader:"",color:"grey lighten-5"}},[a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("CVE")]),t._v(" "+t._s(this.vuln.cve)+" ")],1)],1),a("v-list-item",[a("v-list-item-content",{staticClass:"d-inline"},[a("v-list-item-subtitle",[t._v("CVSSv2")]),a("v-chip",{attrs:{small:"",label:"",color:t.getCVSSColor(this.vuln.cvss)}},[t._v(" "+t._s(this.vuln.cvss)+" ")]),t._v(" - "+t._s(this.vuln.cvss_vector)+" ("+t._s(t.moment(this.vuln.cvss_time).format("YYYY-MM-DD"))+") ")],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Summary")]),t._v(" "+t._s(this.vuln.summary)+" ")],1)],1),""!=this.vuln.cwe_id?a("v-list-item",{attrs:{href:"https://cwe.mitre.org/data/definitions/"+this.vuln.cwe_id+".html"}},[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("CWE")]),t._v(" CWE-"+t._s(this.vuln.cwe_id)+" ")],1)],1):t._e(),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Links")]),a("ul",{attrs:{id:"v-for-reflinks"}},t._l(this.vuln.reflinks,(function(e){return a("li",{attrs:{link:""}},[a("a",{attrs:{href:e}},[t._v(" "+t._s(e)+" ")])])})),0)],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Vulnerable products (CPE)")]),a("ul",{attrs:{id:"v-for-cpe"}},t._l(this.vuln.vulnerable_products,(function(e){return a("li",[t._v(" "+t._s(e)+" ")])})),0)],1)],1)],1)],1)],1)],1),a("v-flex",{attrs:{md4:""}},[a("v-flex",[this.ratings.score>=0?a("v-card",{attrs:{color:t.getRatingColor(t.vprating)}},[a("v-card-title",{staticClass:"title"},[t._v("Rating Scores")]),a("v-card-text",[a("v-row",{attrs:{align:"center"}},[a("v-col",{staticClass:"display-3",attrs:{cols:"4",align:"center"}},[t._v(" "+t._s(t.vprating)+" ")]),a("v-col",{attrs:{cols:"6"}},[t._v(" CVSSv2 Base: "+t._s(t.cvssv2adj[0])+" CVSSv2 Temporal: "+t._s(t.cvssv2adj[1])+" ")])],1)],1)],1):t._e()],1),a("v-flex",[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v("Metrics")]),a("v-card-text",[a("v-switch",{attrs:{color:"red",readonly:"","hide-details":"",label:"Exploitable"},model:{value:t.is_exploitable,callback:function(e){t.is_exploitable=e},expression:"is_exploitable"}}),a("v-switch",{attrs:{color:"red",readonly:"","hide-details":"",label:"Confirmed"},model:{value:t.is_confirmed,callback:function(e){t.is_confirmed=e},expression:"is_confirmed"}}),a("v-switch",{attrs:{color:"red",readonly:"","hide-details":"",label:"In the News"},model:{value:t.is_in_the_news,callback:function(e){t.is_in_the_news=e},expression:"is_in_the_news"}}),a("v-switch",{attrs:{color:"red",readonly:"","hide-details":"",label:"In the Wild"},model:{value:t.is_in_the_wild,callback:function(e){t.is_in_the_wild=e},expression:"is_in_the_wild"}})],1)],1)],1),a("v-flex",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-card",{attrs:{color:"grey lighten-5",height:"100%"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v("Impact")]),a("v-card-text",[t._v(" Confidentiality: "+t._s(this.vuln.impact.confidentiality)),a("br"),t._v(" Integrity: "+t._s(this.vuln.impact.integrity)),a("br"),t._v(" Availability: "+t._s(this.vuln.impact.availability)),a("br")])],1)],1),a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-card",{attrs:{color:"grey lighten-5",height:"100%"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v("Access")]),a("v-card-text",[t._v(" Authentication: "+t._s(this.vuln.access.authentication)),a("br"),t._v(" Complexity: "+t._s(this.vuln.access.complexity)),a("br"),t._v(" Vector: "+t._s(this.vuln.access.vector)),a("br")])],1)],1)],1)],1)],1)],1)],1)],1),a("v-tab-item",[a("v-card",[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.exploit_headers,items:t.exploits,"item-key":"id","multi-sort":"","show-expand":"",expanded:t.expanded},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"item.link",fn:function(e){var i=e.item;return[a("a",{attrs:{href:i.link}},[t._v(t._s(i.link))])]}},{key:"item.trust_level",fn:function(e){var a=e.item;return[t._v(" "+t._s(t._f("capitalize")(a.trust_level))+" ")]}},{key:"item.tlp_level",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",small:"",color:t.getTLPColor(i.tlp_level)}},[t._v(" TLP:"+t._s(t._f("capitalize")(i.tlp_level))+" ")])]}},{key:"item.modified",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.modified).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-pencil",attrs:{small:"",color:"orange"},on:{click:function(e){return t.editExploit(i)}}}),a("v-icon",{staticClass:"mdi mdi-delete",attrs:{small:"",color:"red"},on:{click:function(e){return t.deleteExploit(i)}}})]}},{key:"expanded-item",fn:function(e){var i=e.headers,n=e.item;return[a("td",{attrs:{colspan:i.length}},[t._v(t._s(n.notes))])]}}])}),a("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-btn",t._g({attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"}},i),[a("v-icon",[t._v("mdi-plus")])],1)]}}]),model:{value:t.dialog_exploit,callback:function(e){t.dialog_exploit=e},expression:"dialog_exploit"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v(t._s(t.formExploitTitle))])]),a("v-card-text",[a("v-container",[a("v-form",{ref:"form-new-exploit"},[a("v-text-field",{attrs:{label:"link"},model:{value:t.editedItem.link,callback:function(e){t.$set(t.editedItem,"link",e)},expression:"editedItem.link"}}),a("v-select",{attrs:{label:"TLP Level",items:t.editedItem.tlp_level_items},model:{value:t.editedItem.tlp_level,callback:function(e){t.$set(t.editedItem,"tlp_level",e)},expression:"editedItem.tlp_level"}}),a("v-text-field",{attrs:{label:"Source"},model:{value:t.editedItem.source,callback:function(e){t.$set(t.editedItem,"source",e)},expression:"editedItem.source"}}),a("v-select",{attrs:{label:"Availability",items:t.editedItem.availability_items},model:{value:t.editedItem.availability,callback:function(e){t.$set(t.editedItem,"availability",e)},expression:"editedItem.availability"}}),a("v-select",{attrs:{label:"Maturity",items:t.editedItem.maturity_items},model:{value:t.editedItem.maturity,callback:function(e){t.$set(t.editedItem,"maturity",e)},expression:"editedItem.maturity"}}),a("v-text-field",{attrs:{label:"Notes"},model:{value:t.editedItem.notes,callback:function(e){t.$set(t.editedItem,"notes",e)},expression:"editedItem.notes"}}),a("v-btn",{attrs:{color:"success"},on:{click:t.saveNewExploit}},[t._v("Save")]),a("v-btn",{attrs:{color:"warning",type:"reset"}},[t._v("Reset")])],1)],1)],1),a("v-card-actions",[a("v-spacer")],1)],1)],1)],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1),a("v-tab-item",[a("v-card",[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.threat_headers,items:t.threats,"item-key":"id","multi-sort":"","show-expand":"",expanded:t.expanded},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"item.link",fn:function(e){var i=e.item;return[a("a",{attrs:{href:i.link}},[t._v(t._s(i.link))])]}},{key:"item.trust_level",fn:function(e){var a=e.item;return[t._v(" "+t._s(t._f("capitalize")(a.trust_level))+" ")]}},{key:"item.tlp_level",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",small:"",color:t.getTLPColor(i.tlp_level)}},[t._v(" TLP:"+t._s(t._f("capitalize")(i.tlp_level))+" ")])]}},{key:"item.modified",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.modified).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-pencil",attrs:{small:"",color:"orange"},on:{click:function(e){return t.editThreat(i)}}}),a("v-icon",{staticClass:"mdi mdi-delete",attrs:{small:"",color:"red"},on:{click:function(e){return t.deleteThreat(i)}}})]}},{key:"expanded-item",fn:function(e){var i=e.headers,n=e.item;return[a("td",{attrs:{colspan:i.length}},[t._v(t._s(n.notes))])]}}])}),a("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-btn",t._g({attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"}},i),[a("v-icon",[t._v("mdi-plus")])],1)]}}]),model:{value:t.dialog_threat,callback:function(e){t.dialog_threat=e},expression:"dialog_threat"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v(t._s(t.formThreatTitle))])]),a("v-card-text",[a("v-container",[a("v-form",{ref:"form-new-exploit"},[a("v-text-field",{attrs:{label:"link"},model:{value:t.editedItem.link,callback:function(e){t.$set(t.editedItem,"link",e)},expression:"editedItem.link"}}),a("v-select",{attrs:{label:"TLP Level",items:t.editedItem.tlp_level_items},model:{value:t.editedItem.tlp_level,callback:function(e){t.$set(t.editedItem,"tlp_level",e)},expression:"editedItem.tlp_level"}}),a("v-text-field",{attrs:{label:"Source"},model:{value:t.editedItem.source,callback:function(e){t.$set(t.editedItem,"source",e)},expression:"editedItem.source"}}),a("v-select",{attrs:{label:"Availability",items:t.editedItem.availability_items},model:{value:t.editedItem.availability,callback:function(e){t.$set(t.editedItem,"availability",e)},expression:"editedItem.availability"}}),a("v-select",{attrs:{label:"Maturity",items:t.editedItem.maturity_items},model:{value:t.editedItem.maturity,callback:function(e){t.$set(t.editedItem,"maturity",e)},expression:"editedItem.maturity"}}),a("v-text-field",{attrs:{label:"Notes"},model:{value:t.editedItem.notes,callback:function(e){t.$set(t.editedItem,"notes",e)},expression:"editedItem.notes"}}),a("v-btn",{attrs:{color:"success"},on:{click:t.saveNewThreat}},[t._v(" Save ")])],1)],1)],1),a("v-card-actions",[a("v-spacer")],1)],1)],1)],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1),a("v-tab-item",[this.history?a("v-card",[this.history.length>0?a("v-timeline",{attrs:{clipped:"",dense:""}},t._l(this.history,(function(e){return a("v-timeline-item",{key:e.date,attrs:{color:"blue",small:"","fill-dot":""}},[a("v-card",{staticClass:"elevation-2"},[a("v-card-title",{staticClass:"headline"},[t._v(t._s(e.reason)+" at '"+t._s(e.date)+"'")]),a("v-card-text",t._l(e.changes,(function(e){return a("span",{key:e},[t._v(t._s(e)),a("br")])})),0)],1)],1)})),1):t._e()],1):t._e()],1)],1)},Vt=[],Tt=(a("c975"),a("a434"),{name:"VulnDetails",data:function(){return{expanded:[],vuln_id:"",vuln:{cwe_id:"",impact:{confidentiality:"",integrity:"",availability:""},access:{authentication:"",complexity:"",vector:""}},ratings:{},history:{},threats:{},threat_headers:[{text:"Link",value:"link"},{text:"Trust level",value:"trust_level"},{text:"TLP",value:"tlp_level",align:"center"},{text:"Source",value:"source",align:"center"},{text:"In the Wild ?",value:"is_in_the_wild",align:"center"},{text:"In the News ?",value:"is_in_the_news",align:"center"},{text:"Last update",value:"modified",align:"center"},{text:"Actions",value:"action",sortable:!1},{text:"",value:"data-table-expand"}],exploits:[],exploit_headers:[{text:"Link",value:"link"},{text:"Trust level",value:"trust_level"},{text:"TLP",value:"tlp_level",align:"center"},{text:"Source",value:"source",align:"center"},{text:"Availability",value:"availability",align:"center"},{text:"Maturity",value:"maturity",align:"center"},{text:"Last update",value:"modified",align:"center"},{text:"Actions",value:"action",sortable:!1},{text:"",value:"data-table-expand"}],editedIndex:-1,defaultMetadata:{link:"https://",notes:"",trust_level:"trusted",trust_level_items:["unknown","low","medium","trusted"],tlp_level:"white",tlp_level_items:["white","green","amber","red","black"],source:"manual",availability:"unknown",availability_items:["unknown","private","public"],maturity:"unknown",maturity_items:["unknown","unproven","poc","functional"],modified:"",is_in_the_wild:0,is_in_the_news:0,published:""},editedItem:{},dialog_exploit:!1,dialog_threat:!1,snack:!1,snackColor:"",snackText:""}},mounted:function(){this.vuln_id=this.$router.currentRoute.params.vuln_id,this.editedItem=this.defaultMetadata,this.getDataFromApi(this.vuln_id)},computed:{formExploitTitle:function(){return-1===this.editedIndex?"New Exploit":"Edit Exploit"},formThreatTitle:function(){return-1===this.editedIndex?"New threat activity":"Edit threat activity"},is_exploitable:function(){return this.vuln.is_exploitable},is_confirmed:function(){return this.vuln.is_confirmed},is_in_the_news:function(){return this.vuln.is_in_the_news},is_in_the_wild:function(){return this.vuln.is_in_the_wild},vprating:function(){return this.ratings.score},cvssv2adj:function(){return this.ratings.cvssv2adj}},methods:{getDataFromApi:function(t){var e=this;return new Promise((function(a,i){var n=e.getVulnDetails(t),s=e.getHistory(t),r=e.getRatings(t),o=e.getExploits(t),l=e.getThreats(t);setTimeout((function(){e.loading=!1,a({vuln:n,history:s,ratings:r,exploits:o,threats:l})}),300)}))},getVulnDetails:function(t){var e=this;this.loading=!0,this.$api.get("/api/vulns/"+t).then((function(t){return e.vuln=t.data,e.vuln})).catch((function(t){e.vuln={},e.loading=!1,V.a.fire({title:"Error",text:"unable to get vuln details",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getRatings:function(t){var e=this;this.loading=!0,this.$api.get("/api/ratings/calc/"+t).then((function(t){return e.ratings=t.data,e.vuln})).catch((function(t){e.ratings={},e.loading=!1,V.a.fire({title:"Error",text:"unable to get vuln ratings",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getExploits:function(t){var e=this;this.loading=!0,this.$api.get("/api/vulns/"+t+"/exploits").then((function(t){return e.exploits=t.data,e.exploits})).catch((function(t){e.exploits={},e.loading=!1,V.a.fire({title:"Error",text:"unable to get related exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getThreats:function(t){var e=this;this.loading=!0,this.$api.get("/api/vulns/"+t+"/threats").then((function(t){return e.threats=t.data,e.threats})).catch((function(t){e.threats={},e.loading=!1,V.a.fire({title:"Error",text:"unable to get related threats",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getHistory:function(t){var e=this;this.loading=!0,this.$api.get("/api/vulns/"+t+"/history").then((function(t){return e.history=t.data,e.threats})).catch((function(t){e.history={},e.loading=!1,V.a.fire({title:"Error",text:"unable to get vuln history",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getCVSSColor:function(t){return t>=9?"red darken-4":t>=7?"red":t>=4?"orange":t>=.1?"yellow":"grey"},getTLPColor:function(t){return"white"===t?"":"green"===t?"green":"amber"===t?"orange":"red"===t?"red":"black"===t?"black":"grey"},getRatingColor:function(t){return t>=80?"red":t>=60?"orange":t>=40?"yellow":t>=0?"blue":"grey"},saveNewExploit:function(){var t=this;this.editedItem.modified=new Date,this.$api.post("/api/vulns/"+this.vuln_id+"/exploits/add",this.editedItem).then((function(e){e&&200===e.status?(t.snack=!0,t.snackColor="success",t.snackText="Exploit successfuly saved."):(t.snack=!0,t.snackColor="error",t.snackText="Unable to save the exploit metadata.")})).catch((function(e){t.loading=!1,V.a.fire({title:"Error",text:"unable to save related exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),t.dialog_exploit=!1,t.editedItem=t.defaultMetadata}));var e=JSON.parse(JSON.stringify(this.editedItem));this.editedIndex>-1?Object.assign(this.exploits[this.editedIndex],e):(console.log("push"),this.exploits.push(e)),this.editedItem=JSON.parse(JSON.stringify(this.defaultMetadata)),this.dialog_exploit=!1},editExploit:function(t){this.editedIndex=this.exploits.indexOf(t),this.editedItem=Object.assign({},t),this.dialog_exploit=!0,this.snack=!0,this.snackColor="success",this.snackText="Exploit successfuly edited."},deleteExploit:function(t){var e=this;this.$api.get("/api/vulns/"+this.vuln_id+"/exploits/"+t.id+"/del").then((function(t){t?(e.snack=!0,e.snackColor="success",e.snackText="Exploit successfuly deleted."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to delete the exploit")})).catch((function(t){e.loading=!1,V.a.fire({title:"Error",text:"unable to delete related exploit",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),e.dialog_exploit=!1})),this.editedIndex=this.exploits.indexOf(t),this.exploits.splice(this.editedIndex,1)},saveNewThreat:function(){var t=this;this.editedItem.modified=new Date,this.$api.post("/api/vulns/"+this.vuln_id+"/threats/add",this.editedItem).then((function(e){e&&200===e.status?(t.snack=!0,t.snackColor="success",t.snackText="Threat activity successfuly saved."):(t.snack=!0,t.snackColor="error",t.snackText="Unable to save the threat activity.")})).catch((function(e){t.loading=!1,V.a.fire({title:"Error",text:"unable to save related threat activity",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),t.dialog_threat=!1}));var e=JSON.parse(JSON.stringify(this.editedItem));this.editedIndex>-1?Object.assign(this.threats[this.editedIndex],e):this.threats.push(e),this.editedItem=JSON.parse(JSON.stringify(this.defaultMetadata)),this.dialog_threat=!1},editThreat:function(t){this.editedIndex=this.threats.indexOf(t),this.editedItem=Object.assign({},t),this.dialog_threat=!0,this.snack=!0,this.snackColor="success",this.snackText="Threat activity successfuly edited."},deleteThreat:function(t){var e=this;this.$api.get("/api/vulns/"+this.vuln_id+"/threats/"+t.id+"/del").then((function(t){t?(e.snack=!0,e.snackColor="success",e.snackText="Threat activity successfuly deleted."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to delete the threat activity")})).catch((function(t){e.loading=!1,V.a.fire({title:"Error",text:"unable to delete related threat activity",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),e.dialog_threat=!1})),this.editedIndex=this.threats.indexOf(t),this.threats.splice(this.editedIndex,1)}}}),It=Tt,St=a("4ca6"),Pt=a("62ad"),$t=a("169a"),Et=a("0fd9"),Bt=a("b974"),At=a("2db4"),Dt=a("b73d"),Lt=a("71a3"),Ot=a("c671"),zt=a("fe57"),Ft=a("8414"),Mt=a("1e06"),Nt=Object(l["a"])(It,Ct,Vt,!1,null,null,null),Ut=Nt.exports;d()(Nt,{VBadge:St["a"],VBtn:S["a"],VCard:P["a"],VCardActions:$["a"],VCardText:$["b"],VCardTitle:$["c"],VChip:kt["a"],VCol:Pt["a"],VContainer:E["a"],VDataTable:yt["a"],VDialog:$t["a"],VFlex:B["a"],VForm:A["a"],VIcon:et["a"],VLayout:D["a"],VList:at["a"],VListItem:nt["a"],VListItemContent:rt["a"],VListItemSubtitle:rt["b"],VRow:Et["a"],VSelect:Bt["a"],VSnackbar:At["a"],VSpacer:O["a"],VSwitch:Dt["a"],VTab:Lt["a"],VTabItem:Ot["a"],VTabs:zt["a"],VTextField:z["a"],VTimeline:Ft["a"],VTimelineItem:Mt["a"]});var Yt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[!0===t.loading?a("div",{staticClass:"loading"},[t._v("Loading…")]):t._e(),a("v-card",[a("v-card-title",[t._v(" Vendors "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.vendors.results,options:t.options,"server-items-length":t.vendors.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"vendor","show-select":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.actions",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewProducts(i.vendor)}}})]}}])})],1)],1)},Rt=[],Ht={name:"vendors",data:function(){return{vendors:[],totalvendors:0,loading:!0,limit:20,search:"",options:{},selected:[],headers:[{text:"Vendor",value:"vendor"},{text:"Actions",value:"actions"}],rowsPerPageItems:[5,10,20,50,100]}},mounted:function(){},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi().then((function(t){}))},deep:!0},options:{handler:function(){this.getDataFromApi().then((function(t){}))},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,n=i.sortBy,s=i.sortDesc,r=i.page,o=i.itemsPerPage;t.search.trim().toLowerCase();t.limit=o;var l=t.getvendors(r,t.limit,n,s);setTimeout((function(){t.loading=!1,e({items:l})}),300)}))},getvendors:function(t,e,a,i){var n=this;this.loading=!0;var s="";a.length>0&&(s=!0===i[0]?"sorted_by=-"+a:"sorted_by="+a),this.$api.get("/api/kb/vendors?limit="+e+"&page="+t+"&vendor__icontains="+this.search+"&"+s).then((function(t){return n.vendors=t.data,n.vendors})).catch((function(t){n.vendors=[],n.loading=!1,V.a.fire({title:"Error",text:"unable to get vendors",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},viewProducts:function(t){this.$router.push({name:"KBProducts",params:{vendor_name:t}})}}},Jt=Ht,Wt=Object(l["a"])(Jt,Yt,Rt,!1,null,null,null),qt=Wt.exports;d()(Wt,{VCard:P["a"],VCardTitle:$["c"],VDataTable:yt["a"],VIcon:et["a"],VSpacer:O["a"],VTextField:z["a"]});var Kt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[!0===t.loading?a("div",{staticClass:"loading"},[t._v("Loading…")]):t._e(),a("v-card",[a("v-card-title",[t._v(" Products for "+t._s(this.vendor_name)+" "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.products.results,options:t.options,"server-items-length":t.products.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"product","show-select":""},on:{"update:options":function(e){t.options=e}}})],1)],1)},Gt=[],Qt={name:"products",data:function(){return{vendor_name:"",products:[],loading:!0,limit:20,totalproducts:0,search:"",options:{},selected:[],headers:[{text:"Product",value:"product"},{text:"Title (version)",value:"title"}],rowsPerPageItems:[5,10,20,50,100]}},mounted:function(){this.vendor_name=this.$router.currentRoute.params.vendor_name,this.getDataFromApi()},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi().then((function(t){}))},deep:!0},options:{handler:function(){this.getDataFromApi().then((function(t){}))},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,n=i.sortBy,s=i.sortDesc,r=i.page,o=i.itemsPerPage;t.search.trim().toLowerCase();t.limit=o;var l=t.getProducts(r,t.limit,n,s);setTimeout((function(){t.loading=!1,e({items:l})}),300)}))},getProducts:function(t,e,a,i){var n=this;this.loading=!0;var s="";a.length>0&&(s=!0===i[0]?"sorted_by=-"+a:"sorted_by="+a),this.$api.get("/api/kb/vendors/"+this.vendor_name+"/products?limit="+e+"&page="+t+"&product__icontains="+this.search+"&"+s).then((function(t){return n.products=t.data,n.products})).catch((function(t){n.products=[],n.loading=!1,V.a.fire({title:"Error",text:"unable to get products",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1}}},Xt=Qt,Zt=Object(l["a"])(Xt,Kt,Gt,!1,null,null,null),te=Zt.exports;d()(Zt,{VCard:P["a"],VCardTitle:$["c"],VDataTable:yt["a"],VSpacer:O["a"],VTextField:z["a"]});var ee=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[!0===t.loading?a("div",{staticClass:"loading"},[t._v("Loading…")]):t._e(),a("v-card",[a("v-card-title",[t._v(" CVE "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.cves.results,"items-per-page":20,options:t.options,"server-items-length":t.cves.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"cve_id","show-select":"","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.summary",fn:function(e){var i=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1},scopedSlots:t._u([{key:"after",fn:function(e){var i=e.toggle,n=e.expanded,s=e.clamped;return n||s?a("button",{staticClass:"toggle btn btn-sm",on:{click:i}},[t._v(" "+t._s(" more")+" ")]):t._e()}}],null,!0)},[t._v(" "+t._s(i.summary)+" ")])]}},{key:"item.modified",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.modified).format("YYYY-MM-DD")))])]}}])})],1)],1)},ae=[],ie={name:"cves",components:{VClamp:bt["a"]},data:function(){return{cves:[],totalcves:0,loading:!0,limit:20,search:"",options:{},selected:[],headers:[{text:"CVE-ID",value:"cve_id",width:"150px"},{text:"Summary",value:"summary",sortable:!1},{text:"CVSS",value:"cvss",align:"center"},{text:"CVSS Vector",value:"cvss_vector",align:"center",sortable:!1},{text:"Modified",value:"modified",align:"center"}],rowsPerPageItems:[5,10,20,50,100]}},mounted:function(){},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi().then((function(t){}))},deep:!0},options:{handler:function(){this.getDataFromApi().then((function(t){}))},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,n=i.sortBy,s=i.sortDesc,r=i.page,o=i.itemsPerPage;t.search.trim().toLowerCase();t.limit=o;var l=t.getcves(r,t.limit,n,s);setTimeout((function(){t.loading=!1,e({items:l})}),300)}))},getcves:function(t,e,a,i){var n=this;this.loading=!0;var s="";a.length>0&&(s=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/kb/cve?limit="+e+"&page="+t+s+"&search="+this.search).then((function(t){return n.cves=t.data,n.cves})).catch((function(t){n.cves=[],n.loading=!1,V.a.fire({title:"Error",text:"unable to get cves",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1}}},ne=ie,se=Object(l["a"])(ne,ee,ae,!1,null,null,null),re=se.exports;d()(se,{VCard:P["a"],VCardTitle:$["c"],VDataTable:yt["a"],VSpacer:O["a"],VTextField:z["a"]});var oe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[!0===t.loading?a("div",{staticClass:"loading"},[t._v("Loading…")]):t._e(),a("v-card",[a("v-card-title",[t._v(" Bulletins "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.bulletins.results,options:t.options,"server-items-length":t.bulletins.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"publicid","show-select":"","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.title",fn:function(e){var i=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1},scopedSlots:t._u([{key:"after",fn:function(e){var i=e.toggle,n=e.expanded,s=e.clamped;return n||s?a("button",{staticClass:"toggle btn btn-sm",on:{click:i}},[t._v(" "+t._s(" more")+" ")]):t._e()}}],null,!0)},[t._v(" "+t._s(i.title)+" ")])]}},{key:"item.published",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.published).format("YYYY-MM-DD")))])]}}])})],1)],1)},le=[],ce={name:"bulletins",components:{VClamp:bt["a"]},data:function(){return{bulletins:[],totalbulletins:0,loading:!0,limit:20,search:"",options:{},selected:[],headers:[{text:"ID",value:"publicid",width:"150px"},{text:"Vendor",value:"vendor"},{text:"Title",value:"title"},{text:"Severity",value:"severity"},{text:"Published",value:"published"}],rowsPerPageItems:[5,10,20,50,100]}},mounted:function(){},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi().then((function(t){}))},deep:!0},options:{handler:function(){this.getDataFromApi().then((function(t){}))},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,n=i.sortBy,s=i.sortDesc,r=i.page,o=i.itemsPerPage;t.search.trim().toLowerCase();t.limit=o;var l=t.getbulletins(r,t.limit,n,s);setTimeout((function(){t.loading=!1,e({items:l})}),300)}))},getbulletins:function(t,e,a,i){var n=this;this.loading=!0;var s="";a.length>0&&(s=!0===i[0]?"sorted_by=-"+a:"sorted_by="+a),this.$api.get("/api/kb/bulletin?limit="+e+"&page="+t+"&"+s+"&search="+this.search).then((function(t){return n.bulletins=t.data,n.bulletins})).catch((function(t){n.bulletins=[],n.loading=!1,V.a.fire({title:"Error",text:"unable to get bulletins",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1}}},de=ce,ue=Object(l["a"])(de,oe,le,!1,null,null,null),ve=ue.exports;d()(ue,{VCard:P["a"],VCardTitle:$["c"],VDataTable:yt["a"],VSpacer:O["a"],VTextField:z["a"]});var me=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-container",{attrs:{fluid:"","fill-height":""}},[a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("div",{staticClass:"text-md-center"},[a("h1",[t._v("404")]),a("h2",{staticClass:"my-3 headline"},[t._v("Sorry, page not found")]),a("div",[a("v-btn",{attrs:{color:"primary"},on:{click:t.goBack}},[t._v("Take me back!")]),a("v-btn",{attrs:{color:"primary"},on:{click:t.goHome}},[t._v("Go Home")])],1)])])],1)],1)},he=[],pe={methods:{goBack:function(){this.$router.go(-1)},goHome:function(){this.$router.push({path:"/"})}}},fe=pe,ge=(a("3d91"),Object(l["a"])(fe,me,he,!1,null,"7cd99d3d",null)),be=ge.exports;d()(ge,{VApp:u["a"],VBtn:S["a"],VContainer:E["a"],VLayout:D["a"]}),i["a"].use(x["a"]);var _e=[{path:"/auth",name:"AuthLayout",component:M},{path:"/",component:ct,children:[{path:"homepage",name:"Homepage",component:pt},{path:"/kb/vendors",name:"KBVendors",component:qt},{path:"/kb/vendors/:vendor_name",name:"KBProducts",component:te},{path:"/kb/cves",name:"KBCVE",component:re},{path:"/kb/bulletins",name:"KBBulletins",component:ve},{path:"/vulns",name:"Vulns",component:jt},{path:"/vulns/:vuln_id",name:"VulnDetails",component:Ut}]},{path:"*",component:be}],xe=new x["a"]({mode:"history",base:"/",routes:_e});xe.beforeEach((function(t,e,a){null!==localStorage.getItem("authToken")||"/auth"===t.path?a():a("/auth")}));var ke=xe,ye=a("2f62"),we=a("a7fe"),je=a.n(we),Ce=a("04e1"),Ve=a.n(Ce);j.a.defaults.baseURL=Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_API_BASE_URL||Object({NODE_ENV:"production",BASE_URL:"/"}).API_BASE_URL||"http://localhost:3333/",i["a"].use(ye["a"]),i["a"].use(je.a,j.a);var Te=new ye["a"].Store({state:{authUser:{},isAuthenticated:!1,jwt_auth_token:localStorage.getItem("authToken"),jwt_refresh_token:localStorage.getItem("refreshToken"),endpoints:{obtainJWT:"/auth-jwt/obtain_jwt_token/",refreshJWT:"/auth-jwt/refresh_jwt_token/"}},getters:{isLoggedIn:function(t){return null!=t.jwt_auth_token}},mutations:{setAuthUser:function(t,e){var a=e.authUser,n=e.isAuthenticated;i["a"].set(t,"authUser",a),i["a"].set(t,"isAuthenticated",n)},updateToken:function(t,e){localStorage.setItem("authToken",e),t.jwt_auth_token=e},removeToken:function(t){localStorage.removeItem("authToken"),t.jwt_auth_token=null}},actions:{obtainToken:function(t,e){var a=this,i={username:t,password:e};this.$api.post(this.state.endpoints.obtainJWT,i).then((function(t){a.commit("updateToken",t.data.access)})).catch((function(t){console.log(t)}))},refreshToken:function(){var t=this,e={token:this.state.jwt_refresh_token};this.$api.post(this.state.endpoints.refreshJWT,e).then((function(e){t.commit("updateToken",e.data.access)})).catch((function(t){console.log(t)}))},inspectToken:function(){var t=this.state.jwt_auth_token;if(t){var e=Ve()(t),a=e.exp,i=decode.orig_iat;a-Date.now()/1e3<1800&&Date.now()/1e3-i<628200?this.dispatch("refreshToken"):Date.now()}}},modules:{}}),Ie=a("c1df"),Se=a.n(Ie);a("4de4"),a("fb6a"),a("25f0");i["a"].filter("capitalize",(function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()+t.slice(1)):""})),i["a"].filter("truncate",(function(t,e,a){a=a||"...";var i=document.createElement("div");i.innerHTML=t;var n=i.textContent;return n.length>e?n.slice(0,e)+a:n})),j.a.interceptors.response.use((function(t){return t}),(function(t){t.response})),j.a.interceptors.request.use((function(t){return Te.state.jwt_auth_token&&(t.headers.Authorization="JWT "+Te.state.jwt_auth_token),t}),(function(t){return Promise.reject(t)})),i["a"].prototype.$api=j.a,i["a"].prototype.moment=Se.a,i["a"].config.productionTip=!1,new i["a"]({vuetify:_,router:ke,VueSession:p.a,store:Te,render:function(t){return t(m)}}).$mount("#app"),i["a"].use(g.a)},b051:function(t,e,a){}});
//# sourceMappingURL=app.92efcd6b.js.map