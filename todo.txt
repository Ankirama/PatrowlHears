[ ] Extract exploit or PoC from refmap
[ ] Sync and monitor Vendor bulletins (MS, RH, Suse, debian, gentoo, Amazon, ...)
[ ] Patch info: availability (unknown, partial, official), date
[ ] Extract CVSSv2 Temporal vector from Nessus plugins
[ ] Extract CVSSv3 Base and Temporal vectors from Nessus plugins
[ ] Collect vuln categories: Deny of service, Remote code exec, ...
[ ] Collect data from MISP
[ ] Collect data on Yara and Sigma detection rules
[ ] Share data with OpenCTI
[ ] Scrap data from Github, Twitter, Reddit and Google --> NLP analysis for suggestions
[ ] Use memcache
[ ] DB performance tuning
[ ] Fix:
  - Sync VIA: Tenable bulletins -> ThreatMetadata instead of ExploitMetadata
  - Manually adding first exploit to the vulnerability: 'Exploitable' metric is not updated

https://nvd.nist.gov/vuln/data-feeds
https://security.paloaltonetworks.com/CVE-2020-1976

YaraRules
CVE-2017–11882: https://medium.com/@Sebdraven/a-quick-analysis-malicious-rtf-to-write-yara-rule-part-1-234fa34db551
CVE-2017-11882 https://blog.reversinglabs.com/blog/reversinglabs-yara-rule-detects-cobalt-payload-exploiting-cve-2017-11882
CVE-2019-19781: https://github.com/Neo23x0/signature-base/blob/master/yara/exploit_shitrix.yar
CVE-2020-8438: https://sku11army.blogspot.com/2020/01/ruckus-rce-ruckus-m500-via-injection-on.html
CVE-2020-8772: https://www.wordfence.com/blog/2020/01/critical-authentication-bypass-vulnerability-in-infinitewp-client-plugin/
CVE-2020-8772: https://www.webarxsecurity.com/vulnerability-infinitewp-client-wp-time-capsule/
CVE-2019-7482-CVE-2019-7486: https://blog.scrt.ch/2020/02/11/sonicwall-sra-and-sma-vulnerabilties/
https://research.securitum.com/css-data-exfiltration-in-firefox-via-single-injection-point/
cve-2020-0601: https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-technical-analysis-of-curveball-cve-2020-0601/
https://www.secjuice.com/modsecurity-vulnerability-cve-2019-19886/
CVE-2020-8547: https://tech.michaelaltfield.net/2020/02/14/phplist-hardening-security/
CVE-2019-15605: https://snyk.io/blog/node-js-release-fixes-a-critical-http-security-vulnerability/
CVE-2020-0618: https://www.mdsec.co.uk/2020/02/cve-2020-0618-rce-in-sql-server-reporting-services-ssrs/
CVE-2019-18683: https://a13xp0p0v.github.io/2020/02/15/CVE-2019-18683.html
CVE-2020-0668: https://itm4n.github.io/cve-2020-0668-windows-service-tracing-eop/
https://www.webarxsecurity.com/critical-issue-in-themegrill-demo-importer/
CVE-2020-0683: https://padovah4ck.github.io/CVE-2020-0683/
CVE-2019-2215: https://github.com/DimitriFourny/cve-2019-2215
CVE-2020-0728: https://github.com/irsl/CVE-2020-0728
CVE-2018-4344: https://www.synacktiv.com/posts/exploit/lightspeed-a-race-for-an-iosmacos-sandbox-escape.html
CVE-2019-20099: https://fr.tenable.com/security/research/tra-2020-05?tns_redirect=true
CVE-2019-20099: https://medium.com/tenable-techblog/exploiting-jira-for-host-discovery-43be3cddf023
CVE-2019-18846: https://seclists.org/fulldisclosure/2020/Feb/23
CVE-2018-8611: https://research.nccgroup.com/2020/02/21/cve-2018-8611-diving-into-the-windows-kernel-transaction-manager-ktm-for-fun-and-exploitation/
CVE-2017-11176: https://blog.lexfo.fr/cve-2017-11176-linux-kernel-exploitation-part1.html
CVE-2020-7247: https://github.com/r0lh/CVE-2020-7247
CVE-2020-1693: https://zeroauth.ltd/blog/2020/02/18/proof-of-concept-exploit-for-cve-2020-1693-spacewalk/
CVE-2020-1938: https://github.com/hypn0s/AJPy
CVE-2020-7247: https://pastebin.com/ZgLp4Lv1
CVE-2020-0767: https://github.com/phoenhex/files/blob/master/pocs/cve-2020-0767.js
CVE-2020-0753, CVE-2020-0754: https://github.com/afang5472/CVE-2020-0753-and-CVE-2020-0754
CVE-2020-8813: https://github.com/mhaskar/CVE-2020-8813, https://shells.systems/cacti-v1-2-8-authenticated-remote-code-execution-cve-2020-8813/
CVE-2020-5187: https://packetstormsecurity.com/files/156489/dnn944zipslip-traversal.txt
CVE-2020-5188: https://packetstormsecurity.com/files/156484/dnn950-bypass.txt
CVE-2020-7471: https://github.com/advisories/GHSA-hmr4-m2h5-33qx, https://github.com/django/django/commit/eb31d845323618d688ad429479c6dda973056136, https://ryu22e.org/en/posts/2020/02/06/django-cve-2020-7471/
CVE-2020-6418: https://chromereleases.googleblog.com/2020/02/stable-channel-update-for-desktop_24.html?m=1
CVE-2020-3837: https://github.com/jakeajames/time_waste
CVE-2020-0688: https://www.thezdi.com/blog/2020/2/24/cve-2020-0688-remote-code-execution-on-microsoft-exchange-server-through-fixed-cryptographic-keys
https://www.wordfence.com/blog/2020/02/zero-day-vulnerability-in-themerex-addons-plugin-exploited-in-the-wild/
CVE-2020-0609: https://blog.rop.la/en/vulnerabilities/2020/02/25/bluegate-internals.html
CVE-2020-0610: https://blog.rop.la/en/vulnerabilities/2020/02/25/bluegate-internals.html
CVE-2019-15126: https://www.eset.com/int/kr00k/
CVE-2019-1458: https://securelist.com/windows-0-day-exploit-cve-2019-1458-used-in-operation-wizardopium/95432/
CVE-2020-5497: https://www.securitymetrics.com/blog/MITREid-Connect-cross-site-scripting-CVE-2020-5497
CVE-2016-10743 and CVE-2019-10064: https://moabi.com/advisories/CVE-2019-10064.html
CVE-2020–7246: https://medium.com/@tobinmshields/qdpm-v9-1-authenticated-rce-exploit-f4b84e19df00
CVE-2020-5401: https://nathandavison.com/blog/cache-poisoning-dos-in-cloudfoundry-gorouter
CVE-2019-9465: https://alexbakker.me/post/mysterious-google-titan-m-bug-cve-2019-9465.html
CVE-2020-0688: https://github.com/Yt1g3r/CVE-2020-0688_EXP/blob/master/CVE-2020-0688_EXP.py
CVE-2020-0041: https://lore.kernel.org/lkml/20191213202531.55010-1-tkjos@google.com/

Sigma Detection
https://github.com/Neo23x0/sigma/blob/master/rules/web/web_citrix_cve_2019_19781_exploit.yml

OpenCTI integration

----------------
ALTER SEQUENCE kb_cve_id_seq RESTART;
ALTER SEQUENCE cves_historicalcve_history_id_seq RESTART;
ALTER SEQUENCE vulns_id_seq RESTART;
ALTER SEQUENCE threats_metadata_id_seq RESTART;
ALTER SEQUENCE vulns_historicalvuln_history_id_seq RESTART;
ALTER SEQUENCE vulns_historicalthreatmetadata_history_id_seq RESTART;
ALTER SEQUENCE vulns_historicalexploitmetadata_history_id_seq RESTART;
ALTER SEQUENCE exploits_metadata_id_seq RESTART;

----------------

Bulletins
redhat: CVE-2018-12326
msbulletin: CVE-2017-8713

----------------
Monitored assets:
- Create/Update/Delete asset to monitor: Vuln, CVE, Bulletin, CPE, Vendor, Product
- Send alerts on changes
- Send periodic reports

----------------
Alerting use cases:
- Vulnerabilities match CVSS > 9.0 AND is_monitored_cpe AND is_exploitable == True
  -> New vulns
  -> Updated vuln

Alerting [
{
  'title': '[All] New vulnerability detected with CVSS > 9.0 and an exploit exists',
  'trigger': 'add_vuln',
  'action': 'debug',
  'target': 'vulns',
  'on_monitored': False,
  'in_bulk': False,
  'template_id': None,
  'conditions': {
    'vuln': {
      'cvss__gte': 9.0,
      'is_exploitable': True
    }
  },
  'severity': 'low',
  'enabled': True
},
{
  'title': '[Monitored] CVSS score has changed to > 9.0',
  'trigger': 'update_vuln',
  'action': 'debug',
  'target': 'vulns',
  'on_monitored': True,
  'conditions': [
    'vuln': {
      'cvss__gte': 9.0,
    }
  ],
  'check_fields': ['cvss2']
  'severity': 'low'
},
{
  'title': '[Monitored] CVSS score has changed to > 9.0',
  'trigger': 'update_vuln',
  'action': 'debug',
  'target': 'vulns',
  'on_monitored': True,
  'conditions': [
    'vuln': {
      'cvss2__gte': 9.0,
    }
  ],
  'check_fields': ['cvss2']
  'severity': 'low'
},
{
  'title': '[Monitored] Change(s) detected on Vuln PHID-{{vuln.id}}',
  'trigger': 'update_vuln',
  'action': 'debug',
  'target': 'vulns',
  'on_monitored': True,
  'conditions': [],
  'check_fields': [
    'cvss2', 'impact', 'access', 'is_exploitable', 'is_confirmed',
    'is_in_the_news', 'is_in_the_wild']
  'severity': 'low'
},
{
  'title': '[All] New public exploit has been found on CVE-2020-0608',
  'trigger': 'add_exploit',
  'action': 'debug',
  'target': 'exploits',
  'on_monitored': False,
  'conditions': [
    'vuln': {
      'cve_id': 'CVE-2020-0608',
    }
    'exploit': {
      'availability': 'public'
    }
  ],
  'severity': 'low'
},
]
